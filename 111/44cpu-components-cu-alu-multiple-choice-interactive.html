<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›»è…¦æ¦‚è«– - è¤‡é¸é¡Œ 44ï¼šCPU çš„çµ„æˆå–®å…ƒ</title>
    <style>
        /* --- å…¨åŸŸè¨­å®š --- */
        :root {
            --primary-color: #2c3e50;
            --accent-color: #e74c3c; /* é‡é»ç´… */
            --highlight-color: #f1c40f; /* è¢å…‰ç­†é»ƒ */
            --success-color: #27ae60;
            --bg-color: #fdfbf7; /* ä»¿è¬›ç¾©ç´™å¼µè‰² */
            --card-bg: #ffffff;
            --text-color: #333;
            --border-radius: 12px;
            --box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        * {
            box-sizing: border-box;
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        h1, h2, h3 {
            color: var(--primary-color);
            text-align: center;
        }

        h1 {
            border-bottom: 3px solid var(--accent-color);
            padding-bottom: 10px;
            margin-bottom: 30px;
        }

        /* --- å€å¡Šé€šç”¨æ¨£å¼ --- */
        .section-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--box-shadow);
            border: 1px solid #ddd;
        }

        .badge {
            background: var(--accent-color);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-right: 10px;
            vertical-align: middle;
        }

        /* --- é¡Œç›®å€ --- */
        .question-box {
            background: #eef2f3;
            border-left: 5px solid var(--primary-color);
            padding: 20px;
            font-size: 1.1em;
            font-weight: bold;
        }

        .options-list {
            list-style: none;
            padding: 0;
            margin-top: 15px;
        }

        .options-list li {
            margin: 8px 0;
            padding: 8px;
            background: rgba(255,255,255,0.5);
            border-radius: 5px;
        }

        /* --- æ ¸å¿ƒè§€å¿µå€ (é‡é»ç­†è¨˜) --- */
        .concept-highlight {
            background-color: #fff9c4; /* é»ƒè‰²è¢å…‰ç­†åº•è‰² */
            padding: 5px;
            border-radius: 4px;
            font-weight: bold;
        }

        .formula-box {
            text-align: center;
            font-size: 2em;
            color: var(--accent-color);
            font-weight: 900;
            margin: 20px 0;
            padding: 20px;
            border: 3px dashed var(--accent-color);
            border-radius: var(--border-radius);
            background: #fff;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        /* --- æ¶æ§‹ç¤ºæ„åœ–äº’å‹• --- */
        .cpu-architecture {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
        }

        .cpu-box {
            border: 4px solid var(--primary-color);
            border-radius: 10px;
            padding: 20px;
            width: 100%;
            background: #e8f6f3;
            position: relative;
        }

        .cpu-label {
            position: absolute;
            top: -15px;
            left: 20px;
            background: var(--primary-color);
            color: white;
            padding: 5px 15px;
            border-radius: 5px;
            font-weight: bold;
        }

        .internal-units {
            display: flex;
            justify-content: space-around;
            gap: 10px;
            margin-top: 15px;
        }

        .unit-btn {
            flex: 1;
            padding: 20px;
            border: 2px solid #3498db;
            background: white;
            color: #3498db;
            font-weight: bold;
            font-size: 1.2em;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .unit-btn:hover {
            background: #3498db;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }

        .info-display {
            width: 100%;
            min-height: 60px;
            background: #34495e;
            color: #fff;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1em;
        }

        /* --- æ‹–æ”¾éŠæˆ²å€ --- */
        .game-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .draggable-items {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            min-height: 60px;
        }

        .draggable {
            background: var(--primary-color);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: move; /* é›»è…¦ç‰ˆæ¸¸æ¨™ */
            user-select: none;
            font-weight: bold;
            box-shadow: 0 3px 5px rgba(0,0,0,0.2);
            transition: transform 0.2s;
        }

        .draggable:active {
            transform: scale(1.1);
        }

        .drop-zones {
            display: flex;
            gap: 20px;
            justify-content: center;
        }

        .drop-zone {
            flex: 1;
            border: 3px dashed #bdc3c7;
            border-radius: 10px;
            min-height: 150px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: background 0.3s;
        }

        .drop-zone h4 {
            margin-top: 0;
            color: #7f8c8d;
        }

        .drop-zone.hovered {
            background: #ecf0f1;
            border-color: #3498db;
        }

        /* --- è¤‡é¸é¡Œä½œç­”å€ --- */
        .quiz-option {
            display: block;
            margin: 10px 0;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .quiz-option:hover {
            background: #f9f9f9;
        }

        .quiz-option input {
            margin-right: 10px;
            transform: scale(1.5);
        }

        .action-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1em;
            border-radius: 25px;
            cursor: pointer;
            margin-top: 20px;
            width: 100%;
            transition: background 0.3s;
        }

        .action-btn:hover {
            background: #34495e;
        }

        .result-box {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            display: none;
        }

        .result-correct {
            background: #d5f5e3;
            color: #1e8449;
            border: 1px solid #1e8449;
        }

        .result-wrong {
            background: #fadbd8;
            color: #c0392b;
            border: 1px solid #c0392b;
        }

        /* --- é¸é …è§£æèˆ‡é™·é˜±å¡ --- */
        .analysis-btn {
            background: white;
            border: 1px solid #ddd;
            padding: 10px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            text-align: left;
            width: 100%;
        }
        
        .analysis-btn:hover {
            background: #f0f0f0;
        }

        .trap-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .trap-card {
            background: #fff0f0;
            border-left: 5px solid var(--accent-color);
            padding: 15px;
            border-radius: 8px;
            position: relative;
            cursor: pointer;
            transition: opacity 0.5s;
        }

        .trap-card.resolved {
            opacity: 0.2;
            pointer-events: none;
        }

        /* --- è‡ªæˆ‘æª¢æ¸¬ --- */
        .self-check-item {
            margin-bottom: 20px;
            border-bottom: 1px dashed #ddd;
            padding-bottom: 10px;
        }

        .hint-text {
            color: #2980b9;
            margin-top: 10px;
            font-style: italic;
            display: none;
            background: #eaf2f8;
            padding: 10px;
            border-radius: 5px;
        }

        /* --- é‡ç½®æŒ‰éˆ• --- */
        .reset-section {
            text-align: center;
            margin-top: 40px;
            margin-bottom: 20px;
        }
        
        .reset-btn {
            background: transparent;
            color: #7f8c8d;
            border: 1px solid #7f8c8d;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
        }
        
        .reset-btn:hover {
            background: #7f8c8d;
            color: white;
        }

    </style>
</head>
<body>

<div class="container">
    <!-- æ¨™é¡Œ -->
    <h1>é›»è…¦æ¦‚è«– <span style="font-size:0.6em; color:#7f8c8d;">@äº’å‹•å¼è¬›ç¾©</span></h1>

    <!-- ç¬¬ä¸€å€ï¼šé¡Œç›®å‘ˆç¾ -->
    <div class="section-card">
        <h2 style="text-align: left;"><span class="badge">è¤‡é¸é¡Œ 44</span>é›»è…¦ CPU çš„çµ„æˆå–®å…ƒåŒ…æ‹¬ï¼Ÿ</h2>
        <div class="question-box">
            <p>è«‹é¸å‡ºæ‰€æœ‰æ­£ç¢ºé¸é …ï¼ˆæœ¬é¡Œå¯è¤‡é¸ï¼‰ï¼š</p>
            <ul class="options-list">
                <li>(A) ACU</li>
                <li>(B) CU</li>
                <li>(C) ALU</li>
                <li>(D) MU</li>
                <li>(E) OS</li>
            </ul>
        </div>
    </div>

    <!-- ç¬¬äºŒå€ï¼šæ ¸å¿ƒè§€å¿µæ•™å­¸ -->
    <div class="section-card">
        <h3>ğŸ“ è€å¸«çš„è§€å¿µç­†è¨˜</h3>
        <p>å„ä½åŒå­¸ï¼Œè¬›åˆ° CPUï¼ˆä¸­å¤®è™•ç†å™¨ï¼Œé›»è…¦çš„å¤§è…¦ï¼‰ï¼Œä¸€å®šè¦è¨˜å¾—å®ƒçš„æ ¸å¿ƒçµæ§‹åªæœ‰å…©éƒ¨åˆ†ï¼å…¶ä»–çš„åƒæ˜¯è¨˜æ†¶é«”ã€ä½œæ¥­ç³»çµ±ï¼Œéƒ½æ˜¯å®ƒçš„åŠ©æ‰‹æˆ–ç®¡ç†è€…ï¼Œä½åœ¨å¤–é¢ã€‚</p>
        
        <div class="formula-box">
            ğŸ”¥ ç§’æ®ºå£è¨£ï¼šCPU = CU + ALU
        </div>

        <p>
            <span class="concept-highlight">1. CU (Control Unit) æ§åˆ¶å–®å…ƒ</span>ï¼šå°±åƒäº¤é€šè­¦å¯Ÿæˆ–æ¨‚åœ˜æŒ‡æ®ï¼Œè² è²¬æŒ‡æ®äº¤é€šã€è§£ç¢¼æŒ‡ä»¤ã€‚<br>
            <span class="concept-highlight">2. ALU (Arithmetic Logic Unit) ç®—è¡“é‚è¼¯å–®å…ƒ</span>ï¼šå°±åƒæ•¸å­¸å¤©æ‰ï¼Œè² è²¬åŠ æ¸›ä¹˜é™¤è·Ÿæ¯”å¤§å°ã€‚
        </p>

        <!-- CPU æ¶æ§‹åœ–è§£äº’å‹• -->
        <div class="cpu-architecture">
            <div class="cpu-box">
                <span class="cpu-label">CPU å…§éƒ¨ (ç¡¬é«”)</span>
                <div class="internal-units">
                    <button class="unit-btn" onclick="showUnitInfo('CU')">CU<br><span style="font-size:0.6em">æ§åˆ¶å–®å…ƒ</span></button>
                    <button class="unit-btn" onclick="showUnitInfo('ALU')">ALU<br><span style="font-size:0.6em">ç®—è¡“é‚è¼¯å–®å…ƒ</span></button>
                </div>
            </div>
            
            <div style="display:flex; width:100%; gap:10px;">
                <button class="unit-btn" style="border-color:#95a5a6; color:#7f8c8d;" onclick="showUnitInfo('MU')">MU<br><span style="font-size:0.6em">è¨˜æ†¶é«” (å¤–éƒ¨)</span></button>
                <button class="unit-btn" style="border-color:#95a5a6; color:#7f8c8d;" onclick="showUnitInfo('OS')">OS<br><span style="font-size:0.6em">ä½œæ¥­ç³»çµ± (è»Ÿé«”)</span></button>
            </div>

            <div id="unit-info-display" class="info-display">
                ğŸ‘† é»æ“Šä¸Šæ–¹æ–¹å¡Šï¼ŒæŸ¥çœ‹å„å–®å…ƒåŠŸèƒ½è©³è§£
            </div>
        </div>
    </div>

    <!-- ç¬¬ä¸‰å€ï¼šæ‹–æ‹‰äº’å‹•éŠæˆ² -->
    <div class="section-card">
        <h3>âœ‹ å‹•æ‰‹åšï¼šèª°åœ¨ CPU è£¡é¢ï¼Ÿ</h3>
        <p style="text-align:center; margin-bottom:15px;">è«‹å°‡ä¸‹æ–¹çš„å¡ç‰‡æ‹–æ‹‰åˆ°æ­£ç¢ºçš„æ¡†æ¡†ä¸­ï¼ˆæ‰‹æ©Ÿç‰ˆè«‹å…ˆé»å¡ç‰‡ï¼Œå†é»æ¡†æ¡†ï¼‰</p>
        
        <div class="game-container">
            <div class="draggable-items" id="drag-source">
                <!-- draggable="true" æ˜¯ HTML5 DnD å±¬æ€§ -->
                <div class="draggable" draggable="true" data-type="inside" id="card-cu">CU</div>
                <div class="draggable" draggable="true" data-type="inside" id="card-alu">ALU</div>
                <div class="draggable" draggable="true" data-type="outside" id="card-mu">MU</div>
                <div class="draggable" draggable="true" data-type="outside" id="card-os">OS</div>
                <div class="draggable" draggable="true" data-type="fake" id="card-acu">ACU</div>
            </div>

            <div class="drop-zones">
                <div class="drop-zone" id="zone-inside" data-target="inside">
                    <h4>âœ… CPU çµ„æˆå–®å…ƒ</h4>
                </div>
                <div class="drop-zone" id="zone-outside" data-target="outside">
                    <h4>âŒ é CPU çµ„æˆå–®å…ƒ</h4>
                </div>
            </div>
            
            <button class="action-btn" style="background:#f39c12;" onclick="checkDragGame()">æª¢æŸ¥åˆ†é¡çµæœ</button>
            <div id="game-result" class="result-box"></div>
        </div>
    </div>

    <!-- ç¬¬å››å€ï¼šæ­£å¼ä½œç­” -->
    <div class="section-card">
        <h3>ğŸ“ éš¨å ‚æ¸¬é©— (è¤‡é¸é¡Œ 44)</h3>
        <p class="badge" style="background:#e67e22; width:fit-content;">âš ï¸ æ³¨æ„ï¼šæœ¬é¡Œç‚ºè¤‡é¸é¡Œ</p>
        
        <form id="quiz-form">
            <label class="quiz-option">
                <input type="checkbox" name="option" value="A"> (A) ACU (éæ¨™æº–åç¨±)
            </label>
            <label class="quiz-option">
                <input type="checkbox" name="option" value="B"> (B) CU (æ§åˆ¶å–®å…ƒ)
            </label>
            <label class="quiz-option">
                <input type="checkbox" name="option" value="C"> (C) ALU (ç®—è¡“é‚è¼¯å–®å…ƒ)
            </label>
            <label class="quiz-option">
                <input type="checkbox" name="option" value="D"> (D) MU (è¨˜æ†¶é«”å–®å…ƒ)
            </label>
            <label class="quiz-option">
                <input type="checkbox" name="option" value="E"> (E) OS (ä½œæ¥­ç³»çµ±)
            </label>
        </form>

        <button class="action-btn" onclick="submitQuiz()">é€å‡ºç­”æ¡ˆ</button>
        <div id="quiz-result" class="result-box"></div>
    </div>

    <!-- ç¬¬äº”å€ï¼šè©³ç´°è§£æèˆ‡é™·é˜± -->
    <div class="section-card">
        <h3>ğŸ” é¸é …å¤§è§£æ (é»æ“ŠæŸ¥çœ‹)</h3>
        <div id="analysis-area">
            <button class="analysis-btn" onclick="showAnalysis('A')">(A) ACUï¼šé€™æ˜¯ä»€éº¼ï¼Ÿ</button>
            <div id="explain-A" class="hint-text" style="color:#c0392b;">âŒ éŒ¯èª¤ã€‚ACU ä¸æ˜¯æ¨™æº–çš„ CPU çµ„æˆåç¨±ï¼Œé€šå¸¸æ˜¯è€ƒè©¦ç”¨ä¾†æ··æ·†ä½ çš„é¸é …ã€‚</div>

            <button class="analysis-btn" onclick="showAnalysis('B')">(B) CUï¼šæ­£ç¢ºå—ï¼Ÿ</button>
            <div id="explain-B" class="hint-text" style="color:#1e8449; font-weight:bold;">âœ… æ­£ç¢ºï¼CU (Control Unit) æ˜¯æ§åˆ¶å–®å…ƒï¼Œè² è²¬æŒ‡æ®å”èª¿ã€‚</div>

            <button class="analysis-btn" onclick="showAnalysis('C')">(C) ALUï¼šæ­£ç¢ºå—ï¼Ÿ</button>
            <div id="explain-C" class="hint-text" style="color:#1e8449; font-weight:bold;">âœ… æ­£ç¢ºï¼ALU (Arithmetic Logic Unit) æ˜¯ç®—è¡“é‚è¼¯å–®å…ƒï¼Œè² è²¬é‹ç®—ã€‚</div>

            <button class="analysis-btn" onclick="showAnalysis('D')">(D) MUï¼šæ­£ç¢ºå—ï¼Ÿ</button>
            <div id="explain-D" class="hint-text" style="color:#c0392b;">âŒ éŒ¯èª¤ã€‚MU (Memory Unit) æ˜¯è¨˜æ†¶é«”ï¼Œå®ƒé€éåŒ¯æµæ’èˆ‡ CPU é€£æ¥ï¼Œä½†åœ¨ CPU ã€Œå¤–éƒ¨ã€ã€‚</div>

            <button class="analysis-btn" onclick="showAnalysis('E')">(E) OSï¼šæ­£ç¢ºå—ï¼Ÿ</button>
            <div id="explain-E" class="hint-text" style="color:#c0392b;">âŒ éŒ¯èª¤ã€‚OS (Operating System) æ˜¯ä½œæ¥­ç³»çµ±ï¼ˆå¦‚ Windows, iOSï¼‰ï¼Œå®ƒæ˜¯ã€Œè»Ÿé«”ã€ï¼ŒCPU æ˜¯ã€Œç¡¬é«”ã€ã€‚</div>
        </div>

        <h4 style="margin-top:30px;">ğŸš§ å¸¸è¦‹è€ƒè©¦é™·é˜± (é»æ“Šå¡ç‰‡æ¸…é™¤é™·é˜±)</h4>
        <div class="trap-grid">
            <div class="trap-card" onclick="resolveTrap(this)">
                <strong>é™·é˜± 1ï¼šçœ‹åˆ° Unit å°±é¸ï¼Ÿ</strong>
                <p>MU ä¹Ÿæœ‰ Unitï¼Œä½†å®ƒæ˜¯è¨˜æ†¶é«”ï¼Œä¸åœ¨ CPU è£¡é¢å–”ï¼<br><span style="color:#2980b9; font-size:0.9em;">(é»æˆ‘æ‡‚äº†)</span></p>
            </div>
            <div class="trap-card" onclick="resolveTrap(this)">
                <strong>é™·é˜± 2ï¼šOS å¾ˆé‡è¦å°±æ˜¯ CPUï¼Ÿ</strong>
                <p>OS æ˜¯è»Ÿé«”å¤§ç¸½ç®¡ï¼ŒCPU æ˜¯ç¡¬é«”å¤§è…¦ï¼Œå…©è€…ä¸åŒåœ‹ã€‚<br><span style="color:#2980b9; font-size:0.9em;">(é»æˆ‘æ‡‚äº†)</span></p>
            </div>
            <div class="trap-card" onclick="resolveTrap(this)">
                <strong>é™·é˜± 3ï¼šACU å¥½åƒè½éï¼Ÿ</strong>
                <p>é‚£æ˜¯æ‹¼æ¹Šå‡ºä¾†çš„å­—ï¼Œä¸è¦è¢«é¨™äº†ï¼Œæ¨™æº–åªæœ‰ CU è·Ÿ ALUã€‚<br><span style="color:#2980b9; font-size:0.9em;">(é»æˆ‘æ‡‚äº†)</span></p>
            </div>
        </div>
    </div>

    <!-- ç¬¬å…­å€ï¼šè‡ªæˆ‘æª¢æ¸¬ -->
    <div class="section-card">
        <h3>ğŸ¤” èª²å¾Œå°çœæ€</h3>
        
        <div class="self-check-item">
            <p><strong>Q1: ç‚ºä»€éº¼ ALU ä¸€å®šè¦æ­é… CUï¼Ÿ</strong></p>
            <button onclick="toggleHint('hint1')" style="font-size:0.8em; padding:5px 10px;">é¡¯ç¤ºæç¤º</button>
            <div id="hint1" class="hint-text">
                æç¤ºï¼šå¦‚æœåªæœ‰è¨ˆç®—æ©Ÿ(ALU)ä½†æ²’æœ‰äºº(CU)æŒ‰æŒ‰éµï¼Œè¨ˆç®—æ©Ÿè‡ªå·±æœƒå‹•å—ï¼ŸCU è² è²¬å‘Šè¨´ ALU è©²åšä»€éº¼é‹ç®—ã€‚
            </div>
        </div>

        <div class="self-check-item">
            <p><strong>Q2: è€ƒè©¦çœ‹åˆ° MU æˆ– Memoryï¼Œè¦åœ¨ã€ŒCPU çµ„æˆã€é€™é¡Œé¸å—ï¼Ÿ</strong></p>
            <button onclick="toggleHint('hint2')" style="font-size:0.8em; padding:5px 10px;">é¡¯ç¤ºæç¤º</button>
            <div id="hint2" class="hint-text">
                æç¤ºï¼šåƒè¬ä¸è¦ï¼è¨˜æ†¶é«”æ˜¯è³‡æ–™çš„å€‰åº«ï¼ŒCPU æ˜¯åŠ å·¥å» ã€‚å€‰åº«é€šå¸¸è“‹åœ¨å·¥å» æ—é‚Šï¼Œä¸åœ¨å·¥å» è£¡é¢ã€‚
            </div>
        </div>
    </div>

    <!-- é‡ç½® -->
    <div class="reset-section">
        <button class="reset-btn" onclick="resetAll()">ğŸ”„ å…¨éƒ¨é‡ç½® / é‡æ–°é–‹å§‹</button>
    </div>

</div>

<script>
    /* --- åŠŸèƒ½è§£èªªäº’å‹• --- */
    function showUnitInfo(unit) {
        const display = document.getElementById('unit-info-display');
        let text = "";
        let color = "#fff";
        
        switch(unit) {
            case 'CU':
                text = "<strong>CU (æ§åˆ¶å–®å…ƒ)</strong><br>è§’è‰²ï¼šäº¤é€šè­¦å¯Ÿ ğŸ‘®â€â™‚ï¸<br>åŠŸèƒ½ï¼šè§£ç¢¼æŒ‡ä»¤ã€æŒ‡æ®è³‡æ–™æµå‘ã€æ§åˆ¶ CPU é‹ä½œç¯€å¥ã€‚";
                color = "#e74c3c"; // Red highlight
                break;
            case 'ALU':
                text = "<strong>ALU (ç®—è¡“é‚è¼¯å–®å…ƒ)</strong><br>è§’è‰²ï¼šæ•¸å­¸å¤©æ‰ ğŸ§®<br>åŠŸèƒ½ï¼šç®—è¡“é‹ç®— (+ - * /) èˆ‡ é‚è¼¯é‹ç®— (AND, OR, NOT, æ¯”è¼ƒå¤§å°)ã€‚";
                color = "#27ae60"; // Green highlight
                break;
            case 'MU':
                text = "<strong>MU (è¨˜æ†¶é«”å–®å…ƒ)</strong><br>è§’è‰²ï¼šå€‰åº« ğŸ“¦<br>æ³¨æ„ï¼šå®ƒåœ¨ CPU <strong>å¤–éƒ¨</strong>ï¼è² è²¬æš«å­˜ CPU è¦ç”¨çš„è³‡æ–™èˆ‡ç¨‹å¼ã€‚";
                color = "#7f8c8d";
                break;
            case 'OS':
                text = "<strong>OS (ä½œæ¥­ç³»çµ±)</strong><br>è§’è‰²ï¼šç¶“ç† ğŸ‘¨â€ğŸ’¼<br>æ³¨æ„ï¼šå®ƒæ˜¯<strong>è»Ÿé«”</strong>ï¼è² è²¬ç®¡ç†é›»è…¦ç¡¬é«”è³‡æºã€‚";
                color = "#7f8c8d";
                break;
        }
        display.innerHTML = text;
        display.style.borderLeft = `5px solid ${color}`;
    }

    /* --- æ‹–æ”¾éŠæˆ²é‚è¼¯ (æ”¯æ´ç°¡æ˜“é»æ“Šèˆ‡åŸç”Ÿæ‹–æ”¾) --- */
    let selectedItem = null;
    const draggables = document.querySelectorAll('.draggable');
    const dropZones = document.querySelectorAll('.drop-zone');
    const sourceZone = document.getElementById('drag-source');

    // 1. åˆå§‹åŒ–æ‹–æ‹‰äº‹ä»¶
    draggables.forEach(draggable => {
        // Desktop Drag Start
        draggable.addEventListener('dragstart', () => {
            draggable.classList.add('dragging');
        });
        draggable.addEventListener('dragend', () => {
            draggable.classList.remove('dragging');
        });

        // Mobile/Click Interaction
        draggable.addEventListener('click', () => {
            if(selectedItem) {
                selectedItem.style.border = "none";
            }
            selectedItem = draggable;
            draggable.style.border = "2px solid #333";
        });
    });

    // 2. åˆå§‹åŒ–æ”¾ç½®å€äº‹ä»¶
    dropZones.forEach(zone => {
        zone.addEventListener('dragover', e => {
            e.preventDefault(); // å…è¨±æ”¾ç½®
            zone.classList.add('hovered');
        });

        zone.addEventListener('dragleave', () => {
            zone.classList.remove('hovered');
        });

        zone.addEventListener('drop', e => {
            e.preventDefault();
            zone.classList.remove('hovered');
            const draggable = document.querySelector('.dragging');
            if (draggable) {
                zone.appendChild(draggable);
            }
        });

        // Mobile/Click Drop
        zone.addEventListener('click', () => {
            if (selectedItem) {
                zone.appendChild(selectedItem);
                selectedItem.style.border = "none";
                selectedItem = null;
            }
        });
    });

    // 3. æª¢æŸ¥æ‹–æ”¾çµæœ
    function checkDragGame() {
        const insideZone = document.getElementById('zone-inside');
        const outsideZone = document.getElementById('zone-outside');
        const resultBox = document.getElementById('game-result');
        
        let correctCount = 0;
        let errors = [];

        // æª¢æŸ¥ "CPU å…§éƒ¨" å€
        Array.from(insideZone.children).forEach(item => {
            if(item.tagName === 'H4') return; // è·³éæ¨™é¡Œ
            if (item.id === 'card-cu' || item.id === 'card-alu') {
                correctCount++;
            } else {
                errors.push(`âŒ ${item.innerText} ä¸æ‡‰è©²åœ¨ CPU è£¡é¢ï¼`);
            }
        });

        // æª¢æŸ¥ "é CPU" å€
        Array.from(outsideZone.children).forEach(item => {
            if(item.tagName === 'H4') return;
            if (item.id === 'card-cu' || item.id === 'card-alu') {
                errors.push(`âŒ ${item.innerText} æ‡‰è©²åœ¨ CPU è£¡é¢æ‰å°ï¼`);
            }
        });
        
        // æª¢æŸ¥æ˜¯å¦æ‰€æœ‰å¡ç‰‡éƒ½åˆ†é¡äº†
        const sourceItems = document.getElementById('drag-source').querySelectorAll('.draggable');
        if (sourceItems.length > 0) {
            resultBox.innerHTML = "âš ï¸ è«‹å…ˆæŠŠæ‰€æœ‰å¡ç‰‡éƒ½åˆ†é¡å®Œå†æª¢æŸ¥å–”ï¼";
            resultBox.className = "result-box result-wrong";
            resultBox.style.display = "block";
            return;
        }

        if (errors.length === 0 && correctCount === 2) {
            resultBox.innerHTML = "ğŸ‰ å¤ªæ£’äº†ï¼ä½ å®Œå…¨ç­”å°äº†ï¼CPU è£¡é¢çœŸçš„åªæœ‰ CU å’Œ ALUã€‚";
            resultBox.className = "result-box result-correct";
        } else {
            resultBox.innerHTML = "ğŸ¤” é‚„æœ‰é»å°éŒ¯èª¤å–”ï¼š<br>" + errors.join("<br>");
            resultBox.className = "result-box result-wrong";
        }
        resultBox.style.display = "block";
    }

    /* --- è¤‡é¸é¡Œä½œç­”é‚è¼¯ --- */
    function submitQuiz() {
        const checkboxes = document.querySelectorAll('input[name="option"]:checked');
        const resultDiv = document.getElementById('quiz-result');
        let selectedValues = [];
        checkboxes.forEach((checkbox) => {
            selectedValues.push(checkbox.value);
        });

        // æ­£ç¢ºç­”æ¡ˆï¼šB å’Œ C
        const correctAnswers = ['B', 'C'];
        
        // åˆ¤æ–·é‚è¼¯
        let isCorrect = false;
        if (selectedValues.length === 2 && selectedValues.includes('B') && selectedValues.includes('C')) {
            isCorrect = true;
        }

        resultDiv.style.display = "block";

        if (isCorrect) {
            resultDiv.className = "result-box result-correct";
            resultDiv.innerHTML = "ğŸ’¯ å®Œå…¨æ­£ç¢ºï¼<br>ä½ å·²ç¶“æŒæ¡äº†ã€ŒCPU = CU + ALUã€çš„ç²¾éš¨ï¼";
        } else {
            resultDiv.className = "result-box result-wrong";
            let msg = "ğŸ‘‰ ç­”æ¡ˆä¸å°å–”ã€‚<br>";
            
            if (selectedValues.includes('D') || selectedValues.includes('E')) {
                msg += "ğŸ’¡ æç¤ºï¼šMU(è¨˜æ†¶é«”) å’Œ OS(è»Ÿé«”) éƒ½åœ¨ CPU å¤–é¢ã€‚<br>";
            }
            if (selectedValues.includes('A')) {
                msg += "ğŸ’¡ æç¤ºï¼šACU ä¸æ˜¯æ¨™æº–åç¨±ã€‚<br>";
            }
            if (selectedValues.length < 2) {
                msg += "ğŸ’¡ æç¤ºï¼šé€™æ˜¯ã€Œè¤‡é¸é¡Œã€ï¼Œé€šå¸¸æœ‰å…©å€‹ä»¥ä¸Šçš„ç­”æ¡ˆï¼ŒCPU æœ‰å…©å€‹æ ¸å¿ƒå–®å…ƒå–”ï¼";
            }
            
            resultDiv.innerHTML = msg;
        }
    }

    /* --- è§£æå€äº’å‹• --- */
    function showAnalysis(option) {
        // å…ˆéš±è—æ‰€æœ‰
        document.querySelectorAll('.hint-text').forEach(el => {
            if(el.id.startsWith('explain')) el.style.display = 'none';
        });
        // é¡¯ç¤ºè¢«é»æ“Šçš„
        const target = document.getElementById(`explain-${option}`);
        if(target) target.style.display = 'block';
    }

    function resolveTrap(card) {
        card.classList.add('resolved');
        const p = card.querySelector('p');
        p.innerHTML = "âœ… è§€å¿µå·²é‡æ¸…ï¼";
    }

    function toggleHint(id) {
        const hint = document.getElementById(id);
        hint.style.display = (hint.style.display === 'block') ? 'none' : 'block';
    }

    /* --- é‡ç½®åŠŸèƒ½ --- */
    function resetAll() {
        // 1. é‡ç½®éŠæˆ²
        const source = document.getElementById('drag-source');
        const draggables = document.querySelectorAll('.draggable');
        draggables.forEach(d => {
            d.style.border = "none";
            source.appendChild(d); // æŠŠæ‰€æœ‰å¡ç‰‡ä¸Ÿå›åŸé»
        });
        selectedItem = null;
        document.getElementById('game-result').style.display = 'none';

        // 2. é‡ç½®æ¸¬é©—
        document.getElementById('quiz-form').reset();
        document.getElementById('quiz-result').style.display = 'none';

        // 3. é‡ç½®è§£æé¡¯ç¤º
        document.querySelectorAll('.hint-text').forEach(h => h.style.display = 'none');

        // 4. é‡ç½®é™·é˜±å¡
        document.querySelectorAll('.trap-card').forEach(c => {
            c.classList.remove('resolved');
            // æ¢å¾©åŸå§‹æ–‡å­—éœ€è¦é‡æ–°è¼‰å…¥æˆ–å¯«æ­»æ–‡å­—ï¼Œé€™è£¡ç°¡å–®è™•ç†ï¼šåƒ…ç§»é™¤æ¨£å¼
            // è‹¥è¦ç²¾ç´°é‚„åŸæ–‡å­—è¼ƒè¤‡é›œï¼Œæ­¤è™•ä¸»è¦é‚„åŸå¯é»æ“Šç‹€æ…‹
        });
        
        // 5. é‡ç½®è³‡è¨Šé¡¯ç¤º
        document.getElementById('unit-info-display').innerHTML = "ğŸ‘† é»æ“Šä¸Šæ–¹æ–¹å¡Šï¼ŒæŸ¥çœ‹å„å–®å…ƒåŠŸèƒ½è©³è§£";
        document.getElementById('unit-info-display').style.borderLeft = "none";

        // æ»¾å‹•åˆ°é ‚éƒ¨
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
</script>

</body>
</html>