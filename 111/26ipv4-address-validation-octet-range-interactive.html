<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¡Œç›® 26ï¼šIPv4 ä½å€åˆ¤æ–·äº’å‹•è¬›ç¾©</title>
    <style>
        /* --- åŸºç¤è¨­å®š --- */
        :root {
            --primary-color: #2c3e50; /* è£œç¿’ç­è¬›ç¾©æ·±è— */
            --accent-color: #3498db; /* é‡é»è— */
            --success-color: #27ae60; /* æ­£ç¢ºç¶  */
            --error-color: #c0392b; /* éŒ¯èª¤ç´… */
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-color: #333;
        }

        body {
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* --- é€šç”¨å…ƒä»¶ --- */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid var(--accent-color);
        }

        h1, h2, h3 {
            color: var(--primary-color);
            margin-top: 0;
        }

        h1 {
            text-align: center;
            border-bottom: 2px solid #ddd;
            padding-bottom: 15px;
        }

        .highlight {
            color: var(--error-color);
            font-weight: bold;
            background-color: #fdeaea;
            padding: 2px 5px;
            border-radius: 4px;
        }

        .success-text {
            color: var(--success-color);
            font-weight: bold;
        }

        .tag {
            display: inline-block;
            background: #eee;
            color: #555;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.85em;
            margin-right: 5px;
        }

        button {
            cursor: pointer;
            border: none;
            border-radius: 6px;
            padding: 10px 20px;
            font-size: 1rem;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .btn-primary {
            background-color: var(--accent-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: #2980b9;
        }

        .btn-reset {
            background-color: #7f8c8d;
            color: white;
            display: block;
            margin: 30px auto;
        }

        /* --- é¡Œç›®å€å¡Š --- */
        .question-box {
            background-color: #e8f4fd;
            border: 2px solid #b3d7f2;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }

        .option-btn {
            background: white;
            border: 2px solid #ddd;
            padding: 15px;
            text-align: left;
            font-size: 1.1rem;
            position: relative;
        }

        .option-btn:hover {
            border-color: var(--accent-color);
        }

        .option-btn.correct {
            border-color: var(--success-color);
            background-color: #eafaf1;
        }

        .option-btn.wrong {
            border-color: var(--error-color);
            background-color: #fdedec;
        }

        .feedback-area {
            margin-top: 15px;
            font-weight: bold;
            min-height: 1.6em;
        }

        /* --- äº’å‹•æª¢æŸ¥å™¨ --- */
        .ip-checker-container {
            text-align: center;
        }

        .ip-input-wrapper {
            margin-bottom: 20px;
        }

        #customIpInput {
            padding: 10px;
            font-size: 1.2rem;
            width: 80%;
            max-width: 300px;
            border: 2px solid #ddd;
            border-radius: 6px;
            text-align: center;
        }

        .segments-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .segment-box {
            width: 80px;
            height: 80px;
            border: 3px solid #ddd;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: white;
            position: relative;
        }

        .segment-box .value {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .segment-box .status {
            font-size: 0.8rem;
            margin-top: 5px;
        }

        .segment-box.valid {
            border-color: var(--success-color);
            color: var(--success-color);
        }

        .segment-box.invalid {
            border-color: var(--error-color);
            color: var(--error-color);
            background-color: #fff0f0;
        }

        .dot {
            font-size: 2rem;
            color: #aaa;
            font-weight: bold;
        }

        .checker-result {
            margin-top: 20px;
            font-size: 1.2rem;
            font-weight: bold;
        }

        /* --- äºŒé€²ä½è§£é‡‹ --- */
        .binary-explanation {
            display: none;
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px dashed #ccc;
        }

        /* --- é™·é˜±å¡ --- */
        .trap-cards {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .trap-card {
            flex: 1;
            min-width: 250px;
            background: #fff8e1;
            border: 1px solid #ffe082;
            padding: 15px;
            border-radius: 8px;
            position: relative;
            transition: opacity 0.5s;
        }

        .trap-card h4 {
            margin-top: 0;
            color: #f39c12;
        }

        .close-trap {
            margin-top: 10px;
            background: none;
            border: 1px solid #aaa;
            padding: 5px 10px;
            font-size: 0.9rem;
        }

        .close-trap:hover {
            background: #eee;
        }

        /* --- å¿«é€Ÿå°æ¸¬é©— --- */
        .quiz-box {
            text-align: center;
            padding: 20px;
            background: #f0f3f4;
            border-radius: 8px;
        }

        .quiz-ip {
            font-size: 2rem;
            font-family: monospace;
            margin: 15px 0;
            letter-spacing: 2px;
        }

        .quiz-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .btn-quiz-yes { background-color: var(--success-color); color: white; }
        .btn-quiz-no { background-color: var(--error-color); color: white; }
        
        .quiz-feedback {
            margin-top: 15px;
            font-weight: bold;
            min-height: 1.5em;
        }

        /* --- è‡ªæˆ‘æª¢æ¸¬ --- */
        .self-check-item {
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }
        .hint-box {
            display: none;
            margin-top: 10px;
            color: #555;
            background: #eee;
            padding: 10px;
            border-radius: 4px;
        }

        /* --- éŸ¿æ‡‰å¼ --- */
        @media (max-width: 600px) {
            .options-grid { grid-template-columns: 1fr; }
            .segments-display { gap: 5px; }
            .segment-box { width: 60px; height: 60px; }
            .segment-box .value { font-size: 1.1rem; }
        }
    </style>
</head>
<body>

<div class="container">
    <!-- é é ­ -->
    <header>
        <h1>ç¶²è·¯åŸºç¤è§€å¿µè¡åˆºç­ï¼šé¡Œç›® 26</h1>
        <p style="text-align: center; color: #666;">é‡å°ã€ŒIP ä½å€æ ¼å¼èˆ‡æª¢æŸ¥ã€çš„é‡é»äº’å‹•è¬›ç¾©</p>
    </header>

    <!-- 1. é¡Œç›®å±•ç¤ºå€ -->
    <section class="card">
        <h3><span class="tag">è€ƒé¡Œ</span>é¡Œç›® 26</h3>
        <div class="question-box">
            <p><strong>IP ä½å€ç”±å››çµ„æ•¸å­—çµ„æˆï¼Œä¸‹åˆ—ä½•è€…æ˜¯æ­£ç¢ºçš„ IPï¼Ÿ</strong></p>
            <div class="options-grid">
                <button class="option-btn" onclick="checkAnswer('A', this)">
                    (A) 266.140.32.103
                </button>
                <button class="option-btn" onclick="checkAnswer('B', this)">
                    (B) 104.124.230.161
                </button>
                <button class="option-btn" onclick="checkAnswer('C', this)">
                    (C) 118.214.253.256
                </button>
                <button class="option-btn" onclick="checkAnswer('D', this)">
                    (D) 98.303.136.24
                </button>
            </div>
            <div id="answerFeedback" class="feedback-area"></div>
        </div>
        <p style="font-size: 0.9rem; color: #888;">* é»é¸ä¸Šæ–¹é¸é …å³å¯æŸ¥çœ‹è§£æ</p>
    </section>

    <!-- 2. æ ¸å¿ƒè§€å¿µå€ -->
    <section class="card">
        <h3><span class="tag">è§€å¿µ</span>ä»€éº¼æ˜¯ IPv4ï¼Ÿ</h3>
        <p>åœ¨æˆ‘å€‘åšé¡Œå‰ï¼Œå…ˆææ‡‚ä¸‰å€‹é—œéµå­—ï¼š</p>
        <ul>
            <li><strong>IP ä½å€</strong>ï¼šå°±åƒç¶²è·¯ä¸Šçš„é–€ç‰Œè™Ÿç¢¼ï¼Œç”¨ä¾†æ‰¾åˆ°ä½ çš„é›»è…¦æˆ–æ‰‹æ©Ÿã€‚</li>
            <li><strong>IPv4</strong>ï¼šç›®å‰æœ€å¸¸ç”¨çš„é–€ç‰Œæ ¼å¼ï¼Œç”±å››çµ„æ•¸å­—çµ„æˆã€‚</li>
            <li><strong>å…«ä½å…ƒçµ„ (Octet)</strong>ï¼šå°±æ˜¯é‚£ä¸€çµ„æ•¸å­—ï¼Œå› ç‚ºé›»è…¦ç”¨ 8 å€‹ä½å…ƒ (bits) å­˜å®ƒã€‚</li>
            <li><strong>é»åˆ†åé€²ä½</strong>ï¼šç”¨ã€Œ.ã€æŠŠå››çµ„æ•¸å­—éš”é–‹çš„å¯«æ³• (ä¾‹å¦‚ 192.168.0.1)ã€‚</li>
        </ul>
        
        <div style="background-color: #fffde7; padding: 15px; border-left: 4px solid #f1c40f;">
            <strong>â˜… å¿…è€ƒè¦å‰‡ (å£è¨£ï¼š0 åˆ° 255)</strong>
            <ol>
                <li>IPv4 ä¸€å®šç”±ã€Œå››çµ„æ•¸å­—ã€çµ„æˆã€‚</li>
                <li>æ¯çµ„æ•¸å­—ä¸­é–“ç”¨ã€Œ.ã€åˆ†é–‹ã€‚</li>
                <li>æ¯ä¸€çµ„æ•¸å­—ç¯„åœå¿…é ˆæ˜¯ <span class="highlight">0 ~ 255</span>ã€‚</li>
                <li>åªè¦æœ‰ä»»ä½•ä¸€çµ„è¶…é 255ï¼Œå°±æ˜¯éŒ¯çš„ï¼</li>
            </ol>
        </div>

        <!-- 0-255 åŸç†è§£æ -->
        <div style="margin-top: 15px;">
            <button class="btn-primary" style="padding: 8px 15px; font-size: 0.9rem;" onclick="toggleBinary()">
                ğŸ’¡ ç‚ºä»€éº¼æœ€å¤§æ˜¯ 255ï¼Ÿ (é»æˆ‘çœ‹åŸç†)
            </button>
            <div id="binaryInfo" class="binary-explanation">
                <p>é›»è…¦åªçœ‹å¾—æ‡‚ 0 å’Œ 1 (äºŒé€²ä½)ã€‚</p>
                <p>IPv4 çš„æ¯ä¸€æ®µéƒ½ä½¿ç”¨ <strong>8 å€‹ä½å…ƒ (8 bits)</strong> ä¾†å„²å­˜ã€‚</p>
                <ul>
                    <li>æœ€å°å€¼ (8å€‹0)ï¼š<code>00000000</code> = <strong>0</strong></li>
                    <li>æœ€å¤§å€¼ (8å€‹1)ï¼š<code>11111111</code> = <strong>255</strong></li>
                </ul>
                <p>ç®—å¼ï¼š2 çš„ 8 æ¬¡æ–¹ = 256 ç¨®çµ„åˆ (å¾ 0 ç®—åˆ° 255)ã€‚æ‰€ä»¥çµ•å°ä¸å¯èƒ½å‡ºç¾ 256 æˆ–æ›´å¤§çš„æ•¸å­—ï¼</p>
            </div>
        </div>
    </section>

    <!-- 3. äº’å‹•æª¢æŸ¥å™¨ (æ ¸å¿ƒåŠŸèƒ½) -->
    <section class="card">
        <h3><span class="tag">å·¥å…·</span>IP ç…§å¦–é¡ï¼šé€æ®µæª¢æŸ¥å™¨</h3>
        <p>è¼¸å…¥ä¸€å€‹ IPï¼Œæˆ‘å€‘ä¾†ä¸€æ®µä¸€æ®µæ‹†é–‹æª¢æŸ¥ï¼š</p>
        
        <div class="ip-checker-container">
            <div class="ip-input-wrapper">
                <input type="text" id="customIpInput" placeholder="è¼¸å…¥ IP (ä¾‹å¦‚ 192.168.1.1)" value="266.140.32.103" oninput="validateIP()">
                <div style="margin-top: 10px;">
                    <button style="font-size: 0.8rem; padding: 5px 10px;" onclick="setDemoIP('266.140.32.103')">è©¦è©¦ (A)</button>
                    <button style="font-size: 0.8rem; padding: 5px 10px;" onclick="setDemoIP('104.124.230.161')">è©¦è©¦ (B)</button>
                    <button style="font-size: 0.8rem; padding: 5px 10px;" onclick="setDemoIP('118.214.253.256')">è©¦è©¦ (C)</button>
                </div>
            </div>

            <div class="segments-display">
                <!-- ç¬¬ä¸€æ®µ -->
                <div class="segment-box" id="seg1-box">
                    <span class="value" id="seg1-val">---</span>
                    <span class="status" id="seg1-status">å¾…å‘½</span>
                </div>
                <div class="dot">.</div>
                <!-- ç¬¬äºŒæ®µ -->
                <div class="segment-box" id="seg2-box">
                    <span class="value" id="seg2-val">---</span>
                    <span class="status" id="seg2-status">å¾…å‘½</span>
                </div>
                <div class="dot">.</div>
                <!-- ç¬¬ä¸‰æ®µ -->
                <div class="segment-box" id="seg3-box">
                    <span class="value" id="seg3-val">---</span>
                    <span class="status" id="seg3-status">å¾…å‘½</span>
                </div>
                <div class="dot">.</div>
                <!-- ç¬¬å››æ®µ -->
                <div class="segment-box" id="seg4-box">
                    <span class="value" id="seg4-val">---</span>
                    <span class="status" id="seg4-status">å¾…å‘½</span>
                </div>
            </div>

            <div id="checkerResult" class="checker-result">è«‹è¼¸å…¥ IP é€²è¡Œæª¢æŸ¥...</div>
        </div>
    </section>

    <!-- 4. å¸¸è¦‹é™·é˜±å€ -->
    <section class="card">
        <h3><span class="tag">å¿…è®€</span>å¸¸è¦‹è€ƒè©¦é™·é˜±</h3>
        <p>é»æ“Šã€Œæˆ‘æ‡‚äº†ã€å¯ä»¥æ¶ˆé™¤é€™äº›éŒ¯èª¤è§€å¿µå¡ç‰‡ï¼š</p>
        <div class="trap-cards" id="trapZone">
            <div class="trap-card">
                <h4>âŒ é™·é˜± 1ï¼šä»¥ç‚ºæœ‰å››æ®µå°±å°</h4>
                <p>æœ‰äº›é¸é …æ˜¯å››çµ„æ•¸å­—ï¼Œä½†å…¶ä¸­ä¸€çµ„æ˜¯ 300ï¼Œé€™æ˜¯éŒ¯çš„ï¼ä¸èƒ½åªæ•¸æ®µæ•¸ã€‚</p>
                <button class="close-trap" onclick="dismissCard(this)">æˆ‘æ‡‚äº† ğŸ‘Œ</button>
            </div>
            <div class="trap-card">
                <h4>âŒ é™·é˜± 2ï¼šä»¥ç‚º 256 ä¹Ÿå¯ä»¥</h4>
                <p>256 å‰›å¥½è¶…é 255 ä¸€é»é»ï¼Œæœ€å®¹æ˜“çœ¼èŠ±é¸éŒ¯ã€‚è¨˜ä½ï¼š0~255ã€‚</p>
                <button class="close-trap" onclick="dismissCard(this)">æˆ‘æ‡‚äº† ğŸ‘Œ</button>
            </div>
            <div class="trap-card">
                <h4>âŒ é™·é˜± 3ï¼šåªæª¢æŸ¥å‰é¢</h4>
                <p>å¾ˆå¤šé¡Œç›®æ•…æ„å‰é¢éƒ½æ­£å¸¸ (å¦‚ 192.168...)ï¼ŒéŒ¯åœ¨æœ€å¾Œä¸€å€‹æ•¸å­—ã€‚è¦å…¨éƒ¨çœ‹å®Œï¼</p>
                <button class="close-trap" onclick="dismissCard(this)">æˆ‘æ‡‚äº† ğŸ‘Œ</button>
            </div>
        </div>
    </section>

    <!-- 5. å¿«é€Ÿæ¸¬é©— -->
    <section class="card">
        <h3><span class="tag">å¯¦æˆ°</span>å¿«é€Ÿåˆ¤æ–·å°æ¸¬é©—</h3>
        <p>è¨“ç·´ä½ çš„ç›´è¦ºï¼é€™å€‹ IP åˆæ³•å—ï¼Ÿ</p>
        
        <div class="quiz-box">
            <div id="quizDisplay" class="quiz-ip">Loading...</div>
            <div class="quiz-buttons">
                <button class="btn-quiz-yes" onclick="answerQuiz(true)">åˆæ³• (O)</button>
                <button class="btn-quiz-no" onclick="answerQuiz(false)">ä¸åˆæ³• (X)</button>
            </div>
            <div id="quizFeedback" class="quiz-feedback"></div>
            <button onclick="generateQuiz()" style="margin-top: 10px; font-size: 0.9rem; background: #ddd;">ä¸‹ä¸€é¡Œ â¡</button>
        </div>
    </section>

    <!-- 6. è‡ªæˆ‘æª¢æ¸¬ -->
    <section class="card">
        <h3><span class="tag">æ€è€ƒ</span>è‡ªæˆ‘æª¢æ¸¬ (ä¸çµ¦ç­”æ¡ˆï¼Œæƒ³ä¸€ä¸‹)</h3>
        
        <div class="self-check-item">
            <strong>Q1ï¼šç‚ºä»€éº¼ IPv4 æ¯ä¸€æ®µæœ€å¤§æ˜¯ 255ï¼Œä¸æ˜¯ 999ï¼Ÿ</strong>
            <br>
            <button onclick="toggleHint('hint1')" style="font-size: 0.8rem; margin-top: 5px; padding: 3px 8px;">é¡¯ç¤ºæç¤º</button>
            <div id="hint1" class="hint-box">æç¤ºï¼šå›æƒ³ä¸€ä¸‹é›»è…¦æ˜¯ç”¨ä»€éº¼é€²ä½åˆ¶ï¼Ÿ8 å€‹ä½å…ƒ (bits) å…¨æ»¿æ˜¯å¤šå°‘ï¼Ÿ</div>
        </div>

        <div class="self-check-item">
            <strong>Q2ï¼š127.0.0.1 ç‚ºä»€éº¼æ˜¯åˆæ³•çš„ï¼Ÿçœ‹èµ·ä¾†å¾ˆæ€ªï¼Ÿ</strong>
            <br>
            <button onclick="toggleHint('hint2')" style="font-size: 0.8rem; margin-top: 5px; padding: 3px 8px;">é¡¯ç¤ºæç¤º</button>
            <div id="hint2" class="hint-box">æç¤ºï¼šå¥—ç”¨ã€Œ0~255ã€è¦å‰‡æª¢æŸ¥çœ‹çœ‹ã€‚127 åœ¨ç¯„åœå…§å—ï¼Ÿ0 åœ¨ç¯„åœå…§å—ï¼Ÿ1 å‘¢ï¼Ÿå¦‚æœéƒ½åœ¨ï¼Œå®ƒå°±æ˜¯åˆæ³•çš„æ ¼å¼ (é›–ç„¶å®ƒæœ‰ç‰¹æ®Šç”¨é€”)ã€‚</div>
        </div>

        <div class="self-check-item">
            <strong>Q3ï¼šå¦‚æœé¡Œç›®å•ã€Œä¸‹åˆ—å“ªä¸€å€‹ IP ä¸€å®šéŒ¯ã€ï¼Œä½ æœƒæ€éº¼å¿«é€Ÿæƒæï¼Ÿ</strong>
            <br>
            <button onclick="toggleHint('hint3')" style="font-size: 0.8rem; margin-top: 5px; padding: 3px 8px;">é¡¯ç¤ºæç¤º</button>
            <div id="hint3" class="hint-box">æç¤ºï¼šä¸è¦å¾é ­è®€åˆ°å°¾ã€‚ç›´æ¥æƒææœ‰æ²’æœ‰æ•¸å­—ã€Œå¤§æ–¼ 255ã€çš„ï¼Ÿæˆ–æ˜¯é•·åº¦ã€Œä¸æ˜¯4æ®µã€çš„ï¼Ÿé€™å«æ¶ˆå»æ³•ã€‚</div>
        </div>
    </section>

    <!-- å…¨å±€é‡ç½® -->
    <button class="btn-reset" onclick="resetAll()">ğŸ”„ å…¨éƒ¨é‡ç½® (é‡æ–°é–‹å§‹)</button>

    <footer style="text-align: center; color: #aaa; margin-top: 50px; font-size: 0.8rem;">
        &copy; 2024 é«˜ä¸­è³‡è¨Šå­¸ç§‘ä¸­å¿ƒ | äº’å‹•è¬›ç¾©ç”Ÿæˆç¯„ä¾‹
    </footer>
</div>

<script>
    /* --- å…¨åŸŸè®Šæ•¸ --- */
    let currentQuizIsVald = false;

    /* --- åˆå§‹åŒ– --- */
    window.onload = function() {
        validateIP(); // åˆå§‹åŒ–æª¢æŸ¥å™¨
        generateQuiz(); // åˆå§‹åŒ–æ¸¬é©—
    };

    /* --- åŠŸèƒ½ 1: é¡Œç›® 26 é¸é …è§£æ --- */
    function checkAnswer(option, btnElement) {
        const feedback = document.getElementById('answerFeedback');
        
        // é‡ç½®æ‰€æœ‰æŒ‰éˆ•æ¨£å¼
        document.querySelectorAll('.option-btn').forEach(btn => {
            btn.classList.remove('correct', 'wrong');
        });

        // æ ¹æ“šé¸é …åˆ¤æ–·
        if (option === 'B') {
            btnElement.classList.add('correct');
            feedback.innerHTML = '<span style="color:var(--success-color)">âœ… ç­”å°äº†ï¼</span><br>è§£æï¼š104, 124, 230, 161 é€™å››å€‹æ•¸å­—å…¨éƒ¨éƒ½åœ¨ 0~255 çš„ç¯„åœå…§ï¼Œå®Œå…¨ç¬¦åˆ IPv4 è¦å‰‡ã€‚';
        } else {
            btnElement.classList.add('wrong');
            let reason = "";
            if (option === 'A') reason = "ç¬¬ä¸€æ®µ 266 è¶…éäº† 255ï¼Œæ‰€ä»¥éŒ¯èª¤ã€‚";
            if (option === 'C') reason = "ç¬¬å››æ®µ 256 è¶…éäº† 255 (æœ€å¤§åªèƒ½åˆ° 255)ï¼Œæ‰€ä»¥éŒ¯èª¤ã€‚";
            if (option === 'D') reason = "ç¬¬äºŒæ®µ 303 è¶…éäº† 255ï¼Œæ‰€ä»¥éŒ¯èª¤ã€‚";
            
            feedback.innerHTML = '<span style="color:var(--error-color)">âŒ ç­”éŒ¯äº†ã€‚</span><br>è§£æï¼š' + reason;
        }
    }

    /* --- åŠŸèƒ½ 2: IP é€æ®µæª¢æŸ¥å™¨ --- */
    function setDemoIP(ip) {
        document.getElementById('customIpInput').value = ip;
        validateIP();
    }

    function validateIP() {
        const input = document.getElementById('customIpInput').value.trim();
        const segments = input.split('.');
        const resultDiv = document.getElementById('checkerResult');
        
        let allValid = true;
        let errorMsg = "";

        // æª¢æŸ¥æ®µæ•¸
        if (segments.length !== 4) {
            allValid = false;
            errorMsg = "æ ¼å¼éŒ¯èª¤ï¼šå¿…é ˆå‰›å¥½æœ‰ 4 çµ„æ•¸å­—";
            // è¦–è¦ºä¸Šæ¸…ç©ºæˆ–é¡¯ç¤ºéŒ¯èª¤
            updateSegmentVisuals(['?','?','?','?'], [false, false, false, false]);
            resultDiv.innerHTML = `<span style="color:var(--error-color)">âŒ ${errorMsg}</span>`;
            return;
        }

        // é€æ®µæª¢æŸ¥
        let visualValues = [];
        let visualStatus = [];

        for (let i = 0; i < 4; i++) {
            let segStr = segments[i];
            visualValues.push(segStr === "" ? "?" : segStr);

            // æª¢æŸ¥æ˜¯å¦ç‚ºç©º
            if (segStr === "") {
                visualStatus.push(false);
                allValid = false;
                continue;
            }

            // æª¢æŸ¥æ˜¯å¦ç‚ºç´”æ•¸å­— (åˆ©ç”¨ Regex è¼ƒåš´è¬¹ï¼Œæˆ–ç°¡å–® isNaN)
            if (isNaN(segStr)) {
                visualStatus.push(false);
                allValid = false;
                continue;
            }

            let num = Number(segStr);
            
            // æª¢æŸ¥ç¯„åœ 0-255
            if (num >= 0 && num <= 255) {
                visualStatus.push(true);
            } else {
                visualStatus.push(false);
                allValid = false;
                if(num > 255) errorMsg = "æœ‰æ•¸å­—è¶…é 255 äº†ï¼";
                else errorMsg = "æ•¸å­—ä¸åˆæ³•";
            }
        }

        updateSegmentVisuals(visualValues, visualStatus);

        if (allValid) {
            resultDiv.innerHTML = '<span style="color:var(--success-color)">âœ… æ­å–œï¼é€™æ˜¯ä¸€å€‹åˆæ³•çš„ IPv4 ä½å€ã€‚</span>';
        } else {
            resultDiv.innerHTML = `<span style="color:var(--error-color)">âŒ ä¸åˆæ³•ï¼š${errorMsg || "è«‹æª¢æŸ¥ç´…è‰²å€å¡Š"}</span>`;
        }
    }

    function updateSegmentVisuals(values, statuses) {
        for (let i = 0; i < 4; i++) {
            const box = document.getElementById(`seg${i+1}-box`);
            const valSpan = document.getElementById(`seg${i+1}-val`);
            const statusSpan = document.getElementById(`seg${i+1}-status`);

            valSpan.textContent = values[i];
            
            // ç§»é™¤èˆŠ class
            box.classList.remove('valid', 'invalid');

            if (statuses[i]) {
                box.classList.add('valid');
                statusSpan.textContent = "OK";
            } else {
                box.classList.add('invalid');
                statusSpan.textContent = "éŒ¯èª¤";
            }
        }
    }

    /* --- åŠŸèƒ½ 3: äºŒé€²ä½åŸç†åˆ‡æ› --- */
    function toggleBinary() {
        const div = document.getElementById('binaryInfo');
        if (div.style.display === 'block') {
            div.style.display = 'none';
        } else {
            div.style.display = 'block';
        }
    }

    /* --- åŠŸèƒ½ 4: é™·é˜±å¡é—œé–‰ --- */
    function dismissCard(btn) {
        const card = btn.parentElement;
        card.style.opacity = '0';
        setTimeout(() => {
            card.style.display = 'none';
        }, 500);
    }

    /* --- åŠŸèƒ½ 5: å¿«é€Ÿæ¸¬é©—ç”Ÿæˆ --- */
    function generateQuiz() {
        document.getElementById('quizFeedback').innerHTML = "";
        
        // éš¨æ©Ÿæ±ºå®šè¦å‡ºé¡Œç›®æ˜¯å°çš„é‚„æ˜¯éŒ¯çš„ (50% æ©Ÿç‡)
        currentQuizIsVald = Math.random() > 0.5;

        let ipParts = [];
        if (currentQuizIsVald) {
            // ç”Ÿæˆåˆæ³• IP
            for(let i=0; i<4; i++) ipParts.push(Math.floor(Math.random() * 256));
        } else {
            // ç”Ÿæˆéæ³• IP
            for(let i=0; i<4; i++) ipParts.push(Math.floor(Math.random() * 256));
            // éš¨æ©ŸæŒ‘ä¸€å€‹ä½ç½®æ”¹æˆéŒ¯çš„ (256 ~ 350)
            let badIndex = Math.floor(Math.random() * 4);
            ipParts[badIndex] = Math.floor(Math.random() * 95) + 256; 
        }

        document.getElementById('quizDisplay').textContent = ipParts.join('.');
    }

    function answerQuiz(userSaysValid) {
        const feedback = document.getElementById('quizFeedback');
        
        if (userSaysValid === currentQuizIsVald) {
            feedback.innerHTML = '<span style="color:var(--success-color)">ğŸ‰ ç­”å°äº†ï¼</span> ä½ åæ‡‰çœŸå¿«ã€‚';
        } else {
            if (currentQuizIsVald) {
                feedback.innerHTML = '<span style="color:var(--error-color)">ğŸ’¥ ç­”éŒ¯äº†ï¼</span> é€™å…¶å¯¦æ˜¯åˆæ³•çš„ï¼Œæ¯å€‹æ•¸å­—éƒ½åœ¨ 0~255 å…§ã€‚';
            } else {
                // æ‰¾å‡ºå“ªå€‹éŒ¯
                let parts = document.getElementById('quizDisplay').textContent.split('.');
                let badNum = parts.find(p => Number(p) > 255);
                feedback.innerHTML = `<span style="color:var(--error-color)">ğŸ’¥ ç­”éŒ¯äº†ï¼</span> é€™æ˜¯éŒ¯çš„ï¼Œå› ç‚º <strong>${badNum}</strong> è¶…é 255 äº†ã€‚`;
            }
        }
    }

    /* --- åŠŸèƒ½ 6: è‡ªæˆ‘æª¢æ¸¬æç¤º --- */
    function toggleHint(id) {
        const hint = document.getElementById(id);
        hint.style.display = (hint.style.display === 'block') ? 'none' : 'block';
    }

    /* --- åŠŸèƒ½ 7: å…¨éƒ¨é‡ç½® --- */
    function resetAll() {
        // é‡ç½®é¡Œç›® 26
        document.querySelectorAll('.option-btn').forEach(btn => btn.classList.remove('correct', 'wrong'));
        document.getElementById('answerFeedback').innerHTML = "";

        // é‡ç½®åŸç†å€
        document.getElementById('binaryInfo').style.display = 'none';

        // é‡ç½®æª¢æŸ¥å™¨
        document.getElementById('customIpInput').value = "266.140.32.103";
        validateIP();

        // é‡ç½®é™·é˜±å¡ (æ¢å¾©é¡¯ç¤º)
        document.querySelectorAll('.trap-card').forEach(card => {
            card.style.display = 'block';
            card.style.opacity = '1';
        });

        // é‡ç½®æ¸¬é©—
        generateQuiz();

        // é‡ç½®æç¤º
        document.querySelectorAll('.hint-box').forEach(box => box.style.display = 'none');
        
        alert("é é¢å·²é‡ç½®ï¼Œè®“æˆ‘å€‘é‡æ–°è¤‡ç¿’ä¸€æ¬¡ï¼");
    }
</script>

</body>
</html>