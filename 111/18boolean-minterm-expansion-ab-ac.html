<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¸ƒæ—ä»£æ•¸äº’å‹•æ•™å­¸ï¼šæœ€å°é …å±•é–‹</title>
    <style>
        /* --- åŸºç¤æ¨£å¼é‡ç½® --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: "Microsoft JhengHei", "PingFang TC", sans-serif;
            line-height: 1.6;
            background-color: #f0f2f5;
            color: #333;
            padding: 20px;
        }

        /* --- ç‰ˆé¢é…ç½® --- */
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: transparent;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* --- å¡ç‰‡å¼è¨­è¨ˆ --- */
        .card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border-left: 5px solid #3498db; /* è£é£¾ç·š */
        }

        .card h2 {
            font-size: 1.4rem;
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 10px;
        }

        .card h3 {
            font-size: 1.1rem;
            margin: 15px 0 10px;
            color: #7f8c8d;
        }

        /* --- å°ˆæœ‰åè©å€å¡Š --- */
        .term-box {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .term {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #e9ecef;
        }

        .term strong {
            color: #e74c3c;
            display: block;
            margin-bottom: 5px;
        }

        /* --- æ•¸å­¸å¼é¡¯ç¤º --- */
        .math-display {
            font-family: "Consolas", "Monaco", monospace;
            background-color: #2c3e50;
            color: #f1c40f;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
            font-size: 1.2rem;
            margin: 15px 0;
            letter-spacing: 1px;
        }

        .step-item {
            padding: 10px;
            margin: 5px 0;
            border-left: 3px solid #bdc3c7;
            background: #fdfdfd;
            display: none; /* é è¨­éš±è—ï¼Œé€é JS é¡¯ç¤º */
            animation: fadeIn 0.5s ease;
        }

        .step-item.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- æŒ‰éˆ•æ¨£å¼ --- */
        .btn {
            display: inline-block;
            padding: 10px 20px;
            font-size: 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.2s;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn-primary { background-color: #3498db; color: white; }
        .btn-primary:hover { background-color: #2980b9; }

        .btn-success { background-color: #27ae60; color: white; }
        .btn-success:hover { background-color: #219150; }

        .btn-danger { background-color: #e74c3c; color: white; }
        .btn-danger:hover { background-color: #c0392b; }

        .btn-secondary { background-color: #95a5a6; color: white; }
        .btn-secondary:hover { background-color: #7f8c8d; }

        /* --- è¼¸å…¥èˆ‡äº’å‹• --- */
        input[type="text"] {
            padding: 8px;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            font-family: monospace;
            width: 200px;
        }

        select {
            padding: 8px;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
        }

        .feedback {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            font-weight: bold;
        }
        .feedback.correct { background-color: #d4edda; color: #155724; }
        .feedback.wrong { background-color: #f8d7da; color: #721c24; }

        /* --- çœŸå€¼è¡¨ --- */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.9rem;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }

        tr:nth-child(even) { background-color: #f9f9f9; }

        tr.mismatch {
            background-color: #f8d7da !important; /* ç´…è‰²æ¨™ç¤ºéŒ¯èª¤åˆ— */
        }

        .comparison-controls {
            margin-bottom: 15px;
            background: #eef2f3;
            padding: 10px;
            border-radius: 5px;
        }

        /* --- é¡Œç›®é¸é … --- */
        .option-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-btn {
            text-align: left;
            background: white;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .option-btn:hover {
            background: #f0f8ff;
            border-color: #3498db;
        }

        .option-explanation {
            display: none;
            margin-top: 5px;
            padding: 10px;
            background: #fff3cd;
            border-radius: 4px;
            font-size: 0.9rem;
            color: #856404;
        }

        /* --- é å°¾ --- */
        footer {
            text-align: center;
            margin-top: 40px;
            color: #7f8c8d;
            font-size: 0.8rem;
        }

        /* æµ®å‹•é‡ç½®æŒ‰éˆ• */
        .reset-all-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

    </style>
</head>
<body>

    <header>
        <h1>å¸ƒæ—ä»£æ•¸èˆ‡é‚è¼¯é›»è·¯ï¼šæœ€å°é …å±•é–‹</h1>
        <p>è·Ÿè‘—è€å¸«ä¸€æ­¥æ­¥æ‹†è§£ï¼Œææ‡‚ã€Œç¼ºé …è£œé …ã€çš„æŠ€å·§ï¼</p>
    </header>

    <div class="container">

        <!-- 1. è§€å¿µå°è®€ -->
        <div class="card">
            <h2>ğŸ“¢ èª²å‰è§€å¿µè£œçµ¦ç«™</h2>
            <div class="term-box">
                <div class="term"><strong>å¸ƒæ—ä»£æ•¸ (Boolean Algebra)</strong>ç”¨ 0 èˆ‡ 1 ä¾†é‹ç®—çš„æ•¸å­¸ï¼Œæ˜¯é›»è…¦é‚è¼¯çš„åŸºç¤ã€‚</div>
                <div class="term"><strong>AND (ä¸”)</strong>å¯«æˆ ABã€‚å…©å€‹éƒ½è¦æ˜¯ 1ï¼Œçµæœæ‰æ˜¯ 1ã€‚</div>
                <div class="term"><strong>OR (æˆ–)</strong>å¯«æˆ A+Bã€‚åªè¦æœ‰ä¸€å€‹æ˜¯ 1ï¼Œçµæœå°±æ˜¯ 1ã€‚</div>
                <div class="term"><strong>åç›¸/è£œæ•¸ (NOT)</strong>å¯«æˆ A'ã€‚æŠŠ 1 è®Š 0ï¼ŒæŠŠ 0 è®Š 1ã€‚</div>
                <div class="term"><strong>æœ€å°é … (Minterm)</strong>åŒ…å«æ‰€æœ‰è®Šæ•¸çš„ä¹˜ç©é …ï¼ˆä¾‹å¦‚ ABC, A'BC'ï¼‰ã€‚</div>
                <div class="term"><strong>é‚è¼¯ç­‰åƒ¹ (Equivalence)</strong>ä¸ç®¡è¼¸å…¥ä»€éº¼ï¼Œå…©å€‹å¼å­çš„è¼¸å‡ºçµæœéƒ½å®Œå…¨ä¸€æ¨£ã€‚</div>
            </div>
        </div>

        <!-- 2. é¡Œç›®èˆ‡å…¬å¼å¡ -->
        <div class="card">
            <h2>ğŸ“ ä»Šæ—¥æŒ‘æˆ°é¡Œ</h2>
            <p>è«‹å°‡ä¸‹åˆ—å¸ƒæ—è¡¨ç¤ºå¼å±•é–‹æˆæ¨™æº–çš„ä¸‰è®Šæ•¸æœ€å°é … (Minterm) å½¢å¼ï¼š</p>
            <div class="math-display">Y = AB + AC</div>
            <p>è«‹å•å®ƒå’Œä¸‹åˆ—å“ªå€‹é¸é …ç›¸ç­‰ï¼Ÿ</p>
            <ul style="list-style: none; padding-left: 20px; line-height: 2;">
                <li>(A) ABC + ABC' + A'B'C</li>
                <li>(B) ABC + ABC' + AB'C'</li>
                <li>(C) A'BC + ABC' + AB'C</li>
                <li>(D) ABC + ABC' + AB'C</li>
            </ul>
        </div>

        <div class="card">
            <h2>ğŸ’¡ å…¬å¼å°å¡ (Cheat Sheet)</h2>
            <ul style="padding-left: 20px;">
                <li><strong>è£œé …åŸå‰‡ï¼š</strong> X = X(Y + Y') <span style="color:#7f8c8d">ï¼ˆå› ç‚º Y+Y'=1ï¼Œä¹˜ 1 ä¸è®Šï¼‰</span></li>
                <li><strong>åˆ†é…å¾‹ï¼š</strong> X(Y + Z) = XY + XZ</li>
                <li><strong>å»é‡å¾‹ï¼š</strong> X + X = X <span style="color:#7f8c8d">ï¼ˆåŒæ¨£çš„è¨Šè™ŸåŠ å…©æ¬¡é‚„æ˜¯ä¸€æ¨£ï¼‰</span></li>
            </ul>
        </div>

        <!-- 3. äº’å‹•å¼å…¬å¼æ‹†è§£ -->
        <div class="card">
            <h2>ğŸ” äº’å‹•æ¨å°ï¼šä¸€æ­¥æ­¥ä¾†</h2>
            <p>æˆ‘å€‘è¦æŠŠ Y = AB + AC è£œæˆå«æœ‰ A, B, C çš„å½¢å¼ã€‚</p>
            <div id="derivation-container">
                <!-- æ­¥é©Ÿå°‡ç”± JS å‹•æ…‹æ’å…¥ -->
            </div>
            <br>
            <button class="btn btn-primary" id="btn-next-step">ä¸‹ä¸€æ­¥ â¡ï¸</button>
            <button class="btn btn-secondary" id="btn-reset-steps">é‡æ–°é–‹å§‹ â†º</button>
        </div>

        <!-- 4. äº’å‹•ç·´ç¿’ï¼šè£œèª°å°±è£œèª° -->
        <div class="card">
            <h2>âœï¸ éš¨å ‚ç·´ç¿’ï¼šè£œé …å¤§è€ƒé©—</h2>
            <p>è©¦è‘—è‡ªå·±è£œè£œçœ‹ï¼ç¼ºä»€éº¼è®Šæ•¸ï¼Œå°±ä¹˜ä¸Š (ç¼º + ç¼º')ã€‚</p>
            
            <div style="margin: 15px 0;">
                <label>é¸æ“‡è¦å±•é–‹çš„é …ï¼š</label>
                <select id="practice-term">
                    <option value="AB">AB (ç¼º C)</option>
                    <option value="AC">AC (ç¼º B)</option>
                </select>
            </div>

            <p>è«‹è¼¸å…¥è£œé …å¾Œçš„çµæœï¼ˆä¾‹å¦‚è¼¸å…¥ <code>AB(C+C')</code>ï¼‰ï¼š</p>
            <div>
                <input type="text" id="practice-input" placeholder="åœ¨é€™è£¡è¼¸å…¥å¼å­...">
                <button class="btn btn-success" onclick="checkPractice()">æª¢æŸ¥ç­”æ¡ˆ</button>
            </div>
            <div id="practice-feedback" class="feedback" style="display:none;"></div>
        </div>

        <!-- 5. çœŸå€¼è¡¨é©—è­‰ -->
        <div class="card">
            <h2>ğŸ“Š çœŸå€¼è¡¨é©—è­‰ (Truth Table)</h2>
            <p>ä¸ç¢ºå®šç®—å¾—å°ä¸å°ï¼Ÿæˆ‘å€‘ç”¨ã€Œçª®èˆ‰æ³•ã€ä¾†æª¢æŸ¥ï¼</p>
            
            <div class="comparison-controls">
                <strong>å‹¾é¸è¦æ¯”è¼ƒçš„å°è±¡ï¼š</strong><br>
                <label><input type="checkbox" class="option-check" value="A"> é¸é … (A)</label>
                <label><input type="checkbox" class="option-check" value="B"> é¸é … (B)</label>
                <label><input type="checkbox" class="option-check" value="C"> é¸é … (C)</label>
                <label><input type="checkbox" class="option-check" value="D" checked> é¸é … (D)</label>
            </div>

            <div style="overflow-x: auto;">
                <table id="truth-table">
                    <thead>
                        <tr>
                            <th>A</th>
                            <th>B</th>
                            <th>C</th>
                            <th style="background-color: #fff3cd;">åŸå¼ Y = AB + AC</th>
                            <th class="col-opt-a">é¸é … (A)</th>
                            <th class="col-opt-b">é¸é … (B)</th>
                            <th class="col-opt-c">é¸é … (C)</th>
                            <th class="col-opt-d">é¸é … (D)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- è¡¨æ ¼å…§å®¹ç”± JS ç”Ÿæˆ -->
                    </tbody>
                </table>
            </div>
            <div id="table-analysis" style="margin-top: 10px; color: #e74c3c; font-weight: bold;"></div>
        </div>

        <!-- 6. é¸é …åˆ†æ -->
        <div class="card">
            <h2>ğŸ§ é¸é …åˆ†æ (é»æ“ŠæŸ¥çœ‹è©³è§£)</h2>
            <div class="option-group">
                <div class="option-btn" onclick="toggleExplanation('expl-a')">
                    <strong>(A) ABC + ABC' + A'B'C</strong>
                    <div id="expl-a" class="option-explanation">
                        âŒ éŒ¯èª¤ï¼å¤šäº† A'B'C é€™ä¸€é …ã€‚<br>
                        åŸå¼éœ€è¦ A=1 æ‰æœƒæ˜¯ 1 (AB æˆ– AC)ï¼Œä½†é€™å€‹é¸é …åœ¨ A=0 (0,0,1) æ™‚ä¹Ÿæœƒè¼¸å‡º 1ã€‚
                    </div>
                </div>
                <div class="option-btn" onclick="toggleExplanation('expl-b')">
                    <strong>(B) ABC + ABC' + AB'C'</strong>
                    <div id="expl-b" class="option-explanation">
                        âŒ éŒ¯èª¤ï¼ç¬¬ä¸‰é … AB'C' å¼„éŒ¯äº†ã€‚<br>
                        AC è£œé …å±•é–‹æ‡‰è©²æ˜¯ AC(B+B') = ABC + AB'Cï¼Œæœ€å¾Œä¸€é …æ‡‰è©²æ˜¯ C ä¸æ˜¯ C'ã€‚
                    </div>
                </div>
                <div class="option-btn" onclick="toggleExplanation('expl-c')">
                    <strong>(C) A'BC + ABC' + AB'C</strong>
                    <div id="expl-c" class="option-explanation">
                        âŒ éŒ¯èª¤ï¼å« A'BCã€‚<br>
                        åŒæ¨£çš„å•é¡Œï¼ŒåŸå¼è¦æ±‚ A å¿…é ˆç‚º 1ï¼Œé€™è£¡å‡ºç¾äº† A' (A=0) çš„é …ã€‚
                    </div>
                </div>
                <div class="option-btn" onclick="toggleExplanation('expl-d')">
                    <strong>(D) ABC + ABC' + AB'C</strong>
                    <div id="expl-d" class="option-explanation">
                        âœ… æ­£ç¢ºï¼<br>
                        1. AB å±•é–‹ = ABC + ABC'<br>
                        2. AC å±•é–‹ = ABC + AB'C<br>
                        3. åˆä½µå»é‡å¾Œæ­£æ˜¯æ­¤å¼ã€‚çœŸå€¼è¡¨çµæœä¹Ÿå®Œå…¨ä¸€è‡´ã€‚
                    </div>
                </div>
            </div>
        </div>

        <!-- 7. è‡ªæˆ‘æª¢æ¸¬ -->
        <div class="card">
            <h2>ğŸ† èª²å¾Œè‡ªæˆ‘æª¢æ¸¬</h2>
            
            <div style="margin-bottom: 20px;">
                <p><strong>é¡Œç›® 1ï¼š</strong>è‹¥ Y = AB + A'Cï¼Œè«‹è©¦è‘—å±•é–‹ã€‚</p>
                <button class="btn btn-secondary btn-sm" onclick="toggleHint('hint1')">é¡¯ç¤ºæç¤º</button>
                <p id="hint1" style="display:none; color: #d35400; margin-top:5px;">
                    æç¤ºï¼šAB ç¼º C (ä¹˜ C+C')ï¼›A'C ç¼º B (ä¹˜ B+B')ã€‚æ³¨æ„æœ‰ä¸€é …æ˜¯ A'B'C å–”ï¼
                </p>
            </div>

            <div style="margin-bottom: 20px;">
                <p><strong>é¡Œç›® 2ï¼š</strong>åŸé¡Œ Y = AB + ACï¼Œåœ¨å“ªå¹¾çµ„ (A,B,C) è¼¸å…¥ä¸‹æœƒè¼¸å‡º 1ï¼Ÿ</p>
                <button class="btn btn-secondary btn-sm" onclick="toggleHint('hint2')">é¡¯ç¤ºæç¤º</button>
                <p id="hint2" style="display:none; color: #d35400; margin-top:5px;">
                    æç¤ºï¼šçœ‹é¸é … (D) çš„ä¸‰é …ï¼šABC (111), ABC' (110), AB'C (101)ã€‚å…± 3 çµ„ã€‚
                </p>
            </div>

            <div>
                <p><strong>é¡Œç›® 3ï¼š</strong>è¦æŠŠ (D) çš„çµæœåŒ–ç°¡å› AB + ACï¼Œé—œéµç¬¬ä¸€æ­¥æ˜¯ä»€éº¼ï¼Ÿ</p>
                <button class="btn btn-secondary btn-sm" onclick="toggleHint('hint3')">é¡¯ç¤ºæç¤º</button>
                <p id="hint3" style="display:none; color: #d35400; margin-top:5px;">
                    æç¤ºï¼šé€†å‘æ“ä½œï¼æŠŠ ABC è¤‡è£½ä¸€ä»½ (X = X+X)ï¼Œè®Šæˆ ABC + ABC + ABC' + AB'Cï¼Œç„¶å¾Œå…©å…©åˆ†çµ„æå…¬å› å¼ã€‚
                </p>
            </div>
        </div>

    </div>

    <footer>
        <p>Created for Learning | äº’å‹•å¼æ•™å­¸è¬›ç¾© v1.0</p>
    </footer>

    <!-- å…¨å±€é‡ç½®æŒ‰éˆ• -->
    <button class="btn btn-danger reset-all-btn" onclick="resetAll()">ğŸ”„ å…¨éƒ¨é‡ç½®</button>

    <script>
        // --- 1. å…¬å¼æ‹†è§£äº’å‹•é‚è¼¯ ---
        const steps = [
            { text: "åŸå§‹é¡Œç›®", math: "Y = AB + AC" },
            { text: "Step 1: è™•ç†ç¬¬ä¸€é … AB (ç¼º C)ï¼Œåˆ©ç”¨è£œé …åŸå‰‡ä¹˜ä¸Š (C + C')", math: "AB = AB(C + C')" },
            { text: "Step 2: ä½¿ç”¨åˆ†é…å¾‹å±•é–‹", math: "AB = ABC + ABC'" },
            { text: "Step 3: è™•ç†ç¬¬äºŒé … AC (ç¼º B)ï¼Œåˆ©ç”¨è£œé …åŸå‰‡ä¹˜ä¸Š (B + B')", math: "AC = AC(B + B')" },
            { text: "Step 4: ä½¿ç”¨åˆ†é…å¾‹å±•é–‹ (ç¿’æ…£ä¾å­—æ¯é †åºæ’åˆ—)", math: "AC = ABC + AB'C" },
            { text: "Step 5: å°‡å…©éƒ¨åˆ†åˆä½µ", math: "Y = (ABC + ABC') + (ABC + AB'C)" },
            { text: "Step 6: å»é™¤é‡è¤‡é … (ABC å‡ºç¾å…©æ¬¡ï¼Œç•™ä¸€å€‹å³å¯)", math: "Y = ABC + ABC' + AB'C" }
        ];

        let currentStep = 0;
        const container = document.getElementById('derivation-container');
        const nextBtn = document.getElementById('btn-next-step');

        function renderSteps() {
            container.innerHTML = '';
            steps.forEach((step, index) => {
                if (index <= currentStep) {
                    const div = document.createElement('div');
                    div.className = 'step-item active';
                    div.innerHTML = `<strong>${step.text}</strong><div class="math-display" style="font-size: 1rem; margin: 5px 0;">${step.math}</div>`;
                    container.appendChild(div);
                }
            });

            // æŒ‰éˆ•ç‹€æ…‹æ§åˆ¶
            if (currentStep >= steps.length - 1) {
                nextBtn.disabled = true;
                nextBtn.textContent = "æ¨å°å®Œæˆ ğŸ‰";
                nextBtn.classList.remove('btn-primary');
                nextBtn.classList.add('btn-success');
            } else {
                nextBtn.disabled = false;
                nextBtn.textContent = "ä¸‹ä¸€æ­¥ â¡ï¸";
                nextBtn.classList.add('btn-primary');
                nextBtn.classList.remove('btn-success');
            }
        }

        document.getElementById('btn-next-step').addEventListener('click', () => {
            if (currentStep < steps.length - 1) {
                currentStep++;
                renderSteps();
            }
        });

        document.getElementById('btn-reset-steps').addEventListener('click', () => {
            currentStep = 0;
            renderSteps();
        });

        // åˆå§‹åŒ–é¡¯ç¤ºç¬¬ä¸€æ­¥
        renderSteps();


        // --- 2. éš¨å ‚ç·´ç¿’äº’å‹•é‚è¼¯ ---
        function checkPractice() {
            const term = document.getElementById('practice-term').value;
            let input = document.getElementById('practice-input').value.replace(/\s/g, '').toUpperCase(); // å»é™¤ç©ºç™½è½‰å¤§å¯«
            const feedback = document.getElementById('practice-feedback');
            
            feedback.style.display = 'block';
            
            // ç°¡å–®çš„æ­£å‰‡è¡¨é”å¼æˆ–å­—ä¸²æ¯”å°
            let isCorrect = false;
            let correctAns = "";
            let errorMsg = "";

            if (term === "AB") {
                // æ­£ç¢ºæ‡‰è©²æ˜¯ AB(C+C') æˆ–é¡ä¼¼æ ¼å¼
                if (input === "AB(C+C')" || input === "AB(C'+C)") {
                    isCorrect = true;
                } else {
                    correctAns = "AB(C + C')";
                    if (input.includes("B+B'")) errorMsg = "å“å‘€ï¼AB å·²ç¶“æœ‰ B äº†ï¼Œæ˜¯ç¼º C æ‰å°å–”ï¼";
                    else errorMsg = "è¨˜å¾—æ ¼å¼æ˜¯ï¼šåŸå¼(ç¼ºé … + ç¼ºé …')";
                }
            } else if (term === "AC") {
                if (input === "AC(B+B')" || input === "AC(B'+B)") {
                    isCorrect = true;
                } else {
                    correctAns = "AC(B + B')";
                    if (input.includes("C+C'")) errorMsg = "å“å‘€ï¼AC å·²ç¶“æœ‰ C äº†ï¼Œæ˜¯ç¼º B æ‰å°å–”ï¼";
                    else errorMsg = "è¨˜å¾—æ ¼å¼æ˜¯ï¼šåŸå¼(ç¼ºé … + ç¼ºé …')";
                }
            }

            if (isCorrect) {
                feedback.className = "feedback correct";
                feedback.innerHTML = "ğŸ‰ ç­”å°äº†ï¼è§€å¿µéå¸¸æ¸…æ¥šï¼";
            } else {
                feedback.className = "feedback wrong";
                feedback.innerHTML = `âŒ å†è©¦è©¦çœ‹ï¼<br>${errorMsg}<br>æ­£ç¢ºå¯«æ³•æ‡‰è©²æ˜¯ï¼š<strong>${correctAns}</strong>`;
            }
        }


        // --- 3. çœŸå€¼è¡¨é‚è¼¯ ---
        const checkboxes = document.querySelectorAll('.option-check');
        
        checkboxes.forEach(box => {
            box.addEventListener('change', updateTruthTable);
        });

        function updateTruthTable() {
            const tbody = document.querySelector('#truth-table tbody');
            const analysisDiv = document.getElementById('table-analysis');
            tbody.innerHTML = ''; // æ¸…ç©º
            
            const showA = document.querySelector('input[value="A"]').checked;
            const showB = document.querySelector('input[value="B"]').checked;
            const showC = document.querySelector('input[value="C"]').checked;
            const showD = document.querySelector('input[value="D"]').checked;

            // æ§åˆ¶è¡¨é ­é¡¯ç¤º/éš±è—
            document.querySelector('.col-opt-a').style.display = showA ? '' : 'none';
            document.querySelector('.col-opt-b').style.display = showB ? '' : 'none';
            document.querySelector('.col-opt-c').style.display = showC ? '' : 'none';
            document.querySelector('.col-opt-d').style.display = showD ? '' : 'none';

            let mismatchFound = false;
            let mismatchMsg = "";

            // ç”Ÿæˆ 8 åˆ— (0-7)
            for (let i = 0; i < 8; i++) {
                // è½‰äºŒé€²ä½ï¼ŒpadStart è£œ 0
                const bin = i.toString(2).padStart(3, '0');
                const A = parseInt(bin[0]);
                const B = parseInt(bin[1]);
                const C = parseInt(bin[2]);

                // è¨ˆç®—é‚è¼¯å€¼ (1 ç‚º true, 0 ç‚º false)
                // Y = AB + AC
                const Y = (A && B) || (A && C) ? 1 : 0;

                // é¸é …é‚è¼¯
                // A: ABC + ABC' + A'B'C
                const valA = (A&&B&&C) || (A&&B&&!C) || (!A&&!B&&C) ? 1 : 0;
                // B: ABC + ABC' + AB'C'
                const valB = (A&&B&&C) || (A&&B&&!C) || (A&&!B&&!C) ? 1 : 0;
                // C: A'BC + ABC' + AB'C
                const valC = (!A&&B&&C) || (A&&B&&!C) || (A&&!B&&C) ? 1 : 0;
                // D: ABC + ABC' + AB'C
                const valD = (A&&B&&C) || (A&&B&&!C) || (A&&!B&&C) ? 1 : 0;

                const tr = document.createElement('tr');
                
                // æª¢æŸ¥æ˜¯å¦èˆ‡ Y ä¸ä¸€è‡´ (åªæª¢æŸ¥æœ‰å‹¾é¸çš„)
                let rowError = false;
                if (showA && valA !== Y) rowError = true;
                if (showB && valB !== Y) rowError = true;
                if (showC && valC !== Y) rowError = true;
                if (showD && valD !== Y) rowError = true;

                if (rowError) {
                    tr.className = "mismatch";
                    mismatchFound = true;
                }

                // å»ºç«‹å„²å­˜æ ¼ HTML
                let html = `
                    <td>${A}</td>
                    <td>${B}</td>
                    <td>${C}</td>
                    <td style="background-color: #fff3cd; font-weight:bold;">${Y}</td>
                `;
                
                if (showA) html += `<td style="color:${valA!==Y?'red':'inherit'}">${valA} ${valA!==Y?'âŒ':''}</td>`; else html += '<td style="display:none"></td>';
                if (showB) html += `<td style="color:${valB!==Y?'red':'inherit'}">${valB} ${valB!==Y?'âŒ':''}</td>`; else html += '<td style="display:none"></td>';
                if (showC) html += `<td style="color:${valC!==Y?'red':'inherit'}">${valC} ${valC!==Y?'âŒ':''}</td>`; else html += '<td style="display:none"></td>';
                if (showD) html += `<td style="color:${valD!==Y?'red':'inherit'}">${valD} ${valD!==Y?'âŒ':''}</td>`; else html += '<td style="display:none"></td>';

                tr.innerHTML = html;
                tbody.appendChild(tr);
            }

            if (mismatchFound) {
                analysisDiv.textContent = "âš ï¸ æ³¨æ„ï¼šç´…è‰²æ¨™è¨˜è™•è¡¨ç¤ºè©²é¸é …è¼¸å‡ºèˆ‡åŸå¼ Y ä¸ä¸€è‡´ï¼Œæ•…è©²é¸é …éŒ¯èª¤ï¼";
            } else {
                analysisDiv.textContent = "âœ… å®Œç¾ï¼ç›®å‰é¡¯ç¤ºçš„é¸é …è¼¸å‡ºèˆ‡åŸå¼å®Œå…¨ä¸€è‡´ã€‚";
                analysisDiv.style.color = "#27ae60";
            }
        }

        // åˆå§‹åŒ–è¡¨æ ¼
        updateTruthTable();


        // --- 4. é¸é …è©³è§£åˆ‡æ› ---
        function toggleExplanation(id) {
            const el = document.getElementById(id);
            if (el.style.display === 'block') {
                el.style.display = 'none';
            } else {
                // å…ˆé—œé–‰å…¶ä»–çš„ (é¸ç”¨)
                document.querySelectorAll('.option-explanation').forEach(e => e.style.display = 'none');
                el.style.display = 'block';
            }
        }

        // --- 5. è‡ªæˆ‘æª¢æ¸¬æç¤º ---
        function toggleHint(id) {
            const el = document.getElementById(id);
            el.style.display = (el.style.display === 'none') ? 'block' : 'none';
        }

        // --- 6. å…¨å±€é‡ç½® ---
        function resetAll() {
            // 1. é‡ç½®æ¨å°
            currentStep = 0;
            renderSteps();
            
            // 2. é‡ç½®ç·´ç¿’è¼¸å…¥
            document.getElementById('practice-term').value = "AB";
            document.getElementById('practice-input').value = "";
            document.getElementById('practice-feedback').style.display = 'none';

            // 3. é‡ç½®çœŸå€¼è¡¨å‹¾é¸ (é è¨­åªå‹¾ D)
            document.querySelectorAll('.option-check').forEach(box => {
                box.checked = (box.value === 'D');
            });
            updateTruthTable();

            // 4. é‡ç½®é¸é …è©³è§£
            document.querySelectorAll('.option-explanation').forEach(e => e.style.display = 'none');

            // 5. é‡ç½®æç¤º
            document.getElementById('hint1').style.display = 'none';
            document.getElementById('hint2').style.display = 'none';
            document.getElementById('hint3').style.display = 'none';

            // æ»¾å‹•å›é ‚éƒ¨
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

    </script>
</body>
</html>