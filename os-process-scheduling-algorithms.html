<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½œæ¥­ç³»çµ±æ’ç¨‹æ¼”ç®—æ³• - äº’å‹•å¼è€ƒå‰è¡åˆºæ•™å­¸</title>
    <style>
        /* --- åŸºç¤è¨­å®š (Reset & Variables) --- */
        :root {
            --primary-color: #2563eb;       /* å°ˆæ¥­è— */
            --accent-color: #f59e0b;        /* é‡é»æ©˜ */
            --success-color: #10b981;       /* æ­£ç¢ºç¶  */
            --error-color: #ef4444;         /* éŒ¯èª¤ç´… */
            --bg-color: #f3f4f6;
            --text-color: #1f2937;
            --card-bg: #ffffff;
            --border-radius: 12px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: "Microsoft JhengHei", "PingFang TC", sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding-bottom: 50px;
        }

        /* --- é€šç”¨å…ƒä»¶é¡åˆ¥ --- */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-left: 5px solid var(--primary-color);
        }

        h1, h2, h3 {
            margin-bottom: 15px;
            color: #111827;
        }

        h1 {
            font-size: 1.8rem;
            text-align: center;
        }

        h2 {
            font-size: 1.4rem;
            border-bottom: 2px solid var(--bg-color);
            padding-bottom: 10px;
        }

        .highlight {
            background-color: #fef3c7;
            color: #92400e;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .badge-must {
            display: inline-block;
            background-color: var(--error-color);
            color: white;
            font-size: 0.8rem;
            padding: 2px 8px;
            border-radius: 20px;
            margin-right: 5px;
            vertical-align: middle;
        }

        .badge-key {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            font-size: 0.8rem;
            padding: 2px 8px;
            border-radius: 20px;
            margin-right: 5px;
            vertical-align: middle;
        }

        /* --- Header --- */
        header {
            background: var(--primary-color);
            color: white;
            padding: 30px 20px;
            text-align: center;
            margin-bottom: 20px;
        }
        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* --- è¡¨æ ¼æ¨£å¼ --- */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .comparison-table th, .comparison-table td {
            padding: 12px;
            border: 1px solid #e5e7eb;
            text-align: center;
        }
        .comparison-table th {
            background-color: #f8fafc;
            color: var(--text-color);
        }
        .status-ok { color: var(--success-color); font-weight: bold; }
        .status-no { color: var(--error-color); font-weight: bold; }

        /* --- é¡Œç›®å€å¡Š --- */
        .question-box {
            background-color: #eff6ff;
            border: 2px dashed var(--primary-color);
            padding: 20px;
            border-radius: var(--border-radius);
        }
        .options-list {
            list-style: none;
            margin-left: 10px;
        }
        .options-list li {
            margin: 8px 0;
            font-weight: bold;
        }

        /* --- äº’å‹•æ¨¡æ“¬å€ (æ ¸å¿ƒ) --- */
        .sim-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .sim-btn {
            padding: 10px 15px;
            border: none;
            border-radius: 6px;
            background-color: #e5e7eb;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }

        .sim-btn:hover { background-color: #d1d5db; }
        .sim-btn.active {
            background-color: var(--primary-color);
            color: white;
        }
        .sim-btn.active-wrong {
            background-color: var(--error-color);
            color: white;
        }

        .sim-stage {
            background: #1f2937;
            border-radius: 8px;
            padding: 20px;
            min-height: 250px;
            position: relative;
            color: white;
            overflow: hidden;
        }

        .sim-info-bar {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 0.9rem;
        }
        
        .sim-warning {
            color: #fca5a5;
            font-weight: bold;
            display: block;
            margin-top: 5px;
        }

        /* è¦–è¦ºåŒ–å…ƒç´  */
        .queue-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px dashed #6b7280;
            padding-bottom: 20px;
        }
        
        .cpu-container {
            width: 120px;
            height: 120px;
            border: 3px solid var(--success-color);
            border-radius: 10px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        .cpu-label {
            position: absolute;
            top: -12px;
            background: #1f2937;
            padding: 0 10px;
            color: var(--success-color);
            font-weight: bold;
        }

        .process-node {
            width: 60px;
            height: 60px;
            background: white;
            color: #1f2937;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 0.9rem;
            border: 3px solid #60a5fa;
            transition: all 0.5s ease;
        }
        
        .process-node small { font-size: 0.7rem; color: #666; }
        .process-node.active-process {
            background: var(--accent-color);
            color: white;
            border-color: white;
            box-shadow: 0 0 15px var(--accent-color);
        }

        /* --- æ¸¬é©—å€ --- */
        .quiz-option {
            display: block;
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
        }
        .quiz-option:hover { background-color: #f9fafb; }
        .quiz-option input { margin-right: 10px; }

        .feedback-box {
            margin-top: 15px;
            padding: 15px;
            border-radius: 6px;
            display: none;
        }
        .feedback-correct { background-color: #d1fae5; color: #065f46; border: 1px solid #34d399; }
        .feedback-wrong { background-color: #fee2e2; color: #991b1b; border: 1px solid #f87171; }

        /* --- RWD --- */
        @media (max-width: 600px) {
            h1 { font-size: 1.5rem; }
            .card { padding: 15px; }
            .comparison-table { font-size: 0.85rem; }
            .sim-btn { width: 100%; margin-bottom: 5px; }
        }
    </style>
</head>
<body>

<!-- Header -->
<header>
    <h1>ä½œæ¥­ç³»çµ±æ’ç¨‹æ¼”ç®—æ³•</h1>
    <p>è€ƒè©¦å°ˆç”¨ï¼š5 åˆ†é˜ææ‡‚ã€Œèª°èƒ½å…ˆç”¨ CPUï¼Ÿã€</p>
</header>

<div class="container">

    <!-- 2. é¡Œç›®å€ -->
    <section class="card question-box">
        <h3><span class="badge-key">æœ¬é¡Œ</span>ä¸‹åˆ—ä½•è€…å±¬æ–¼ä¸€èˆ¬ä½œæ¥­ç³»çµ±è™•ç†ç¨‹åºï¼ˆProcessï¼‰çš„æ’ç¨‹æ¼”ç®—æ³•ï¼Ÿ</h3>
        <p style="color: #666; font-size: 0.9rem; margin-bottom: 10px;">ï¼ˆæœ¬é¡Œç‚ºè¤‡é¸é¡Œï¼‰</p>
        <ul class="options-list">
            <li>(A) FIFO</li>
            <li>(B) FILO</li>
            <li>(C) Priority</li>
            <li>(D) Round Robin</li>
            <li>(E) Random</li>
        </ul>
        <p style="text-align: right; font-size: 0.9rem; color: #2563eb;">â†“ å¾€ä¸‹çœ‹å®Œæ•™å­¸ï¼Œç­”æ¡ˆè‡ªç„¶æµ®ç¾ â†“</p>
    </section>

    <!-- 4. æ–°æ‰‹å°å…¥ -->
    <section class="card" id="intro">
        <h2>ğŸ”° æ–°æ‰‹å°å…¥ï¼šä»€éº¼æ˜¯æ’ç¨‹ï¼Ÿ</h2>
        <p>æƒ³åƒ <strong>CPU</strong> æ˜¯ä¸€å€‹è¶…å¿™çš„ã€Œå¤§å»šã€ï¼Œè€Œ <strong>è¡Œç¨‹ (Process)</strong> æ˜¯ç­‰è‘—è¢«æ–™ç†çš„ã€Œé»èœå–®ã€ã€‚</p>
        <br>
        <ul style="margin-left: 20px;">
            <li>å¤§å»šåªæœ‰ä¸€å€‹äººï¼ˆå–®æ ¸ CPUï¼‰ï¼Œä¸€æ¬¡åªèƒ½ç‚’ä¸€é“èœã€‚</li>
            <li>ä½†æ˜¯é»èœå–®ä¸€ç›´é€é€²ä¾†ã€‚</li>
            <li>ä½œæ¥­ç³»çµ± (OS) å°±åƒã€Œé¤å»³ç¶“ç†ã€ï¼Œä»–å¿…é ˆæ±ºå®šï¼š<strong>ã€Œä¸‹ä¸€é“èœè©²ç‚’å“ªä¸€å¼µå–®ï¼Ÿã€</strong></li>
        </ul>
        <br>
        <div style="background: #f0fdf4; padding: 15px; border-radius: 8px; border-left: 4px solid var(--success-color);">
            <strong>ã€å¿…èƒŒç™½è©±ã€‘</strong><br>
            æ’ç¨‹æ¼”ç®—æ³• (Scheduling Algorithm) å°±æ˜¯ï¼š<br>
            <span style="font-size: 1.2rem; font-weight: bold; color: var(--success-color);">æ±ºå®šã€Œèª°å…ˆç”¨ CPUã€ä»¥åŠã€Œç”¨å¤šä¹…ã€çš„è¦å‰‡ã€‚</span>
        </div>
    </section>

    <!-- 5. å¿…èƒŒç¸½è¡¨ -->
    <section class="card" id="table">
        <h2><span class="badge-must">å¿…èƒŒ</span>å¸¸è¦‹æ’ç¨‹æ¼”ç®—æ³•ç¸½è¡¨</h2>
        <p>è€ƒè©¦æœ€å¸¸è€ƒé€™å¹¾ç¨®ï¼Œè«‹å…ˆè¨˜ä½å“ªäº›æ˜¯ã€ŒYESã€ï¼Œå“ªäº›æ˜¯ã€ŒNOã€ã€‚</p>
        
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>åç¨± (è‹±æ–‡)</th>
                    <th>ä¸­æ–‡åç¨±</th>
                    <th>æ˜¯ OS æ’ç¨‹å—ï¼Ÿ</th>
                    <th>ä¸€å¥è©±èªªæ˜</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>FIFO</strong></td>
                    <td>å…ˆä¾†å…ˆæœå‹™</td>
                    <td class="status-ok">âœ… æ˜¯</td>
                    <td>å…ˆæ’éšŠçš„å…ˆåš (å…¬å¹³)</td>
                </tr>
                <tr>
                    <td><strong>Priority</strong></td>
                    <td>å„ªå…ˆæ¬Šæ’ç¨‹</td>
                    <td class="status-ok">âœ… æ˜¯</td>
                    <td>VIP å…ˆåš (ç·Šæ€¥çš„å…ˆåš)</td>
                </tr>
                <tr>
                    <td><strong>Round Robin</strong></td>
                    <td>è¼ªè½‰æ’ç¨‹</td>
                    <td class="status-ok">âœ… æ˜¯</td>
                    <td>å¤§å®¶è¼ªæµç”¨ (æ¯äººåƒä¸€å£)</td>
                </tr>
                <tr>
                    <td>FILO (LIFO)</td>
                    <td>å¾Œé€²å…ˆå‡º</td>
                    <td class="status-no">âŒ ä¸æ˜¯</td>
                    <td>é€™æ˜¯å †ç–Š (Stack) è³‡æ–™çµæ§‹</td>
                </tr>
                <tr>
                    <td>Random</td>
                    <td>éš¨æ©Ÿæ’ç¨‹</td>
                    <td class="status-no">âŒ ä¸æ˜¯</td>
                    <td>OS éœ€è¦ç©©å®šï¼Œä¸èƒ½äº‚é¸</td>
                </tr>
            </tbody>
        </table>
    </section>

    <!-- 6. äº’å‹•æ¨¡æ“¬å€ -->
    <section class="card" id="simulation">
        <h2>ğŸ® äº’å‹•æ¨¡æ“¬ï¼šCPU æ€éº¼é¸ï¼Ÿ</h2>
        <p>é»æ“Šä¸‹æ–¹æŒ‰éˆ•ï¼Œè§€å¯Ÿ CPU å¦‚ä½•æŒ‘é¸è¡Œç¨‹ï¼ˆProcessï¼‰ã€‚</p>
        <br>

        <!-- æ§åˆ¶æŒ‰éˆ• -->
        <div class="sim-controls">
            <button class="sim-btn" onclick="startSim('FIFO')">FIFO (å…ˆä¾†å…ˆæœå‹™)</button>
            <button class="sim-btn" onclick="startSim('Priority')">Priority (å„ªå…ˆæ¬Š)</button>
            <button class="sim-btn" onclick="startSim('RR')">Round Robin (è¼ªè½‰)</button>
            <button class="sim-btn" onclick="startSim('FILO')" style="border: 1px solid #ef4444;">FILO (éŒ¯èª¤ç¤ºç¯„)</button>
            <button class="sim-btn" onclick="startSim('Random')" style="border: 1px solid #ef4444;">Random (éŒ¯èª¤ç¤ºç¯„)</button>
        </div>

        <!-- æ¨¡æ“¬èˆå° -->
        <div class="sim-stage">
            <div id="sim-message" class="sim-info-bar">è«‹é¸æ“‡ä¸€ç¨®æ¼”ç®—æ³•é–‹å§‹æ¨¡æ“¬...</div>
            
            <div style="font-size: 0.8rem; color: #9ca3af; margin-bottom: 5px;">ç­‰å¾…ä½‡åˆ— (Ready Queue):</div>
            <div class="queue-container" id="queue-box">
                <!-- JS æœƒåœ¨é€™è£¡ç”¢ç”Ÿ Process -->
            </div>

            <div class="cpu-container">
                <span class="cpu-label">CPU</span>
                <div id="cpu-slot" style="font-size: 2rem; opacity: 0.3;">âš™ï¸</div>
            </div>
        </div>
        
        <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
            <strong>åœ–ä¾‹èªªæ˜ï¼š</strong> P1, P2... ä»£è¡¨è¡Œç¨‹ã€‚<br>
            <span style="display:inline-block; width:10px; height:10px; background:var(--accent-color); border-radius:50%;"></span> ä»£è¡¨æ­£åœ¨ä½¿ç”¨ CPUã€‚
        </div>
    </section>

    <!-- 7. é¸é …ç ´è§£ -->
    <section class="card" id="analysis">
        <h2>ğŸ’¡ é¸é …é€ä¸€ç ´è§£</h2>
        
        <div style="margin-bottom: 15px;">
            <h3 style="color: var(--success-color);">(A) FIFO (First-In First-Out) âœ…</h3>
            <p><strong>èªªæ˜ï¼š</strong>å°±åƒå»ä¾¿åˆ©å•†åº—æ’éšŠçµå¸³ï¼Œèª°å…ˆæ’éšŠèª°å…ˆçµå¸³ã€‚é€™æ˜¯æœ€åŸºæœ¬ã€æœ€ç°¡å–®çš„ OS æ’ç¨‹æ³•ã€‚</p>
        </div>

        <div style="margin-bottom: 15px;">
            <h3 style="color: var(--error-color);">(B) FILO (First-In Last-Out) âŒ</h3>
            <p><strong>èªªæ˜ï¼š</strong>å°±åƒæ´—ç›¤å­ï¼Œæœ€å¾Œæ”¾ä¸Šå»çš„é«’ç›¤å­æœƒå…ˆè¢«æ´—ï¼ˆå †ç–Š Stack æ¦‚å¿µï¼‰ã€‚</p>
            <p class="highlight">ç‚ºä»€éº¼ä¸æ˜¯æ’ç¨‹ï¼Ÿå› ç‚ºé€™æœƒå°è‡´æœ€æ—©ä¾†çš„ç¨‹å¼æ°¸é ç­‰ä¸åˆ°åŸ·è¡Œï¼ˆé¤“æ­»ï¼‰ï¼Œä¸ç¬¦åˆå…¬å¹³åŸå‰‡ã€‚</p>
        </div>

        <div style="margin-bottom: 15px;">
            <h3 style="color: var(--success-color);">(C) Priority (å„ªå…ˆæ¬Šæ’ç¨‹) âœ…</h3>
            <p><strong>èªªæ˜ï¼š</strong>å°±åƒæ€¥è¨ºå®¤æª¢å‚·åˆ†é¡ï¼Œç—…æƒ…åš´é‡ï¼ˆå„ªå…ˆæ¬Šé«˜ï¼‰çš„ç—…äººå…ˆçœ‹è¨ºï¼Œä¸ç®¡ä»–æ˜¯ä¸æ˜¯æ™šåˆ°ã€‚</p>
        </div>

        <div style="margin-bottom: 15px;">
            <h3 style="color: var(--success-color);">(D) Round Robin (è¼ªè½‰æ’ç¨‹) âœ…</h3>
            <p><strong>èªªæ˜ï¼š</strong>é€™æ˜¯ã€Œåˆ†æ™‚ç³»çµ±ã€æœ€å¸¸ç”¨çš„ã€‚CPU çµ¦æ¯å€‹äººå›ºå®šçš„æ™‚é–“ï¼ˆä¾‹å¦‚ 2 ç§’ï¼‰ï¼Œæ™‚é–“åˆ°å°±æ›ä¸‹ä¸€å€‹äººï¼Œå¤§å®¶è¼ªæµç”¨ï¼Œé€™è®“ä½¿ç”¨è€…è¦ºå¾—é›»è…¦å¥½åƒåŒæ™‚åœ¨åšå¾ˆå¤šäº‹ã€‚</p>
        </div>

        <div style="margin-bottom: 15px;">
            <h3 style="color: var(--error-color);">(E) Random (éš¨æ©Ÿæ’ç¨‹) âŒ</h3>
            <p><strong>èªªæ˜ï¼š</strong>æŠ½ç±¤æ±ºå®šã€‚é€™ä¸æ˜¯æ¨™æº–çš„ OS æ’ç¨‹ï¼Œå› ç‚ºé›»è…¦é‹ä½œè¿½æ±‚ã€Œå¯é æ¸¬ã€èˆ‡ã€Œå…¬å¹³ã€ï¼Œéš¨æ©Ÿå¤ªä¸ç©©å®šäº†ã€‚</p>
        </div>
    </section>

    <!-- 9. è¨˜æ†¶æŠ€å·§ & 10. å¸¸è¦‹éŒ¯èª¤ -->
    <section class="card" style="background: linear-gradient(to right, #fff, #fffbeb);">
        <h2>ğŸ§  è€ƒå‰é€Ÿè¨˜ & å¸¸è¦‹éŒ¯èª¤</h2>
        
        <div style="margin-bottom: 20px;">
            <h4>ã€è€ƒè©¦å£è¨£ã€‘</h4>
            <ul>
                <li><strong>ã€Œæ’ç¨‹ä¸‰å…„å¼Ÿï¼šFIFOã€Priorityã€RRã€</strong>ï¼ˆçœ‹åˆ°é€™ä¸‰å€‹å°±æ‰“å‹¾ï¼‰ã€‚</li>
                <li><strong>ã€Œçœ‹åˆ° FILO æƒ³åˆ° Stackã€</strong>ï¼ˆå®ƒæ˜¯è³‡æ–™çµæ§‹ï¼Œä¸æ˜¯æ’ç¨‹ï¼‰ã€‚</li>
                <li><strong>ã€ŒRound Robin å°±æ˜¯è¼ªæµåƒä¸€å£ã€</strong>ã€‚</li>
            </ul>
        </div>

        <div>
            <h4>ã€âš ï¸ å­¸ç”Ÿæœ€å®¹æ˜“éŒ¯çš„åœ°æ–¹ã€‘</h4>
            <ol>
                <li><strong>çœ¼èŠ±é¸éŒ¯ï¼š</strong>çœ‹åˆ° FIFO å’Œ FILO é•·å¾ˆåƒï¼Œä»¥ç‚ºæ˜¯ä¸€çµ„çš„å°±ä¸€èµ·é¸ã€‚è¨˜å¾—ï¼šFIFO æ˜¯æ’éšŠ(O)ï¼ŒFILO æ˜¯æ’éšŠ/å †ç–Š(X)ã€‚</li>
                <li><strong>èª¤é¸ Randomï¼š</strong>ä»¥ç‚ºã€Œéš¨æ©Ÿã€ä¹Ÿæ˜¯ä¸€ç¨®æ¼”ç®—æ³•ã€‚é›–ç„¶å¯¦ä½œå¯«å¾—å‡ºä¾†ï¼Œä½†ä¸€èˆ¬ OS æ•™ç§‘æ›¸ä¸å°‡å…¶åˆ—ç‚ºæ¨™æº–æ’ç¨‹æ³•ã€‚</li>
                <li><strong>æ¼é¸ï¼š</strong>é¡Œç›®æ˜¯è¤‡é¸é¡Œï¼Œå¸¸æ¼æ‰ Round Robin æˆ– Priorityã€‚</li>
            </ol>
        </div>
    </section>

    <!-- 8. å°æ¸¬é©—å€ -->
    <section class="card" id="quiz">
        <h2>ğŸ“ éš¨å ‚å°æ¸¬é©—</h2>
        <p>å›åˆ°æœ€ä¸Šé¢çš„é¡Œç›®ï¼Œç¾åœ¨è«‹è©¦è‘—é¸å‡ºæ­£ç¢ºç­”æ¡ˆï¼ˆè¤‡é¸ï¼‰ï¼š</p>
        <p style="font-weight: bold; margin: 10px 0;">ä¸‹åˆ—ä½•è€…å±¬æ–¼ä¸€èˆ¬ä½œæ¥­ç³»çµ±è™•ç†ç¨‹åºï¼ˆProcessï¼‰çš„æ’ç¨‹æ¼”ç®—æ³•ï¼Ÿ</p>
        
        <form id="quiz-form">
            <label class="quiz-option"><input type="checkbox" name="ans" value="A"> (A) FIFO (First-In First-Out)</label>
            <label class="quiz-option"><input type="checkbox" name="ans" value="B"> (B) FILO (First-In Last-Out)</label>
            <label class="quiz-option"><input type="checkbox" name="ans" value="C"> (C) Priority (å„ªå…ˆæ¬Šæ’ç¨‹)</label>
            <label class="quiz-option"><input type="checkbox" name="ans" value="D"> (D) Round Robin (è¼ªè½‰æ’ç¨‹)</label>
            <label class="quiz-option"><input type="checkbox" name="ans" value="E"> (E) Random (éš¨æ©Ÿæ’ç¨‹)</label>
            
            <button type="button" onclick="checkAnswer()" style="margin-top: 10px; background: var(--primary-color); color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 1rem;">æäº¤ç­”æ¡ˆ</button>
        </form>

        <div id="quiz-feedback" class="feedback-box"></div>
    </section>

</div>

<script>
    // --- äº’å‹•æ¨¡æ“¬é‚è¼¯ ---
    
    // å®šç¾©è¡Œç¨‹è³‡æ–™ (æ¨¡æ“¬ç”¨)
    // Priority: æ•¸å­—è¶Šå°è¶Šé«˜ (1æœ€é«˜)
    // Duration: åŸ·è¡Œæ‰€éœ€æ™‚é–“
    const processesTemplate = [
        { id: 'P1', arrival: 1, priority: 3, name: 'P1' }, // æ™®é€š
        { id: 'P2', arrival: 2, priority: 1, name: 'P2' }, // æœ€ç·Šæ€¥
        { id: 'P3', arrival: 3, priority: 2, name: 'P3' }, // æ¬¡ç·Šæ€¥
        { id: 'P4', arrival: 4, priority: 3, name: 'P4' }  // æ™®é€š
    ];

    let currentTimeout = null;
    let isRunning = false;

    function startSim(algo) {
        // 1. é‡ç½® UI
        const queueBox = document.getElementById('queue-box');
        const cpuSlot = document.getElementById('cpu-slot');
        const msgBox = document.getElementById('sim-message');
        const btns = document.querySelectorAll('.sim-btn');
        
        // æ¸…é™¤èˆŠçš„è¨ˆæ™‚å™¨èˆ‡ç‹€æ…‹
        if(currentTimeout) clearTimeout(currentTimeout);
        queueBox.innerHTML = '';
        cpuSlot.innerHTML = 'âš™ï¸';
        cpuSlot.style.opacity = '0.3';
        
        // æŒ‰éˆ•æ¨£å¼åˆ‡æ›
        btns.forEach(b => {
            b.classList.remove('active', 'active-wrong');
            if (b.textContent.includes(algo)) {
                if (algo === 'FILO' || algo === 'Random') {
                    b.classList.add('active-wrong');
                } else {
                    b.classList.add('active');
                }
            }
        });

        // 2. æº–å‚™è¡Œç¨‹è³‡æ–™ (æ·±æ‹·è²)
        let tasks = JSON.parse(JSON.stringify(processesTemplate));
        let explanation = "";
        let isWrongAlgo = false;

        // 3. æ ¹æ“šæ¼”ç®—æ³•æ’åº
        switch(algo) {
            case 'FIFO':
                explanation = "ã€FIFOã€‘ä¾ç…§åˆ°é”é †åºï¼šP1 -> P2 -> P3 -> P4";
                // é™£åˆ—åŸæœ¬å°±æ˜¯ç…§ id/arrival æ’çš„ï¼Œä¸ç”¨å‹•
                break;
            case 'Priority':
                explanation = "ã€Priorityã€‘å„ªå…ˆæ¬Šé«˜çš„å…ˆåš (å‡è¨­ P2 æœ€ç·Šæ€¥)ï¼šP2 -> P3 -> P1 -> P4";
                tasks.sort((a, b) => a.priority - b.priority);
                break;
            case 'RR':
                explanation = "ã€Round Robinã€‘æ¯äººè¼ªæµåšä¸€é»ï¼šP1 -> P2 -> P3 -> P4 -> P1...";
                // æ¨¡æ“¬è¼ªè½‰ï¼šé€™è£¡ç°¡å–®æ¼”ç¤ºé †åºé‡è¤‡çš„æ•ˆæœ
                tasks = [
                    {id:'P1', name:'P1'}, {id:'P2', name:'P2'}, {id:'P3', name:'P3'}, 
                    {id:'P4', name:'P4'}, {id:'P1', name:'P1(çºŒ)'}, {id:'P2', name:'P2(çºŒ)'}
                ];
                break;
            case 'FILO':
                explanation = "ã€FILOã€‘å¾Œé€²å…ˆå‡º (Stack)ï¼šæœ€å¾Œä¾†çš„ P4 å…ˆåšã€‚";
                explanation += "<span class='sim-warning'>âš ï¸ è­¦å‘Šï¼šé€™ä¸æ˜¯æ¨™æº– OS æ’ç¨‹ï¼Œæœƒå°è‡´å…ˆä¾†çš„äººé¤“æ­»ï¼</span>";
                tasks.reverse(); // åè½‰
                isWrongAlgo = true;
                break;
            case 'Random':
                explanation = "ã€Randomã€‘éš¨æ©Ÿäº‚é¸ï¼šå®Œå…¨ä¸å¯é æ¸¬ã€‚";
                explanation += "<span class='sim-warning'>âš ï¸ è­¦å‘Šï¼šé€™ä¸æ˜¯æ¨™æº– OS æ’ç¨‹ï¼Œç³»çµ±éœ€è¦ç©©å®šæ€§ï¼</span>";
                tasks.sort(() => Math.random() - 0.5); // éš¨æ©Ÿ
                isWrongAlgo = true;
                break;
        }

        msgBox.innerHTML = explanation;

        // 4. ç¹ªè£½åˆå§‹ä½‡åˆ—
        tasks.forEach(t => {
            const node = document.createElement('div');
            node.className = 'process-node';
            node.id = `node-${t.id}-${Math.random().toString(36).substr(2, 5)}`; // å”¯ä¸€IDé¿å…é‡è¤‡
            node.innerHTML = `${t.name}`;
            if(algo === 'Priority') node.innerHTML += `<small>Pri:${t.priority}</small>`;
            queueBox.appendChild(node);
        });

        // 5. åŸ·è¡Œè¦–è¦ºåŒ–å‹•ç•«å‡½æ•¸
        runAnimationSequence(tasks, 0, cpuSlot, queueBox);
    }

    function runAnimationSequence(tasks, index, cpuSlot, queueBox) {
        if (index >= tasks.length) {
            cpuSlot.innerHTML = 'âœ…';
            cpuSlot.style.background = 'transparent';
            cpuSlot.style.color = 'var(--success-color)';
            return;
        }

        const task = tasks[index];
        // æ‰¾å‡ºä½‡åˆ—ä¸­å°æ‡‰çš„ DOM å…ƒç´  (å–ç¬¬ä¸€å€‹ç¬¦åˆçš„)
        const nodes = queueBox.querySelectorAll('.process-node');
        let targetNode = null;
        
        // ç°¡å–®çš„æ¯”å°é‚è¼¯ä¾†æ‰¾åˆ°å°æ‡‰çš„è¦–è¦ºå…ƒç´ 
        for(let node of nodes) {
            if (node.innerText.includes(task.name) && node.style.visibility !== 'hidden') {
                targetNode = node;
                break;
            }
        }

        if(targetNode) {
            // "é€²å ´" æ•ˆæœ
            targetNode.classList.add('active-process');
            cpuSlot.innerHTML = '';
            cpuSlot.style.opacity = '1';
            
            // è¤‡è£½ä¸€å€‹ node åˆ° CPU è£¡é¢é¡¯ç¤º
            const runningNode = targetNode.cloneNode(true);
            runningNode.style.margin = '0';
            runningNode.style.width = '80px';
            runningNode.style.height = '80px';
            cpuSlot.appendChild(runningNode);
            
            // éš±è—ä½‡åˆ—ä¸­çš„
            targetNode.style.visibility = 'hidden';

            // åŸ·è¡Œæ™‚é–“æ¨¡æ“¬ (1ç§’å¾Œæ›ä¸‹ä¸€å€‹)
            currentTimeout = setTimeout(() => {
                cpuSlot.innerHTML = 'âš™ï¸'; // æ¸…ç©º CPU
                targetNode.remove(); // çœŸçš„å¾ä½‡åˆ—ç§»é™¤
                runAnimationSequence(tasks, index + 1, cpuSlot, queueBox);
            }, 1000);
        }
    }

    // --- æ¸¬é©—åˆ¤æ–·é‚è¼¯ ---
    function checkAnswer() {
        const correctAnswers = ['A', 'C', 'D'];
        const form = document.getElementById('quiz-form');
        const feedback = document.getElementById('quiz-feedback');
        
        // å–å¾—ä½¿ç”¨è€…é¸çš„é …ç›®
        const checkboxes = form.querySelectorAll('input[name="ans"]:checked');
        let userAnswers = [];
        checkboxes.forEach((checkbox) => {
            userAnswers.push(checkbox.value);
        });
        
        // æ’åºä»¥ä¾¿æ¯”å°
        userAnswers.sort();

        // åˆ¤æ–·é‚è¼¯
        const isCorrect = JSON.stringify(userAnswers) === JSON.stringify(correctAnswers);
        
        feedback.style.display = 'block';
        feedback.className = 'feedback-box ' + (isCorrect ? 'feedback-correct' : 'feedback-wrong');

        if (isCorrect) {
            feedback.innerHTML = `
                <strong>ğŸ‰ ç­”å°äº†ï¼</strong><br>
                æ­£ç¢ºç­”æ¡ˆå°±æ˜¯ <strong>FIFO (A)ã€Priority (C)ã€Round Robin (D)</strong>ã€‚<br>
                é€™ä¸‰å€‹æ˜¯ä½œæ¥­ç³»çµ±çœŸæ­£çš„æ’ç¨‹æ¼”ç®—æ³•ï¼
            `;
        } else {
            // åˆ†æéŒ¯èª¤
            let msg = `<strong>âŒ ç­”éŒ¯å›‰ï¼</strong><br>`;
            
            // æª¢æŸ¥æœ‰æ²’æœ‰é¸åˆ°åœ°é›·
            if (userAnswers.includes('B')) msg += `ğŸ‘‰ <strong>FILO</strong> æ˜¯è³‡æ–™çµæ§‹ï¼Œä¸æ˜¯æ’ç¨‹æ¼”ç®—æ³•å–”ï¼ˆæœƒè®“äººé¤“æ­»ï¼‰ã€‚<br>`;
            if (userAnswers.includes('E')) msg += `ğŸ‘‰ <strong>Random</strong> ä¸ç©©å®šï¼ŒOS ä¸æœƒç”¨å®ƒã€‚<br>`;
            
            // æª¢æŸ¥æœ‰æ²’æœ‰æ¼é¸
            if (!userAnswers.includes('D')) msg += `ğŸ‘‰ åˆ¥å¿˜äº† <strong>Round Robin</strong> æ˜¯åˆ†æ™‚ç³»çµ±æœ€é‡è¦çš„æ’ç¨‹ï¼<br>`;
            
            msg += `<br>è«‹å†è©¦ä¸€æ¬¡ï¼Œæƒ³æƒ³ã€Œä½œæ¥­ç³»çµ±æ’ç¨‹ä¸‰å…„å¼Ÿã€æ˜¯èª°ï¼Ÿ`;
            feedback.innerHTML = msg;
        }
    }

    // é é¢è¼‰å…¥æ™‚é è¨­è·‘ä¸€æ¬¡ FIFO è®“ç•«é¢ä¸ç©ºç™½
    window.onload = function() {
        // ç‚ºäº†è®“ä½¿ç”¨è€…å…ˆçœ‹æ–‡å­—ï¼Œé€™è£¡ä¸è‡ªå‹•é–‹å§‹è·‘å‹•ç•«ï¼Œåªé¡¯ç¤ºå¾…æ©Ÿç‹€æ…‹
    };
</script>

</body>
</html>