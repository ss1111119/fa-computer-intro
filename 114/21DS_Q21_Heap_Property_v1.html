<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DS_Q21_Heap_Property_v1</title>
    <style>
        :root {
            --primary-color: #2c3e50; /* 深藍專業感 */
            --accent-color: #d35400; /* 重點橘 */
            --correct-color: #27ae60;
            --wrong-color: #c0392b;
            --bg-color: #f4f6f7;
            --card-bg: #ffffff;
            --highlight-bg: #ffeaa7;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: "Microsoft JhengHei", "PingFang TC", sans-serif;
            background-color: var(--bg-color);
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* A. 頁首區 */
        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 15px;
        }

        h1 {
            color: var(--primary-color);
            font-size: 1.8rem;
            margin: 0 0 10px 0;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1rem;
            font-weight: bold;
        }

        .question-number {
            display: inline-block;
            background: var(--primary-color);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        /* 通用卡片樣式 */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 25px;
            border-left: 5px solid var(--primary-color);
        }

        h2 {
            font-size: 1.2rem;
            color: var(--primary-color);
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-top: 0;
        }

        /* B. 題目區 & C. 關鍵字 */
        .question-text {
            font-size: 1.15rem;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .options-list {
            list-style-type: none;
            padding: 0;
        }

        .options-list li {
            padding: 10px;
            border-bottom: 1px dashed #eee;
        }

        .keyword-btn-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        .keyword-btn {
            background: white;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            padding: 5px 12px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .keyword-btn:hover, .keyword-btn.active {
            background: var(--primary-color);
            color: white;
        }

        .highlight-text {
            background-color: transparent;
            transition: background-color 0.3s;
            padding: 0 2px;
            border-radius: 3px;
        }

        .highlight-text.active {
            background-color: var(--highlight-bg);
            font-weight: bold;
            color: var(--accent-color);
            border-bottom: 2px solid var(--accent-color);
        }

        #keyword-explanation {
            background: #fdf2e9;
            padding: 15px;
            border-radius: 8px;
            font-size: 0.95rem;
            color: var(--accent-color);
            min-height: 60px;
            display: flex;
            align-items: center;
        }

        /* D. 白話翻譯 */
        .accordion {
            cursor: pointer;
            padding: 15px;
            width: 100%;
            text-align: left;
            border: none;
            outline: none;
            background-color: #ecf0f1;
            transition: 0.4s;
            font-weight: bold;
            font-size: 1rem;
            border-radius: 8px;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .accordion:after {
            content: '+';
            font-size: 18px;
            color: #777;
            float: right;
            margin-left: 5px;
        }

        .accordion.active:after {
            content: '-';
        }

        .panel {
            padding: 0 15px;
            background-color: white;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.2s ease-out;
            border-radius: 0 0 8px 8px;
            margin-top: -8px;
            margin-bottom: 15px;
            border: 1px solid #ecf0f1;
            border-top: none;
        }

        .panel p {
            color: #555;
            font-size: 0.95rem;
        }

        /* E. Heap 結構互動 */
        .tree-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            gap: 15px;
        }

        .tree-box {
            width: 100%;
            max-width: 220px;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s, border-color 0.2s;
            background: white;
        }

        .tree-box:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
        }

        .tree-box svg {
            width: 100%;
            height: 150px;
        }

        .tree-label {
            font-weight: bold;
            margin-top: 5px;
            color: #555;
        }

        circle {
            fill: white;
            stroke: var(--primary-color);
            stroke-width: 2;
        }
        
        text {
            font-size: 16px;
            font-family: sans-serif;
            text-anchor: middle;
            dominant-baseline: middle;
            fill: #333;
        }

        line {
            stroke: #999;
            stroke-width: 2;
        }

        .tree-feedback {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
            text-align: center;
            display: none;
        }

        .is-heap { background-color: #d5f5e3; color: #196f3d; }
        .not-heap { background-color: #fadbd8; color: #943126; }

        /* F. 選項解析 */
        .option-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .option-header {
            padding: 15px;
            background: #f8f9fa;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .option-header:hover {
            background: #e9ecef;
        }

        .option-content {
            display: none;
            padding: 15px;
            background: white;
            border-top: 1px solid #ddd;
        }

        .tag {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        .tag-correct { background: var(--correct-color); color: white; }
        .tag-wrong { background: var(--wrong-color); color: white; }

        /* G. 小測驗 */
        .quiz-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .quiz-btn-group {
            margin-top: 10px;
        }

        .quiz-btn {
            padding: 5px 15px;
            margin-right: 10px;
            border: 1px solid #ccc;
            background: white;
            border-radius: 4px;
            cursor: pointer;
        }

        .quiz-result {
            margin-top: 8px;
            font-size: 0.9rem;
            font-weight: bold;
            display: none;
        }

        /* H. 口訣 */
        .mnemonic-box {
            background: #fff8e1;
            border-left: 5px solid #ffc107;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .mnemonic-text {
            font-size: 1.2rem;
            color: #d35400;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
        }

        .pitfall-list li {
            color: #c0392b;
            margin-bottom: 5px;
        }

        /* I. 答案揭曉 */
        .reveal-section {
            text-align: center;
            margin-top: 30px;
        }

        .reveal-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(211, 84, 0, 0.3);
            transition: transform 0.1s;
        }

        .reveal-btn:active {
            transform: scale(0.95);
        }

        #final-answer {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: var(--primary-color);
            color: white;
            border-radius: 10px;
        }

        /* Footer */
        footer {
            text-align: center;
            margin-top: 50px;
            color: #95a5a6;
            font-size: 0.8rem;
        }

        /* RWD */
        @media (max-width: 600px) {
            .tree-box {
                max-width: 100%;
            }
            header h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>

<div class="container">

    <!-- A. 頁首區 -->
    <header>
        <h1>Heap 是什麼？一眼看懂它的「兩大性質」</h1>
        <div class="subtitle">資料結構 Data Structure（新手友善）</div>
        <div class="question-number">題號：21</div>
    </header>

    <main>
        <!-- B. 題目區 -->
        <div class="card">
            <h2>題目</h2>
            <div class="question-text">
                21. 下列何者最能代表 <span id="txt-heap" class="highlight-text">Heap</span> 的性質？
            </div>
            <ul class="options-list">
                <li>(A) 每個節點的左右子樹高度相同</li>
                <li>(B) <span id="txt-complete" class="highlight-text">完全二元樹</span> + <span id="txt-parent" class="highlight-text">父節點</span>大於（或小於）<span id="txt-child" class="highlight-text">子節點</span></li>
                <li>(C) 所有節點按數值大小 <span id="txt-sort" class="highlight-text">排序</span></li>
                <li>(D) 任意二元樹即可稱為 Heap</li>
            </ul>
        </div>

        <!-- C. 關鍵字螢光筆互動 -->
        <div class="card">
            <h2>關鍵字解碼（點擊下方按鈕）</h2>
            <div class="keyword-btn-group">
                <button class="keyword-btn" onclick="highlight('heap')">Heap</button>
                <button class="keyword-btn" onclick="highlight('complete')">完全二元樹</button>
                <button class="keyword-btn" onclick="highlight('parent')">父節點</button>
                <button class="keyword-btn" onclick="highlight('child')">子節點</button>
                <button class="keyword-btn" onclick="highlight('maxheap')">最大堆(Max Heap)</button>
                <button class="keyword-btn" onclick="highlight('minheap')">最小堆(Min Heap)</button>
                <button class="keyword-btn" onclick="highlight('sort')">排序</button>
            </div>
            <div id="keyword-explanation">
                請點擊上方關鍵字，這裡會顯示白話文解釋。
            </div>
        </div>

        <!-- D. 白話翻譯 -->
        <div class="card">
            <h2>翻譯蒟蒻</h2>
            <button class="accordion">【白話翻譯】這題在問什麼？</button>
            <div class="panel">
                <p>「哪一個選項，最符合『Heap 這種資料結構一定要具備的特性』？」<br>簡單來說，就是問你 Heap 的「身份證」上有哪兩個特徵。</p>
            </div>

            <button class="accordion">【重點提示】Heap 的兩個條件</button>
            <div class="panel">
                <p>Heap（堆積）不管內容數字怎麼變，它一定永遠同時滿足：<br>1. 形狀要是特定的樣子（不能亂長）。<br>2. 爸爸跟小孩的大小關係要固定。</p>
            </div>
        </div>

        <!-- E. Heap 結構互動示意 -->
        <div class="card">
            <h2>圖解：誰才是真的 Heap？（點擊樹木）</h2>
            <div class="tree-container">
                <!-- 樹 1: 正確的 Heap -->
                <div class="tree-box" onclick="checkTree(1)">
                    <svg viewBox="0 0 200 150">
                        <line x1="100" y1="30" x2="60" y2="80" />
                        <line x1="100" y1="30" x2="140" y2="80" />
                        <line x1="60" y1="80" x2="40" y2="130" />
                        <line x1="60" y1="80" x2="80" y2="130" />
                        
                        <circle cx="100" cy="30" r="15" /> <text x="100" y="30">10</text>
                        <circle cx="60" cy="80" r="15" /> <text x="60" y="80">8</text>
                        <circle cx="140" cy="80" r="15" /> <text x="140" y="80">9</text>
                        <circle cx="40" cy="130" r="15" /> <text x="40" y="130">7</text>
                        <circle cx="80" cy="130" r="15" /> <text x="80" y="130">5</text>
                    </svg>
                    <div class="tree-label">選手 A</div>
                </div>

                <!-- 樹 2: 不是完全二元樹 -->
                <div class="tree-box" onclick="checkTree(2)">
                    <svg viewBox="0 0 200 150">
                        <line x1="100" y1="30" x2="60" y2="80" />
                        <line x1="100" y1="30" x2="140" y2="80" />
                        <!-- 缺左邊，只有右邊，違反完全二元樹 -->
                        <line x1="140" y1="80" x2="160" y2="130" />

                        <circle cx="100" cy="30" r="15" /> <text x="100" y="30">10</text>
                        <circle cx="60" cy="80" r="15" /> <text x="60" y="80">8</text>
                        <circle cx="140" cy="80" r="15" /> <text x="140" y="80">9</text>
                        <circle cx="160" cy="130" r="15" /> <text x="160" y="130">7</text>
                    </svg>
                    <div class="tree-label">選手 B</div>
                </div>

                <!-- 樹 3: 數值順序錯誤 -->
                <div class="tree-box" onclick="checkTree(3)">
                    <svg viewBox="0 0 200 150">
                        <line x1="100" y1="30" x2="60" y2="80" />
                        <line x1="100" y1="30" x2="140" y2="80" />
                        <line x1="60" y1="80" x2="40" y2="130" />

                        <circle cx="100" cy="30" r="15" /> <text x="100" y="30">5</text> <!-- 父太小 -->
                        <circle cx="60" cy="80" r="15" /> <text x="60" y="80">10</text>
                        <circle cx="140" cy="80" r="15" /> <text x="140" y="80">9</text>
                        <circle cx="40" cy="130" r="15" /> <text x="40" y="130">2</text>
                    </svg>
                    <div class="tree-label">選手 C</div>
                </div>
            </div>
            <div id="tree-feedback-area" class="tree-feedback"></div>
        </div>

        <!-- F. 選項逐一解析 -->
        <div class="card">
            <h2>選項解析（點擊展開）</h2>
            
            <div class="option-card">
                <div class="option-header" onclick="toggleOption('optA')">
                    (A) 每個節點的左右子樹高度相同
                    <span>▼</span>
                </div>
                <div id="optA" class="option-content">
                    <span class="tag tag-wrong">錯誤</span>
                    <p>這是「平衡樹」（如 AVL Tree）的概念，為了讓搜尋效率高。Heap 不要求高度完全平衡，只要求是「完全二元樹」（Complete Binary Tree），也就是最後一層可以沒滿，但要靠左邊。</p>
                </div>
            </div>

            <div class="option-card">
                <div class="option-header" onclick="toggleOption('optB')">
                    (B) 完全二元樹 + 父節點大於（或小於）子節點
                    <span>▼</span>
                </div>
                <div id="optB" class="option-content">
                    <span class="tag tag-correct">正確</span>
                    <p>這正是 Heap 的定義！<br>
                    1. <strong>結構性質</strong>：必須是完全二元樹（形狀固定）。<br>
                    2. <strong>次序性質</strong>：Max Heap（父≥子）或 Min Heap（父≤子）。</p>
                </div>
            </div>

            <div class="option-card">
                <div class="option-header" onclick="toggleOption('optC')">
                    (C) 所有節點按數值大小排序
                    <span>▼</span>
                </div>
                <div id="optC" class="option-content">
                    <span class="tag tag-wrong">錯誤</span>
                    <p>這是「二元搜尋樹」（BST）的特性（左 < 父 < 右）。<br>Heap <strong>不保證</strong>左邊一定比右邊小，它只保證「爸爸贏過小孩」，兄弟之間沒有大小關係。</p>
                </div>
            </div>

            <div class="option-card">
                <div class="option-header" onclick="toggleOption('optD')">
                    (D) 任意二元樹即可稱為 Heap
                    <span>▼</span>
                </div>
                <div id="optD" class="option-content">
                    <span class="tag tag-wrong">錯誤</span>
                    <p>當然不行！Heap 有嚴格的「形狀」和「父子大小」規定，隨便畫的樹不能叫 Heap。</p>
                </div>
            </div>
        </div>

        <!-- G. 快速小測驗 -->
        <div class="card">
            <h2>隨堂小測驗</h2>
            
            <div class="quiz-item">
                <div>Q1. Heap 一定要是「完全二元樹」嗎？</div>
                <div class="quiz-btn-group">
                    <button class="quiz-btn" onclick="checkQuiz(1, true)">是</button>
                    <button class="quiz-btn" onclick="checkQuiz(1, false)">否</button>
                </div>
                <div id="quiz-res-1" class="quiz-result"></div>
            </div>

            <div class="quiz-item">
                <div>Q2. 在 Max Heap 裡面，左邊的小孩一定比右邊的小孩小嗎？</div>
                <div class="quiz-btn-group">
                    <button class="quiz-btn" onclick="checkQuiz(2, true)">一定</button>
                    <button class="quiz-btn" onclick="checkQuiz(2, false)">不一定</button>
                </div>
                <div id="quiz-res-2" class="quiz-result"></div>
            </div>

            <div class="quiz-item">
                <div>Q3. Heap 可以用來做排序嗎？</div>
                <div class="quiz-btn-group">
                    <button class="quiz-btn" onclick="checkQuiz(3, true)">可以</button>
                    <button class="quiz-btn" onclick="checkQuiz(3, false)">不行</button>
                </div>
                <div id="quiz-res-3" class="quiz-result"></div>
            </div>
        </div>

        <!-- H. 口訣與陷阱 -->
        <div class="card">
            <h2>名師筆記</h2>
            <div class="mnemonic-box">
                <div>★ 記憶口訣 ★</div>
                <div class="mnemonic-text">「形要滿，值只比父」</div>
                <div style="font-size: 0.9rem; color: #555;">(形狀要是完全二元樹，數值只跟父親比大小)</div>
            </div>

            <h3>【常見陷阱】</h3>
            <ul class="pitfall-list">
                <li>(X) 以為 Heap 整棵樹都有排序（那是 BST）。</li>
                <li>(X) 以為左右子樹高度要一樣（那是 AVL）。</li>
                <li>(X) 只記得父大於子，忘記結構一定要是「完全二元樹」。</li>
            </ul>
        </div>

        <!-- I. 答案揭曉 -->
        <div class="reveal-section">
            <button class="reveal-btn" onclick="revealAnswer()">揭曉正確答案</button>
            <div id="final-answer">
                <h2 style="color: white; border-bottom: 1px solid rgba(255,255,255,0.3);">正確答案：(B)</h2>
                <p>理由：Heap 的定義就是同時滿足「完全二元樹」與「父子節點次序性質」。</p>
            </div>
        </div>

    </main>

    <footer>
        <p>Short-Term Sprint Course | Data Structures Q21 | Designed for Learning</p>
    </footer>

</div>

<script>
    // 1. 關鍵字螢光筆與解釋
    const definitions = {
        'heap': 'Heap（堆積）：一種有規則的二元樹，最常用來實作「優先權佇列」，找最大或最小值超快。',
        'complete': '完全二元樹（Complete Binary Tree）：樹的生長很有規矩，每一層都要填滿，最後一層如果沒滿，一定要靠左邊填，不能跳格子。',
        'parent': '父節點（Parent）：在樹狀結構中，位於上層的節點，它下面連接著子節點。',
        'child': '子節點（Child）：被父節點連接、位於下層的節點。',
        'maxheap': '最大堆（Max Heap）：一種 Heap，規定「父節點」一定要「大於或等於」子節點。最大的數會在樹根。',
        'minheap': '最小堆（Min Heap）：一種 Heap，規定「父節點」一定要「小於或等於」子節點。最小的數會在樹根。',
        'sort': '排序（Sort）：將資料由小到大或由大到小排列整齊。Heap 本身不是完全排序的，但可以透過取出過程來達成排序（Heap Sort）。'
    };

    function highlight(key) {
        // 清除舊的 highlight
        document.querySelectorAll('.highlight-text').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.keyword-btn').forEach(btn => btn.classList.remove('active'));
        
        // 設定解釋文字
        const explanationBox = document.getElementById('keyword-explanation');
        explanationBox.textContent = definitions[key];

        // 標記按鈕
        event.target.classList.add('active');

        // 根據 key 點亮對應的文字
        if (key === 'heap') document.getElementById('txt-heap').classList.add('active');
        if (key === 'complete') document.getElementById('txt-complete').classList.add('active');
        if (key === 'parent') document.getElementById('txt-parent').classList.add('active');
        if (key === 'child') document.getElementById('txt-child').classList.add('active');
        if (key === 'sort') document.getElementById('txt-sort').classList.add('active');
        
        // 額外處理 Max/Min Heap 雖然題目沒直接字，但可解釋概念
        if (key === 'maxheap' || key === 'minheap') {
             document.getElementById('txt-parent').classList.add('active');
             document.getElementById('txt-child').classList.add('active');
        }
    }

    // 2. Accordion 展開收合
    const acc = document.getElementsByClassName("accordion");
    for (let i = 0; i < acc.length; i++) {
        acc[i].addEventListener("click", function() {
            this.classList.toggle("active");
            const panel = this.nextElementSibling;
            if (panel.style.maxHeight) {
                panel.style.maxHeight = null;
            } else {
                panel.style.maxHeight = panel.scrollHeight + "px";
            }
        });
    }

    // 3. Tree 檢查邏輯
    function checkTree(type) {
        const feedback = document.getElementById('tree-feedback-area');
        feedback.style.display = 'block';
        feedback.className = 'tree-feedback'; // reset

        if (type === 1) {
            feedback.classList.add('is-heap');
            feedback.innerHTML = "⭕ 是 Heap！<br>符合完全二元樹，且父節點 (10, 8) 都大於子節點。";
        } else if (type === 2) {
            feedback.classList.add('not-heap');
            feedback.innerHTML = "❌ 不是 Heap<br>形狀不對！它不是「完全二元樹」。<br>右邊有小孩 (7)，但左邊 (8) 的小孩卻缺了，不能跳著長。";
        } else if (type === 3) {
            feedback.classList.add('not-heap');
            feedback.innerHTML = "❌ 不是 Heap<br>數值不對！<br>你看根節點是 5，但左小孩是 10。<br>如果是 Max Heap，爸爸不能輸給小孩！";
        }
    }

    // 4. 選項解析展開
    function toggleOption(id) {
        const el = document.getElementById(id);
        if (el.style.display === 'block') {
            el.style.display = 'none';
        } else {
            el.style.display = 'block';
        }
    }

    // 5. 小測驗
    function checkQuiz(qNum, answer) {
        const resDiv = document.getElementById('quiz-res-' + qNum);
        resDiv.style.display = 'block';
        
        let correct = false;
        let msg = "";

        if (qNum === 1) {
            // Heap 必須是完全二元樹? YES
            correct = (answer === true);
            msg = correct ? "答對了！這是基本門檻。" : "錯囉，Heap 對形狀要求很嚴格，一定要是完全二元樹。";
        } else if (qNum === 2) {
            // 兄弟有大小關係? NO
            correct = (answer === false);
            msg = correct ? "答對了！Heap 只管父子，不管兄弟誰大誰小。" : "錯囉，Heap 的左右兄弟之間沒有規定大小關係。";
        } else if (qNum === 3) {
            // 可以做排序? YES (Heap Sort)
            correct = (answer === true);
            msg = correct ? "答對了！雖然 Heap 本身不是全排序，但一直取出根節點就能完成排序（Heap Sort）。" : "錯囉，利用 Heap 取出最大值的特性，是可以做到排序的（Heap Sort）。";
        }

        if (correct) {
            resDiv.style.color = 'var(--correct-color)';
            resDiv.innerHTML = "✅ " + msg;
        } else {
            resDiv.style.color = 'var(--wrong-color)';
            resDiv.innerHTML = "⚠️ " + msg;
        }
    }

    // 6. 揭曉答案
    function revealAnswer() {
        const ans = document.getElementById('final-answer');
        ans.style.display = 'block';
        ans.scrollIntoView({behavior: "smooth"});
    }
</script>

</body>
</html>