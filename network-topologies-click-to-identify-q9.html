<!-- 
    Filename: network-topologies-click-to-identify-q9.html
    Author: é›»è…¦æ¦‚è«–è£œæ•™åå¸«
    Description: å–®ä¸€ HTML æª”äº’å‹•å¼æ•™å­¸ç¶²é ï¼ŒåŒ…å«ç¶²è·¯æ‹“æ¨¸è§€å¿µã€äº’å‹•è¾¨è­˜æ¸¬é©—èˆ‡è§£æã€‚
    Target: é«˜ä¸­é›»è…¦/è³‡è¨Šç§‘æŠ€å­¸ç”Ÿ
-->
<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã€é›»æ¦‚åå¸«é–‹è¬›ã€‘ç¶²è·¯æ‹“æ¨¸å¤§è§£æ - äº’å‹•ç‰¹è¨“ç­</title>
    <style>
        :root {
            --primary: #3b82f6; /* è£œç¿’ç­è— */
            --primary-dark: #1d4ed8;
            --secondary: #10b981; /* æ­£ç¢ºç¶  */
            --danger: #ef4444; /* éŒ¯èª¤ç´… */
            --bg-color: #f3f4f6;
            --card-bg: #ffffff;
            --text-main: #1f2937;
            --text-muted: #6b7280;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        * {
            box-sizing: border-box;
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        header h1 {
            margin: 0;
            font-size: 1.8rem;
        }

        header p {
            margin: 10px 0 0;
            opacity: 0.9;
            font-size: 1rem;
        }

        /* Card System */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: var(--shadow);
            border-left: 5px solid var(--primary);
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .card h2 {
            margin-top: 0;
            color: var(--primary-dark);
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .badge {
            background: var(--primary);
            color: white;
            font-size: 0.8rem;
            padding: 2px 8px;
            border-radius: 12px;
            vertical-align: middle;
        }

        /* Checkbox Form */
        .quiz-options label {
            display: block;
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .quiz-options label:hover {
            background-color: #f9fafb;
        }

        .quiz-options input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }

        .btn-group {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            transition: opacity 0.2s;
        }

        button:hover {
            opacity: 0.9;
        }

        .btn-primary { background: var(--primary); color: white; }
        .btn-secondary { background: var(--text-muted); color: white; }
        .btn-success { background: var(--secondary); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-outline { background: transparent; border: 2px solid var(--primary); color: var(--primary); }

        /* Feedback Areas */
        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }
        .feedback.success { background: #d1fae5; color: #065f46; border: 1px solid #34d399; }
        .feedback.error { background: #fee2e2; color: #991b1b; border: 1px solid #f87171; }
        .feedback.info { background: #eff6ff; color: #1e40af; border: 1px solid #60a5fa; }

        /* Glossary Accordion */
        .glossary-item {
            margin-bottom: 5px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            overflow: hidden;
        }

        .glossary-header {
            padding: 10px 15px;
            background: #f9fafb;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            font-weight: bold;
        }

        .glossary-content {
            padding: 0 15px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            background: white;
            color: #4b5563;
            font-size: 0.95rem;
        }

        .glossary-content.open {
            padding: 15px;
            max-height: 200px;
            border-top: 1px solid #e5e7eb;
        }

        /* Interactive Visual Quiz */
        .visual-quiz-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .topology-svg-wrapper {
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            position: relative;
        }

        .topology-svg-wrapper:hover {
            border-color: var(--primary);
            background: #eff6ff;
        }

        .topology-svg-wrapper.active {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.3);
            background: #fff;
        }

        .click-hint {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 5px;
        }

        svg {
            width: 100%;
            height: 100px;
            display: block;
            margin: 0 auto;
        }

        /* SVG Styles */
        .node { fill: white; stroke: #333; stroke-width: 2; }
        .center-node { fill: var(--primary); stroke: #1d4ed8; }
        .link { stroke: #666; stroke-width: 2; }
        .backbone { stroke: #333; stroke-width: 4; stroke-linecap: round; }
        .terminator { fill: #333; }

        /* Quiz Interaction Area */
        #visual-quiz-interaction {
            margin-top: 20px;
            padding: 20px;
            background: #f0f9ff;
            border-radius: 8px;
            border: 1px solid #bae6fd;
            display: none; /* Hidden until clicked */
            text-align: center;
        }

        #visual-score {
            float: right;
            font-weight: bold;
            color: var(--primary);
        }

        /* True/False Buttons */
        .tf-question {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #ddd;
        }
        .tf-question:last-child { border-bottom: none; }
        .tf-options { margin-top: 8px; }

        /* Responsive */
        @media (max-width: 600px) {
            .btn-group { flex-direction: column; }
            button { width: 100%; }
            #visual-score { float: none; display: block; margin-bottom: 10px; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>åå¸«é–‹è¬›ï¼šç¶²è·¯æ‹“æ¨¸å¤§è§£æ</h1>
        <p>è·Ÿè‘—è€å¸«å‹•æ‰‹åšï¼Œä¸€æ¬¡ææ‡‚ Starã€Ringã€Busã€Treeã€P2Pï¼</p>
    </header>

    <!-- 1. åè©é€ŸæŸ¥ (Glossary) -->
    <div class="card">
        <h2>ğŸ“š åè©é€ŸæŸ¥ <span style="font-size:0.9rem; font-weight:normal; margin-left:auto; color: #666;">(é»æ“Šå±•é–‹)</span></h2>
        <div id="glossary-list">
            <!-- Items injected by JS -->
        </div>
    </div>

    <!-- 2. é¡Œç›®å¡ (The Question) -->
    <div class="card">
        <h2>ğŸ“ è¤‡é¸é¡Œ 9</h2>
        <p style="font-size: 1.1rem; font-weight: bold;">ä¸‹åˆ—ä½•è€…æ˜¯å¸¸è¦‹çš„é›»è…¦ç¶²è·¯æ‹“æ¨¸çµæ§‹?</p>
        <div class="quiz-options">
            <label><input type="checkbox" name="q9" value="A"> (A) æ¨¹ç‹€ (Tree)</label>
            <label><input type="checkbox" name="q9" value="B"> (B) ç’°ç‹€ (Ring)</label>
            <label><input type="checkbox" name="q9" value="C"> (Star) æ˜Ÿç‹€</label>
            <label><input type="checkbox" name="q9" value="D"> (Bus) åŒ¯æµæ’</label>
            <label><input type="checkbox" name="q9" value="E"> (Peer2Peer) é»å°é»</label>
        </div>
        <div class="btn-group">
            <button class="btn-primary" onclick="checkMainQuiz()">é€å‡ºç­”æ¡ˆ</button>
            <button class="btn-secondary" onclick="toggleExplanation()">é¡¯ç¤ºè§£æ</button>
            <button class="btn-outline" onclick="resetMainQuiz()">é‡ä½œä¸€æ¬¡</button>
        </div>
        <div id="main-quiz-feedback" class="feedback"></div>
    </div>

    <!-- 3. è§€å¿µå¡ (Concepts) -->
    <div class="card">
        <h2>ğŸ’¡ è§€å¿µæ‡¶äººåŒ…</h2>
        <ul style="padding-left: 20px;">
            <li><strong>åŒ¯æµæ’ (Bus)</strong>ï¼šæ‰€æœ‰é›»è…¦æ›åœ¨ä¸€æ¢ä¸»å¹¹ç·š (Backbone) ä¸Šï¼Œæœ€çœç·šï¼Œä½†æ–·ç·šå…¨æ›ã€‚</li>
            <li><strong>ç’°ç‹€ (Ring)</strong>ï¼šæ‰‹ç‰½æ‰‹åœåœˆåœˆï¼Œè³‡æ–™å–®å‘ç¹åœˆå‚³ï¼Œæœ‰äººæ–·ç·šå°±éº»ç…© (é™¤éé›™ç’°)ã€‚</li>
            <li><strong>æ˜Ÿç‹€ (Star)</strong>ï¼šä¸­é–“æœ‰å€‹è€å¤§ (é›†ç·šå™¨/äº¤æ›å™¨)ï¼Œå¤§å®¶éƒ½é€£å®ƒã€‚ç¾åœ¨æœ€å¸¸è¦‹ï¼</li>
            <li><strong>æ¨¹ç‹€ (Tree)</strong>ï¼šåƒå®¶æ—æ¨¹ï¼Œä¸€å±¤ä¸€å±¤åˆ†æ”¯ï¼Œå¤§å‹ç¶²è·¯æ„›ç”¨ã€‚</li>
            <li><strong>é»å°é» (P2P/Mesh)</strong>ï¼šå¤§å®¶éš¨æ„é€£ï¼Œæ²’å¤§æ²’å°ï¼Œæœ€å¯é ä½†ç·šæœ€è¤‡é›œã€‚</li>
        </ul>
    </div>

    <!-- 4. å¯é»åœ–è¾¨è­˜å¡ (Interactive Visual Quiz) -->
    <div class="card" style="border-left-color: var(--secondary);">
        <h2>ğŸ‘€ äº’å‹•ç‰¹è¨“ï¼šçœ‹åœ–çŒœçŒœçœ‹</h2>
        <p>è«‹é»æ“Šä¸‹æ–¹çš„ç¤ºæ„åœ–ï¼Œç„¶å¾Œé¸å‡ºæ­£ç¢ºçš„æ‹“æ¨¸åç¨±ï¼</p>
        
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
            <button class="btn-outline" onclick="initVisualQuiz(true)" style="padding: 5px 10px; font-size: 0.9rem;">ğŸ”„ éš¨æ©Ÿæ’åˆ—åœ–æ¡ˆ</button>
            <span id="visual-score">ç­”å° 0 / å…± 0</span>
            <button class="btn-outline" onclick="resetScore()" style="padding: 5px 10px; font-size: 0.9rem; margin-left:10px;">æ­¸é›¶</button>
        </div>

        <!-- é€™è£¡æ”¾ç½® SVG åœ–å½¢ -->
        <div id="topology-grid" class="visual-quiz-container">
            <!-- Generated by JS -->
        </div>

        <!-- ä½œç­”å€å¡Š (é»åœ–å¾Œé¡¯ç¤º) -->
        <div id="visual-quiz-interaction">
            <h3 id="selected-img-title">è«‹é¸æ“‡é€™å¼µåœ–çš„åç¨±ï¼š</h3>
            <select id="topology-select" style="padding: 10px; font-size: 1rem; border-radius: 4px;">
                <option value="">-- è«‹é¸æ“‡ --</option>
                <option value="Tree">æ¨¹ç‹€ (Tree)</option>
                <option value="Ring">ç’°ç‹€ (Ring)</option>
                <option value="Star">æ˜Ÿç‹€ (Star)</option>
                <option value="Bus">åŒ¯æµæ’ (Bus)</option>
                <option value="P2P">é»å°é» (P2P/Mesh)</option>
            </select>
            <button class="btn-primary" onclick="checkVisualAnswer()">åˆ¤å®š</button>
            <div id="visual-feedback" style="margin-top: 10px; font-weight: bold;"></div>
        </div>
    </div>

    <!-- 5. è§£æå¡ (Detailed Explanation) -->
    <div class="card" id="explanation-card" style="display:none;">
        <h2>ğŸ“– è€å¸«è©³è§£</h2>
        <p><strong>æ­£ç¢ºç­”æ¡ˆï¼šAã€Bã€Cã€Dã€E (å…¨é¸)</strong></p>
        <p>é€™ä¸€é¡Œè€ƒçš„æ˜¯ã€Œå»£ç¾©çš„æ‹“æ¨¸åˆ†é¡ã€ã€‚ä¸ç®¡æ˜¯å¯¦é«”çš„ç·šè·¯æ¥æ³•ï¼Œé‚„æ˜¯é‚è¼¯ä¸Šçš„è³‡æ–™æµå‘ï¼Œé€™äº”å€‹éƒ½æ˜¯èª²æœ¬å®šç¾©çš„æ¨™æº–æ‹“æ¨¸ã€‚</p>
        <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">
        
        <h4>å„é¸é …è§£æï¼š</h4>
        <ul>
            <li><strong>(A) Tree</strong>ï¼šç”± Star å»¶ä¼¸è€Œä¾†ï¼Œå…·æœ‰éšå±¤æ€§ (Hierarchy)ï¼Œä¼æ¥­ç¶²è·¯ã€æ ¡åœ’ç¶²è·¯ä¸»å¹¹å¸¸æ˜¯é€™ç¨®çµæ§‹ã€‚</li>
            <li><strong>(B) Ring</strong>ï¼šæ—©æœŸ Token Ring æŠ€è¡“ä½¿ç”¨ã€‚è¨Šè™Ÿç¹åœˆè·‘ï¼Œå„ªé»æ˜¯æ²’æœ‰ç¢°æ’ï¼Œç¼ºé»æ˜¯ç¶­è­·ä¸æ˜“ã€‚</li>
            <li><strong>(C) Star</strong>ï¼šç¾ä»£ä¹™å¤ªç¶²è·¯ (Ethernet) çš„æ¨™æº–ã€‚å¦‚æœä½ å®¶è£¡æœ‰ Wi-Fi åˆ†äº«å™¨æˆ– Switchï¼Œæ‹‰ç·šå‡ºå»çµ¦é›»è…¦ï¼Œé€™å°±æ˜¯æ˜Ÿç‹€ï¼</li>
            <li><strong>(D) Bus</strong>ï¼šæ—©æœŸçš„åŒè»¸é›»çºœç¶²è·¯ã€‚ç‰¹è‰²æ˜¯å…©ç«¯è¦æœ‰çµ‚ç«¯é›»é˜» (Terminator)ã€‚</li>
            <li><strong>(E) P2P</strong>ï¼šåœ¨æ‹“æ¨¸å­¸ä¸­ï¼ŒæŒ‡ç¯€é»ä¹‹é–“æœ‰ç›´æ¥é€£ç·š (Mesh ç¶²ç‹€çµæ§‹æ˜¯å…¶æ¥µè‡´)ã€‚æ³¨æ„ä¸è¦è·Ÿè»Ÿé«”çš„ P2P ä¸‹è¼‰æ··æ·†ï¼Œä½†åœ¨å¯¦é«”çµæ§‹ä¸Šï¼Œé»å°é»ç›´é€£ç¢ºå¯¦æ˜¯ä¸€ç¨®æ‹“æ¨¸ã€‚</li>
        </ul>

        <div class="feedback error" style="display:block; margin-top:15px;">
            <strong>âš ï¸ è€ƒè©¦å¸¸è¦‹é™·é˜±ï¼š</strong>
            <ul style="margin-bottom:0;">
                <li><strong>Client-Server (ä¸»å¾å¼æ¶æ§‹)</strong>ï¼šé€™æ˜¯ã€Œç¶²è·¯è»Ÿé«”æ¶æ§‹ã€æˆ–ã€Œé‹ä½œæ¨¡å¼ã€ï¼Œ<strong>ä¸æ˜¯</strong>å¯¦é«”æ‹“æ¨¸ï¼å¦‚æœé¸é …å‡ºç¾é€™å€‹ï¼Œåƒè¬åˆ¥é¸ã€‚</li>
                <li><strong>æ··åˆå‹ (Hybrid)</strong>ï¼šçœŸå¯¦ä¸–ç•Œé€šå¸¸æ˜¯æ··åˆçš„ (ä¾‹å¦‚ Star + Bus = Tree)ï¼Œå¦‚æœé¸é …æœ‰ Hybrid ä¹Ÿæ˜¯å°çš„ã€‚</li>
            </ul>
        </div>
    </div>

    <!-- 6. å»¶ä¼¸ç·´ç¿’ (Extended Practice) -->
    <div class="card">
        <h2>ğŸš€ èª²å¾Œå°æ¸¬é©— (æ˜¯éé¡Œ)</h2>
        
        <div class="tf-question">
            <p>1. æ˜Ÿç‹€æ‹“æ¨¸ (Star) ä¸€å®šæœ‰ä¸€å€‹ä¸­å¿ƒç¯€é» (å¦‚ Hub æˆ– Switch)ï¼Ÿ</p>
            <div class="tf-options">
                <button class="btn-outline" onclick="checkTF(this, true, 'æ²’éŒ¯ï¼æ‰€æœ‰é›»è…¦éƒ½é€£å‘é€™å€‹ä¸­å¿ƒè¨­å‚™ã€‚')">O</button>
                <button class="btn-outline" onclick="checkTF(this, false, 'éŒ¯å›‰ï¼æ˜Ÿç‹€çš„æ ¸å¿ƒç‰¹å¾µå°±æ˜¯è¦æœ‰ä¸­å¿ƒç¯€é»ã€‚')">X</button>
            </div>
            <div class="tf-feedback"></div>
        </div>

        <div class="tf-question">
            <p>2. åŒ¯æµæ’æ‹“æ¨¸ (Bus) çš„ç‰¹å¾µæ˜¯æ‰€æœ‰é›»è…¦å…±ç”¨ä¸€æ¢ä¸»å¹¹ï¼Œä¸”å…©ç«¯éœ€è¦çµ‚ç«¯é›»é˜»ï¼Ÿ</p>
            <div class="tf-options">
                <button class="btn-outline" onclick="checkTF(this, true, 'æ­£ç¢ºï¼å°±åƒå…¬è»Šè¡Œé§›åœ¨ä¸»è¦å¹¹é“ä¸Šã€‚')">O</button>
                <button class="btn-outline" onclick="checkTF(this, false, 'ä¸å°å–”ï¼é€™æ˜¯ Bus æ‹“æ¨¸æœ€æ¨™æº–çš„å®šç¾©ã€‚')">X</button>
            </div>
            <div class="tf-feedback"></div>
        </div>

        <div class="tf-question">
            <p>3. Client-Server (ä¸»å¾å¼) æ˜¯ä¸€ç¨®å¸¸è¦‹çš„å¯¦é«”ç·šè·¯æ‹“æ¨¸ï¼Ÿ</p>
            <div class="tf-options">
                <button class="btn-outline" onclick="checkTF(this, false, 'éŒ¯ï¼é™·é˜±é¡Œï¼Client-Server æ˜¯è»Ÿé«”é‹ä½œæ¨¡å¼ï¼Œä¸æ˜¯æ¥ç·šå½¢ç‹€ã€‚')">O</button>
                <button class="btn-outline" onclick="checkTF(this, true, 'ç­”å°äº†ï¼é€™ä¸æ˜¯æ‹“æ¨¸ï¼ŒStar æˆ– Bus æ‰æ˜¯æ‹“æ¨¸ã€‚')">X</button>
            </div>
            <div class="tf-feedback"></div>
        </div>
    </div>

    <footer style="text-align: center; margin-top: 30px; color: #6b7280; font-size: 0.9rem;">
        <p>&copy; é›»è…¦æ¦‚è«–è£œæ•™åœ˜éšŠ | å°ˆæ³¨å‡å­¸è€ƒè©¦</p>
    </footer>
</div>

<script>
    /* --- 1. Glossary Data & Logic --- */
    const glossaryData = [
        { term: "æ‹“æ¨¸ (Topology)", desc: "æŒ‡ç¶²è·¯ä¸­è¨­å‚™èˆ‡ç·šè·¯é€£æ¥çš„å¹¾ä½•å½¢ç‹€æˆ–æ˜¯é‚è¼¯æ¶æ§‹ã€‚" },
        { term: "æ¨¹ç‹€ (Tree)", desc: "éšå±¤å¼çµæ§‹ï¼Œåƒæ¨¹æ ¹åˆ†æ”¯ï¼Œå¸¸ç”¨æ–¼å¤§å‹ç¶²è·¯ä¸»å¹¹ã€‚" },
        { term: "ç’°ç‹€ (Ring)", desc: "ç¯€é»é¦–å°¾ç›¸æ¥å½¢æˆå°é–‰åœ“ç’°ï¼Œè³‡æ–™å–®å‘å‚³è¼¸ã€‚" },
        { term: "æ˜Ÿç‹€ (Star)", desc: "æ‰€æœ‰ç¯€é»é€£æ¥åˆ°ä¸€å€‹ä¸­å¤®è¨­å‚™ (Hub/Switch)ã€‚" },
        { term: "åŒ¯æµæ’ (Bus)", desc: "æ‰€æœ‰ç¯€é»å…±ç”¨ä¸€æ¢å‚³è¼¸ç·š (ä¸»å¹¹)ï¼Œçµæ§‹ç°¡å–®ã€‚" },
        { term: "é»å°é» (P2P)", desc: "ç¯€é»é–“ç›´æ¥äº’é€£ï¼Œä¸ä¸€å®šä¾è³´ä¸­å¿ƒï¼Œå¯é æ€§é«˜ã€‚" },
        { term: "ä¸­å¿ƒç¯€é» (Hub/Switch)", desc: "æ˜Ÿç‹€æ‹“æ¨¸çš„æ ¸å¿ƒè¨­å‚™ï¼Œè² è²¬è½‰é€è³‡æ–™ã€‚" },
        { term: "ä¸»å¹¹ (Backbone)", desc: "åŒ¯æµæ’æˆ–æ¨¹ç‹€çµæ§‹ä¸­ï¼Œæ‰¿è¼‰ä¸»è¦æµé‡çš„ç·šè·¯ã€‚" }
    ];

    function renderGlossary() {
        const container = document.getElementById('glossary-list');
        let html = '';
        glossaryData.forEach((item, index) => {
            html += `
                <div class="glossary-item">
                    <div class="glossary-header" onclick="toggleGlossary(${index})">
                        ${item.term} <span>â–¼</span>
                    </div>
                    <div class="glossary-content" id="gloss-content-${index}">
                        ${item.desc}
                    </div>
                </div>
            `;
        });
        container.innerHTML = html;
    }

    function toggleGlossary(index) {
        const content = document.getElementById(`gloss-content-${index}`);
        content.classList.toggle('open');
    }

    /* --- 2. Main Quiz Logic --- */
    function checkMainQuiz() {
        const checkboxes = document.querySelectorAll('input[name="q9"]:checked');
        const feedback = document.getElementById('main-quiz-feedback');
        const correctAnswers = ['A', 'B', 'C', 'D', 'E'];
        
        let userAnswers = [];
        checkboxes.forEach(cb => userAnswers.push(cb.value));
        
        feedback.style.display = 'block';
        feedback.className = 'feedback';

        // Check if user selected exactly A, B, C, D, E
        if (userAnswers.length === 5) {
            feedback.classList.add('success');
            feedback.innerHTML = `<strong>ğŸ‰ å®Œå…¨æ­£ç¢ºï¼</strong><br>æœ¬é¡Œè€ƒçš„æ˜¯ã€Œæ˜¯å¦å±¬æ–¼æ‹“æ¨¸ç¨®é¡ã€ï¼Œé€™äº”å€‹é¸é …å…¨éƒ½æ˜¯é›»è…¦ç¶²è·¯å®šç¾©çš„æ¨™æº–æ‹“æ¨¸çµæ§‹ã€‚`;
        } else {
            feedback.classList.add('error');
            let msg = `<strong>âŒ ç­”éŒ¯å›‰ï¼</strong><br>`;
            if (userAnswers.length < 5) msg += `ä½ æ¼é¸äº†ï¼é€™äº”å€‹å…¨éƒ¨éƒ½æ˜¯æ‹“æ¨¸å–”ã€‚<br>`;
            msg += `è¨˜ä½ï¼šåªè¦æ˜¯ç”¨ä¾†æè¿°ã€Œç¯€é»é€£æ¥å½¢ç‹€ã€çš„åè©ï¼Œé€šå¸¸éƒ½æ˜¯ã€‚`;
            feedback.innerHTML = msg;
        }
    }

    function toggleExplanation() {
        const card = document.getElementById('explanation-card');
        card.style.display = card.style.display === 'none' ? 'block' : 'none';
        // Auto scroll to explanation
        if(card.style.display === 'block') card.scrollIntoView({behavior: "smooth"});
    }

    function resetMainQuiz() {
        document.querySelectorAll('input[name="q9"]').forEach(cb => cb.checked = false);
        document.getElementById('main-quiz-feedback').style.display = 'none';
        document.getElementById('explanation-card').style.display = 'none';
    }

    /* --- 3. Interactive Visual Quiz Logic (SVG Generation) --- */
    
    // SVG Templates (Functions returning SVG string)
    const svgs = {
        'Star': () => `
            <svg viewBox="0 0 200 100">
                <line x1="100" y1="50" x2="50" y2="20" class="link" />
                <line x1="100" y1="50" x2="150" y2="20" class="link" />
                <line x1="100" y1="50" x2="50" y2="80" class="link" />
                <line x1="100" y1="50" x2="150" y2="80" class="link" />
                <line x1="100" y1="50" x2="100" y2="10" class="link" />
                
                <circle cx="50" cy="20" r="8" class="node" />
                <circle cx="150" cy="20" r="8" class="node" />
                <circle cx="50" cy="80" r="8" class="node" />
                <circle cx="150" cy="80" r="8" class="node" />
                <circle cx="100" cy="10" r="8" class="node" />
                
                <rect x="90" y="40" width="20" height="20" class="center-node" />
            </svg>`,
        
        'Bus': () => `
            <svg viewBox="0 0 200 100">
                <line x1="20" y1="50" x2="180" y2="50" class="backbone" />
                <rect x="15" y="45" width="5" height="10" class="terminator" />
                <rect x="180" y="45" width="5" height="10" class="terminator" />
                
                <line x1="50" y1="50" x2="50" y2="75" class="link" />
                <line x1="100" y1="50" x2="100" y2="25" class="link" />
                <line x1="150" y1="50" x2="150" y2="75" class="link" />
                
                <circle cx="50" cy="80" r="8" class="node" />
                <circle cx="100" cy="20" r="8" class="node" />
                <circle cx="150" cy="80" r="8" class="node" />
            </svg>`,
        
        'Ring': () => `
            <svg viewBox="0 0 200 100">
                <path d="M100,20 L150,50 L130,90 L70,90 L50,50 Z" fill="none" class="link" />
                
                <circle cx="100" cy="20" r="8" class="node" />
                <circle cx="150" cy="50" r="8" class="node" />
                <circle cx="130" cy="90" r="8" class="node" />
                <circle cx="70" cy="90" r="8" class="node" />
                <circle cx="50" cy="50" r="8" class="node" />
            </svg>`,
            
        'Tree': () => `
            <svg viewBox="0 0 200 100">
                <line x1="100" y1="15" x2="60" y2="50" class="link" />
                <line x1="100" y1="15" x2="140" y2="50" class="link" />
                
                <line x1="60" y1="50" x2="40" y2="85" class="link" />
                <line x1="60" y1="50" x2="80" y2="85" class="link" />
                <line x1="140" y1="50" x2="120" y2="85" class="link" />
                <line x1="140" y1="50" x2="160" y2="85" class="link" />
                
                <circle cx="100" cy="15" r="8" class="center-node" />
                <circle cx="60" cy="50" r="8" class="node" />
                <circle cx="140" cy="50" r="8" class="node" />
                <circle cx="40" cy="85" r="8" class="node" />
                <circle cx="80" cy="85" r="8" class="node" />
                <circle cx="120" cy="85" r="8" class="node" />
                <circle cx="160" cy="85" r="8" class="node" />
            </svg>`,
            
        'P2P': () => `
            <svg viewBox="0 0 200 100">
                <!-- Messy connections -->
                <line x1="40" y1="30" x2="160" y2="30" class="link" />
                <line x1="40" y1="30" x2="100" y2="80" class="link" />
                <line x1="160" y1="30" x2="100" y2="80" class="link" />
                <line x1="40" y1="30" x2="40" y2="80" class="link" />
                <line x1="160" y1="30" x2="160" y2="80" class="link" />
                <line x1="40" y1="80" x2="160" y2="80" class="link" />
                
                <circle cx="40" cy="30" r="8" class="node" />
                <circle cx="160" cy="30" r="8" class="node" />
                <circle cx="100" cy="80" r="8" class="node" />
                <circle cx="40" cy="80" r="8" class="node" />
                <circle cx="160" cy="80" r="8" class="node" />
            </svg>`
    };

    const hints = {
        'Star': 'ç‰¹å¾µï¼šä¸­é–“æœ‰ä¸€å€‹æ ¸å¿ƒè¨­å‚™ (æ–¹å¡Š)ï¼Œå¤§å®¶éƒ½é€£å®ƒã€‚',
        'Bus': 'ç‰¹å¾µï¼šä¸­é–“æœ‰ä¸€æ¢ç²—ç²—çš„ä¸»å¹¹ç·šï¼Œå…©é ­æœ‰çµ‚ç«¯ã€‚',
        'Ring': 'ç‰¹å¾µï¼šåœæˆä¸€å€‹åœˆåœˆï¼Œæ²’æœ‰ä¸­å¿ƒï¼Œä¹Ÿæ²’æœ‰é ­å°¾ã€‚',
        'Tree': 'ç‰¹å¾µï¼šåƒæ¨¹æ ¹ä¸€æ¨£åˆ†å²”ï¼Œä¸Šé¢æ˜¯æ ¹ï¼Œä¸‹é¢æ˜¯è‘‰å­ã€‚',
        'P2P': 'ç‰¹å¾µï¼šç¶²ç‹€æˆ–å¤šé»äº’é€£ï¼Œç·šè·¯è¤‡é›œï¼Œå¤§å®¶åœ°ä½å¹³ç­‰ã€‚'
    };

    let currentScore = 0;
    let totalAttempts = 0;
    let currentSelectedTopology = null;
    let currentSelectedDiv = null;

    // Initialize visual quiz
    function initVisualQuiz(randomize = false) {
        const grid = document.getElementById('topology-grid');
        grid.innerHTML = '';
        
        // Hide interaction area
        document.getElementById('visual-quiz-interaction').style.display = 'none';
        
        let keys = Object.keys(svgs);
        if (randomize) {
            keys.sort(() => Math.random() - 0.5);
        }

        keys.forEach(key => {
            const div = document.createElement('div');
            div.className = 'topology-svg-wrapper';
            div.innerHTML = svgs[key]();
            div.innerHTML += `<div class="click-hint">é»æˆ‘ä½œç­”</div>`;
            div.onclick = () => selectTopologyImage(div, key);
            grid.appendChild(div);
        });
    }

    function selectTopologyImage(divElement, topologyKey) {
        // Highlight logic
        document.querySelectorAll('.topology-svg-wrapper').forEach(el => el.classList.remove('active'));
        divElement.classList.add('active');
        
        // Setup interaction area
        currentSelectedTopology = topologyKey;
        currentSelectedDiv = divElement;
        
        const interactionArea = document.getElementById('visual-quiz-interaction');
        interactionArea.style.display = 'block';
        document.getElementById('selected-img-title').innerText = "ä½ è¦ºå¾—é€™å¼µåœ–æ˜¯ï¼Ÿ";
        document.getElementById('visual-feedback').innerHTML = '';
        document.getElementById('topology-select').value = '';
        
        // Scroll slightly if needed on mobile
        interactionArea.scrollIntoView({behavior: "smooth", block: "nearest"});
    }

    function checkVisualAnswer() {
        const userSelect = document.getElementById('topology-select').value;
        const feedback = document.getElementById('visual-feedback');
        
        if (!userSelect) {
            alert("è«‹å…ˆé¸æ“‡ä¸€å€‹ç­”æ¡ˆï¼");
            return;
        }

        totalAttempts++;

        if (userSelect === currentSelectedTopology) {
            currentScore++;
            feedback.innerHTML = `<span style="color:var(--secondary)">âœ… ç­”å°äº†ï¼</span> é€™æ˜¯ ${currentSelectedTopology}ã€‚`;
            // Visual cue on the grid item
            currentSelectedDiv.style.borderColor = 'var(--secondary)';
            currentSelectedDiv.style.background = '#d1fae5';
            currentSelectedDiv.querySelector('.click-hint').innerText = "âœ… å·²å®Œæˆ";
        } else {
            feedback.innerHTML = `<span style="color:var(--danger)">âŒ ç­”éŒ¯äº†ï¼</span> é€™å…¶å¯¦æ˜¯ <strong>${currentSelectedTopology}</strong>ã€‚<br><span style="font-weight:normal; font-size:0.9rem">${hints[currentSelectedTopology]}</span>`;
            currentSelectedDiv.style.borderColor = 'var(--danger)';
            currentSelectedDiv.style.background = '#fee2e2';
        }

        updateScoreBoard();
    }

    function updateScoreBoard() {
        document.getElementById('visual-score').innerText = `ç­”å° ${currentScore} / å…± ${totalAttempts}`;
    }

    function resetScore() {
        currentScore = 0;
        totalAttempts = 0;
        updateScoreBoard();
        initVisualQuiz(true);
    }

    /* --- 4. Extended Practice Logic (True/False) --- */
    function checkTF(btn, isCorrect, explanation) {
        const parent = btn.parentElement;
        const feedbackDiv = parent.nextElementSibling; // .tf-feedback
        
        // Reset buttons style in this group
        parent.querySelectorAll('button').forEach(b => {
            b.classList.remove('btn-success', 'btn-danger');
            b.classList.add('btn-outline');
        });

        if (isCorrect) {
            btn.classList.remove('btn-outline');
            btn.classList.add('btn-success');
            feedbackDiv.innerHTML = `<span style="color:var(--secondary); font-weight:bold;">â­• æ­£ç¢ºï¼</span> ${explanation}`;
        } else {
            btn.classList.remove('btn-outline');
            btn.classList.add('btn-danger');
            feedbackDiv.innerHTML = `<span style="color:var(--danger); font-weight:bold;">âŒ éŒ¯èª¤ï¼</span> ${explanation}`;
        }
    }

    // Init on load
    window.onload = function() {
        renderGlossary();
        initVisualQuiz(true); // Randomize initially
    };

</script>
</body>
</html>