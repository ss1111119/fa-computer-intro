<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¤‡é¸é¡Œ 43ï¼šäºŒé€²ä½éè² æ•´æ•¸è¡¨ç¤ºç³»çµ± - äº’å‹•å¼è¬›ç¾©</title>
    <style>
        /* --- å…¨åŸŸè¨­å®š --- */
        :root {
            --primary-color: #2c3e50; /* æ·±è—ï¼šå°ˆæ¥­æ„Ÿ */
            --accent-color: #e67e22;  /* æ©˜è‰²ï¼šé‡é» */
            --correct-color: #27ae60; /* ç¶ è‰²ï¼šæ­£ç¢º */
            --error-color: #c0392b;   /* ç´…è‰²ï¼šéŒ¯èª¤ */
            --bg-color: #f4f6f7;      /* æ·ºç°èƒŒæ™¯ */
            --card-bg: #ffffff;
        }

        body {
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
            background-color: var(--bg-color);
            color: #333;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* --- æ¨™é¡Œå€ --- */
        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 20px;
        }

        h1 {
            color: var(--primary-color);
            margin: 0;
            font-size: 2.2rem;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
            margin-top: 10px;
        }

        /* --- é€šç”¨å¡ç‰‡æ¨£å¼ --- */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-left: 5px solid var(--primary-color);
        }

        h2 {
            color: var(--primary-color);
            border-bottom: 2px dashed #bdc3c7;
            padding-bottom: 10px;
            margin-top: 0;
        }

        h3 {
            color: var(--accent-color);
            margin-bottom: 10px;
        }

        /* --- å°ˆæœ‰åè© --- */
        .term {
            background-color: #ecf0f1;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
            color: #2980b9;
        }

        /* --- é‡é»å£è¨£ --- */
        .highlight-box {
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: bold;
            text-align: center;
            font-size: 1.2rem;
        }

        /* --- äº’å‹•å€ï¼šæ»‘æ¡¿ --- */
        .slider-container {
            background: #e8f6f3;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        input[type="range"] {
            width: 80%;
            margin: 15px 0;
            cursor: pointer;
        }

        .slider-result {
            font-size: 1.5rem;
            color: var(--primary-color);
            font-weight: bold;
        }

        /* --- äº’å‹•å€ï¼šäºŒé€²ä½è½‰æ› --- */
        .converter-box {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        input[type="text"] {
            padding: 10px;
            font-size: 1.1rem;
            border: 2px solid #bdc3c7;
            border-radius: 6px;
            flex: 1;
        }

        button {
            padding: 10px 20px;
            font-size: 1rem;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s;
        }

        button:hover {
            background-color: #34495e;
        }

        .calc-steps {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            color: #555;
            white-space: pre-wrap;
        }

        /* --- é¡Œç›®å€ --- */
        .question-box {
            background-color: #fff;
            border: 2px solid var(--primary-color);
            padding: 20px;
            border-radius: 10px;
            position: relative;
        }

        .question-tag {
            position: absolute;
            top: -15px;
            left: 20px;
            background: var(--accent-color);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .options-list {
            list-style: none;
            padding: 0;
        }

        .option-item {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            align-items: center;
        }

        .option-item:hover {
            background-color: #f1f1f1;
        }

        .option-item input {
            margin-right: 15px;
            transform: scale(1.5);
            cursor: pointer;
        }

        .feedback-area {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none; /* é è¨­éš±è— */
            font-weight: bold;
        }

        .feedback-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* --- è§£æèˆ‡é™·é˜± --- */
        .analysis-btn {
            background-color: #95a5a6;
            margin-top: 5px;
            font-size: 0.9rem;
        }

        .analysis-content {
            display: none;
            margin-top: 10px;
            padding: 10px;
            background: #ecf0f1;
            border-left: 4px solid var(--accent-color);
        }

        .trap-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .trap-card {
            flex: 1;
            min-width: 200px;
            background: #fff;
            border: 2px solid var(--error-color);
            padding: 15px;
            border-radius: 8px;
            position: relative;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .trap-card:hover {
            transform: translateY(-5px);
        }

        .trap-card h4 {
            color: var(--error-color);
            margin-top: 0;
        }

        .trap-dismiss {
            text-align: center;
            font-size: 0.8rem;
            color: #999;
            margin-top: 10px;
            border-top: 1px solid #eee;
            padding-top: 5px;
        }

        /* --- è‡ªæˆ‘æª¢æ¸¬ --- */
        .quiz-hint {
            display: none;
            color: var(--accent-color);
            margin-top: 5px;
            font-size: 0.95rem;
        }

        /* --- é å°¾ --- */
        .footer {
            text-align: center;
            margin-top: 40px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .reset-btn {
            background-color: var(--error-color);
            margin-top: 20px;
            display: block;
            width: 100%;
        }

        /* RWD èª¿æ•´ */
        @media (max-width: 600px) {
            h1 { font-size: 1.8rem; }
            .converter-box { flex-direction: column; align-items: stretch; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>é›»è…¦æ¦‚è«–äº’å‹•è¬›ç¾©</h1>
        <div class="subtitle">å–®å…ƒï¼šè³‡æ–™è¡¨ç¤ºæ³• | ä¸»é¡Œï¼šè¤‡é¸é¡Œ 43</div>
    </header>

    <!-- 1. æ ¸å¿ƒè§€å¿µå€ -->
    <div class="card">
        <h2>ğŸ“š æ ¸å¿ƒè§€å¿µæ‡¶äººåŒ…</h2>
        <p>å„ä½åŒå­¸å¥½ï¼åœ¨è§£é¡Œå‰ï¼Œé€™ä¸‰å€‹è§€å¿µä¸€å®šè¦åˆ»åœ¨è…¦æµ·è£¡ï¼Œè€ƒè©¦ä¸€å®šæœƒè€ƒï¼š</p>
        
        <h3>åè©è§£é‡‹ï¼ˆç¬¬ä¸€æ¬¡çœ‹åˆ°è«‹èƒŒèµ·ä¾†ï¼‰</h3>
        <ul>
            <li><span class="term">äºŒé€²ä½ Binary</span>ï¼šé›»è…¦çš„ä¸–ç•Œåªæœ‰ 0 èˆ‡ 1ã€‚</li>
            <li><span class="term">ä½å…ƒ bit</span>ï¼šäºŒé€²ä½è£¡é¢çš„ä¸€å€‹æ•¸å­—ï¼ˆ0 æˆ– 1ï¼‰ï¼Œæ˜¯æœ€å°å–®ä½ã€‚</li>
            <li><span class="term">ä½å…ƒçµ„ byte</span>ï¼šç”± 8 å€‹ bit çµ„æˆï¼Œæ˜¯å„²å­˜è³‡æ–™çš„åŸºæœ¬å–®ä½ã€‚</li>
            <li><span class="term">éè² æ•´æ•¸</span>ï¼šåªæœ‰ 0 å’Œ æ­£æ•´æ•¸ï¼ˆ1, 2, 3...ï¼‰ï¼Œæ²’æœ‰è² è™Ÿå–”ï¼</li>
        </ul>

        <h3>å¿…è€ƒé‡é»</h3>
        <ol>
            <li><strong>ä½æ¬Šè§€å¿µ</strong>ï¼šäºŒé€²ä½è½‰åé€²ä½æ™‚ï¼Œå¾å³é‚Šæ•¸éä¾†ï¼Œç¬¬ 0 ä½æ˜¯ $2^0$ï¼Œç¬¬ 1 ä½æ˜¯ $2^1$ï¼Œä»¥æ­¤é¡æ¨ã€‚</li>
            <li><strong>å‰å° 0</strong>ï¼šæ•¸å­—æœ€å‰é¢çš„ 0 ä¸å½±éŸ¿å¤§å°ï¼ˆä¾‹å¦‚ï¼š$010$ è·Ÿ $10$ æ˜¯ä¸€æ¨£çš„ï¼‰ã€‚</li>
            <li><strong>æ•¸é‡å…¬å¼</strong>ï¼š$n$ å€‹ä½å…ƒå¯ä»¥è¡¨ç¤º $2^n$ å€‹ä¸åŒçš„æ•¸å€¼ã€‚</li>
        </ol>

        <div class="highlight-box">
            å£è¨£ï¼šã€Œbit æ•¸ä¸€å¤šï¼Œèƒ½è¡¨ç¤ºçš„æ•¸é‡å°±ç¿»å€ï¼ã€
        </div>
    </div>

    <!-- 2. äº’å‹•é«”é©—å€ (A) & (C) -->
    <div class="card">
        <h2>ğŸ› ï¸ è§€å¿µå¯¦é©—å®¤</h2>
        
        <h3>å¯¦é©—ä¸€ï¼šç‚ºä»€éº¼ 16 ä½å…ƒæ˜¯ 65536ï¼Ÿ</h3>
        <p>è©¦è‘—æ‹–å‹•ä¸‹é¢çš„æ»‘æ¡¿ï¼Œçœ‹çœ‹ <span class="term">ä½å…ƒæ•¸</span> å¢åŠ æ™‚ï¼Œèƒ½è¡¨ç¤ºçš„æ•¸å­—å€‹æ•¸è®Šå¤šå°‘ï¼Ÿ</p>
        <div class="slider-container">
            <label for="bitSlider">ä½å…ƒæ•¸ (n)ï¼š<span id="bitDisplay" style="font-size:1.2rem; font-weight:bold;">8</span> bits</label><br>
            <input type="range" id="bitSlider" min="1" max="16" value="8">
            <div class="slider-result">
                å¯è¡¨ç¤º $2^n$ = <span id="countDisplay">256</span> å€‹æ•¸å€¼
            </div>
            <p style="font-size: 0.9rem; color: #666;">(ç¯„åœï¼š0 ~ <span id="maxValDisplay">255</span>)</p>
        </div>

        <hr style="border-top:1px dashed #ddd; margin: 25px 0;">

        <h3>å¯¦é©—äºŒï¼šäºŒé€²ä½è½‰åé€²ä½è¨ˆç®—æ©Ÿ</h3>
        <p>è¼¸å…¥ä¸€å€‹äºŒé€²ä½æ•¸å­—ï¼ˆä¾‹å¦‚ 1000 æˆ– 010ï¼‰ï¼Œçœ‹çœ‹å®ƒæ˜¯å¤šå°‘ï¼Ÿ</p>
        <div class="converter-box">
            <input type="text" id="binaryInput" placeholder="è¼¸å…¥ 0 èˆ‡ 1 (ä¾‹: 1000)" maxlength="16">
            <button onclick="convertBinary()">è½‰æ›èˆ‡è§£æ</button>
        </div>
        <div id="calcSteps" class="calc-steps">ç­‰å¾…è¼¸å…¥...</div>
    </div>

    <!-- 3. é¡Œç›®èˆ‡ä½œç­”å€ (B) & (D) -->
    <div class="card question-box">
        <div class="question-tag">è¤‡é¸é¡Œ 43</div>
        <h3 style="margin-top: 15px;">äºŒé€²ä½çš„éè² æ•´æ•¸è¡¨ç¤ºç³»çµ±ä¸­ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿï¼ˆæœ¬é¡Œå¯è¤‡é¸ï¼‰</h3>
        
        <div class="options-list">
            <label class="option-item">
                <input type="checkbox" name="q43" value="A">
                (A) ä¸€å€‹ byte å¯ä»¥è¡¨ç¤ºçš„æœ€å¤§å€¼ç‚º 126
            </label>
            <label class="option-item">
                <input type="checkbox" name="q43" value="B">
                (B) 1000 è¡¨ç¤ºåé€²ä½å€¼ç‚º 8
            </label>
            <label class="option-item">
                <input type="checkbox" name="q43" value="C">
                (C) åé€²ä½çš„ -1 ä»¥ 1111 è¡¨ç¤º
            </label>
            <label class="option-item">
                <input type="checkbox" name="q43" value="D">
                (D) 010 èˆ‡ 10 æ‰€è¡¨ç¤ºçš„åé€²ä½æ•¸å€¼ç›¸åŒ
            </label>
            <label class="option-item">
                <input type="checkbox" name="q43" value="E">
                (E) 16 ä½å…ƒèƒ½å¤ è¡¨ç¤ºçš„æ•´æ•¸å€‹æ•¸æœ‰ 65536
            </label>
        </div>

        <button onclick="checkAnswer()" style="width: 100%; margin-top: 10px; font-size: 1.2rem;">é€å‡ºç­”æ¡ˆ</button>
        <button onclick="resetAll()" class="reset-btn">é‡ç½®é¡Œç›®èˆ‡äº’å‹•</button>

        <div id="feedback" class="feedback-area"></div>
    </div>

    <!-- 4. è©³ç´°è§£æå€ (D) -->
    <div class="card">
        <h2>ğŸ” é¸é …é€ä¸€ç ´è§£</h2>
        <p>é»æ“Šä¸‹æ–¹æŒ‰éˆ•æŸ¥çœ‹è©³ç´°è§£æï¼š</p>

        <div style="margin-bottom: 15px;">
            <button class="analysis-btn" onclick="toggleAnalysis('analysisA')">(A) byte æœ€å¤§å€¼ 126ï¼Ÿ</button>
            <div id="analysisA" class="analysis-content">
                <strong>âŒ éŒ¯èª¤</strong><br>
                1 byte = 8 bitsã€‚<br>
                æœ€å¤§å€¼å…¬å¼ç‚º $2^n - 1$ã€‚<br>
                $2^8 - 1 = 256 - 1 = \mathbf{255}$ã€‚<br>
                126 æ˜¯éŒ¯çš„é›¢è­œå–”ï¼
            </div>
        </div>

        <div style="margin-bottom: 15px;">
            <button class="analysis-btn" onclick="toggleAnalysis('analysisB')">(B) 1000 æ˜¯ 8ï¼Ÿ</button>
            <div id="analysisB" class="analysis-content" style="border-color: var(--correct-color);">
                <strong>âœ… æ­£ç¢º</strong><br>
                $1000_2 = 1 \times 2^3 + 0 + 0 + 0 = 8$ã€‚<br>
                è¨˜å¾—ï¼šç¬¬ 4 ä½å°±æ˜¯ $2^3=8$ã€‚
            </div>
        </div>

        <div style="margin-bottom: 15px;">
            <button class="analysis-btn" onclick="toggleAnalysis('analysisC')">(C) -1 æ˜¯ 1111ï¼Ÿ</button>
            <div id="analysisC" class="analysis-content">
                <strong>âŒ éŒ¯èª¤</strong><br>
                é¡Œç›®ç¬¬ä¸€å¥èªªä»€éº¼ï¼Ÿ<strong>ã€Œéè² æ•´æ•¸ã€</strong>ï¼<br>
                æ‰€ä»¥åœ¨é€™å€‹ç³»çµ±è£¡ï¼Œæ ¹æœ¬æ²’æœ‰è² æ•¸çš„å­˜åœ¨ã€‚<br>
                (å¦‚æœæ˜¯ã€ŒäºŒè£œæ•¸ã€ç³»çµ±ï¼Œ1111 (4 bit) æ‰æ˜¯ -1ï¼Œä½†é€™è£¡ä¸æ˜¯ã€‚)
            </div>
        </div>

        <div style="margin-bottom: 15px;">
            <button class="analysis-btn" onclick="toggleAnalysis('analysisD')">(D) 010 èˆ‡ 10 ç›¸åŒï¼Ÿ</button>
            <div id="analysisD" class="analysis-content" style="border-color: var(--correct-color);">
                <strong>âœ… æ­£ç¢º</strong><br>
                å°±åƒåé€²ä½çš„ 050 å°±æ˜¯ 50 ä¸€æ¨£ã€‚<br>
                å‰é¢çš„ 0 å«åšã€Œå‰å° 0ã€ï¼Œä¸å½±éŸ¿æ•¸å€¼å¤§å°ï¼Œåªæ˜¯ç”¨ä¾†è£œé½Šä½æ•¸å¥½çœ‹è€Œå·²ã€‚
            </div>
        </div>

        <div style="margin-bottom: 15px;">
            <button class="analysis-btn" onclick="toggleAnalysis('analysisE')">(E) 16 bits æœ‰ 65536 å€‹æ•´æ•¸ï¼Ÿ</button>
            <div id="analysisE" class="analysis-content" style="border-color: var(--correct-color);">
                <strong>âœ… æ­£ç¢º</strong><br>
                æ ¹æ“šå…¬å¼ï¼š$n$ ä½å…ƒæœ‰ $2^n$ å€‹çµ„åˆã€‚<br>
                $2^{16} = 65536$ã€‚<br>
                (ç¯„åœæ˜¯ 0 ~ 65535ï¼Œç¸½å…± 65536 å€‹æ•¸)ã€‚
            </div>
        </div>
    </div>

    <!-- 5. é™·é˜±å¡ (E) -->
    <div class="card">
        <h2>âš ï¸ è€ƒè©¦é™·é˜±å¡ï¼ˆé»æ“Šæ¶ˆé™¤ï¼‰</h2>
        <p>é€™äº›éƒ½æ˜¯å­¸é•·å§æœ€å®¹æ˜“éŒ¯çš„åœ°æ–¹ï¼Œçœ‹æ‡‚äº†å°±é»ä¸€ä¸‹æŠŠå®ƒæ¶ˆæ‰ï¼</p>
        <div class="trap-container">
            <div class="trap-card" onclick="dismissTrap(this)">
                <h4>é™·é˜± 1ï¼šByte å®šç¾©ä¸æ¸…</h4>
                <p>å¾ˆå¤šäººä»¥ç‚º 1 byte æ˜¯ 7 bit æˆ– 10 bitã€‚</p>
                <p><strong>æ­£è§£ï¼š</strong>1 byte éµå®šæ˜¯ <strong>8 bits</strong>ã€‚</p>
                <div class="trap-dismiss">é»æ“Šè¡¨ç¤ºæˆ‘æ‡‚äº†</div>
            </div>
            <div class="trap-card" onclick="dismissTrap(this)">
                <h4>é™·é˜± 2ï¼šçœ‹åˆ° 1111 å°±æƒ³å¡« -1</h4>
                <p>é¡Œç›®æ²’çœ‹æ¸…æ¥šã€Œéè² æ•´æ•¸ã€å°±ç”¨äºŒè£œæ•¸å»è§£ã€‚</p>
                <p><strong>æ­£è§£ï¼š</strong>éè² ç³»çµ±ä¸­ï¼Œ1111 å°±æ˜¯ $8+4+2+1 = 15$ã€‚</p>
                <div class="trap-dismiss">é»æ“Šè¡¨ç¤ºæˆ‘æ‡‚äº†</div>
            </div>
            <div class="trap-card" onclick="dismissTrap(this)">
                <h4>é™·é˜± 3ï¼šè¢«å‰å° 0 åš‡åˆ°</h4>
                <p>ä»¥ç‚º 010 æ˜¯ä¸€ç¨®ç‰¹æ®Šç·¨ç¢¼ã€‚</p>
                <p><strong>æ­£è§£ï¼š</strong>å®ƒå°±æ˜¯ 10ï¼Œä¹Ÿå°±æ˜¯åé€²ä½çš„ 2ã€‚</p>
                <div class="trap-dismiss">é»æ“Šè¡¨ç¤ºæˆ‘æ‡‚äº†</div>
            </div>
        </div>
    </div>

    <!-- 6. è‡ªæˆ‘æª¢æ¸¬ (F) -->
    <div class="card">
        <h2>ğŸ§ è‡ªæˆ‘æª¢æ¸¬</h2>
        <p>ä¸çµ¦ä½ ç›´æ¥ç­”æ¡ˆï¼Œè©¦è‘—æƒ³ä¸€æƒ³ï¼Œéœ€è¦å¹«å¿™è«‹é»ã€Œæç¤ºã€ã€‚</p>
        
        <div style="margin-bottom: 20px;">
            <strong>Q1. 8 ä½å…ƒèƒ½è¡¨ç¤ºå¤šå°‘å€‹æ•´æ•¸ï¼Ÿ</strong><br>
            <button onclick="toggleHint('hint1')" style="padding: 5px 10px; font-size: 0.8rem; background: #95a5a6;">é¡¯ç¤ºæç¤º</button>
            <div id="hint1" class="quiz-hint">æç¤ºï¼šå¥—å…¬å¼ $2^n$ï¼Œæ‰€ä»¥æ˜¯ $2^8 = ?$</div>
        </div>

        <div style="margin-bottom: 20px;">
            <strong>Q2. ç‚ºä»€éº¼ $n$ ä½å…ƒæœ€å¤§å€¼æ˜¯ $2^n - 1$ï¼Ÿ</strong><br>
            <button onclick="toggleHint('hint2')" style="padding: 5px 10px; font-size: 0.8rem; background: #95a5a6;">é¡¯ç¤ºæç¤º</button>
            <div id="hint2" class="quiz-hint">æç¤ºï¼šå› ç‚ºæˆ‘å€‘æ˜¯å¾ 0 é–‹å§‹æ•¸çš„ï¼å‡è¨­æœ‰ 4 å€‹è˜‹æœ(0,1,2,3)ï¼Œæœ€å¤§ç·¨è™Ÿæ˜¯ 3 (ä¹Ÿå°±æ˜¯ 4-1)ã€‚</div>
        </div>
        
        <div>
            <strong>Q3. å¦‚æœé¡Œç›®æ”¹æˆã€Œå«è² æ•¸ã€(äºŒè£œæ•¸ç³»çµ±)ï¼Œé¸é …(C)æœƒè®Šå°å—ï¼Ÿ</strong><br>
            <button onclick="toggleHint('hint3')" style="padding: 5px 10px; font-size: 0.8rem; background: #95a5a6;">é¡¯ç¤ºæç¤º</button>
            <div id="hint3" class="quiz-hint">æç¤ºï¼šæ˜¯çš„ï¼åœ¨ 4 ä½å…ƒäºŒè£œæ•¸ç³»çµ±ä¸­ï¼Œ1111 ä»£è¡¨ -1ã€‚ä½†åœ¨é€™é¡Œã€Œéè² æ•´æ•¸ã€ç³»çµ±ä¸­ï¼Œå®ƒæ˜¯ 15ã€‚</div>
        </div>
    </div>

    <div class="footer">
        &copy; é›»è…¦æ¦‚è«–äº’å‹•è¬›ç¾© | è¤‡é¸é¡Œ 43 | Designed for Learning
    </div>
</div>

<script>
    /* --- 1. æ»‘æ¡¿äº’å‹•é‚è¼¯ --- */
    const slider = document.getElementById('bitSlider');
    const bitDisplay = document.getElementById('bitDisplay');
    const countDisplay = document.getElementById('countDisplay');
    const maxValDisplay = document.getElementById('maxValDisplay');

    function updateSlider() {
        const n = parseInt(slider.value);
        const count = Math.pow(2, n);
        
        bitDisplay.textContent = n;
        countDisplay.textContent = count.toLocaleString(); // åŠ åƒåˆ†ä½é€—è™Ÿ
        maxValDisplay.textContent = (count - 1).toLocaleString();
    }

    slider.addEventListener('input', updateSlider);

    /* --- 2. äºŒé€²ä½è½‰æ›é‚è¼¯ --- */
    function convertBinary() {
        const input = document.getElementById('binaryInput').value.trim();
        const stepsDiv = document.getElementById('calcSteps');

        // é˜²å‘†ï¼šæª¢æŸ¥æ˜¯å¦ç‚ºç©ºæˆ–åŒ…å«é 0/1 å­—å…ƒ
        if (!input || !/^[01]+$/.test(input)) {
            stepsDiv.innerHTML = "<span style='color:red;'>âš ï¸ è«‹è¼¸å…¥æœ‰æ•ˆçš„äºŒé€²ä½æ•¸å­—ï¼ˆåªèƒ½åŒ…å« 0 èˆ‡ 1ï¼‰ï¼</span>";
            return;
        }

        const len = input.length;
        let decimalValue = 0;
        let stepString = "";

        // è¨ˆç®—éç¨‹
        stepString += `äºŒé€²ä½ <strong style="font-size:1.2rem">${input}</strong> è½‰æ›éç¨‹ï¼š\n\n`;

        for (let i = 0; i < len; i++) {
            const bit = parseInt(input[i]);
            const power = len - 1 - i;
            const val = bit * Math.pow(2, power);
            
            decimalValue += val;

            // çµ„åˆç®—å¼å­—ä¸²
            if (i > 0) stepString += " + ";
            stepString += `${bit}Ã—2<sup>${power}</sup>`;
        }

        stepString += `\n= ${decimalValue}`;
        stepString += `\n\nçµæœï¼šåé€²ä½ <strong style="font-size:1.2rem; color:var(--primary-color);">${decimalValue}</strong>`;

        stepsDiv.innerHTML = stepString;
    }

    /* --- 3. è¤‡é¸é¡Œä½œç­”é‚è¼¯ --- */
    function checkAnswer() {
        // å–å¾—æ‰€æœ‰å‹¾é¸çš„é¸é …
        const checkboxes = document.querySelectorAll('input[name="q43"]:checked');
        const userAnswers = Array.from(checkboxes).map(cb => cb.value).sort();
        const feedback = document.getElementById('feedback');
        
        // æ­£ç¢ºç­”æ¡ˆ
        const correctAnswers = ["B", "D", "E"];

        // æ¯”å°é‚è¼¯
        const isCorrect = JSON.stringify(userAnswers) === JSON.stringify(correctAnswers);

        feedback.style.display = "block";
        feedback.className = "feedback-area"; // é‡ç½® class

        if (isCorrect) {
            feedback.classList.add("feedback-success");
            feedback.innerHTML = "ğŸ‰ <strong>å®Œå…¨æ­£ç¢ºï¼å¤ªæ£’äº†ï¼</strong><br>ä½ å·²ç¶“å®Œå…¨æŒæ¡äº†äºŒé€²ä½èˆ‡éè² æ•´æ•¸çš„è§€å¿µã€‚";
        } else {
            feedback.classList.add("feedback-error");
            let msg = "ğŸ¤” <strong>æœ‰é»å¯æƒœï¼Œå†æƒ³ä¸€ä¸‹ï¼š</strong><br>";
            
            if (userAnswers.length === 0) {
                msg += "ä½ é‚„æ²’å‹¾é¸ä»»ä½•ç­”æ¡ˆå–”ï¼<br>";
            } else {
                // æª¢æŸ¥æ˜¯å¦é¸äº† A æˆ– C (çµ•å°éŒ¯èª¤)
                if (userAnswers.includes("A")) msg += "- é¸é … (A) ä¸å°å–”ï¼Œ1 byte æœ€å¤§ä¸åª 126ã€‚<br>";
                if (userAnswers.includes("C")) msg += "- é¸é … (C) ä¸å°å–”ï¼Œé¡Œç›®èªªã€Œéè² æ•´æ•¸ã€ï¼Œä¸èƒ½æœ‰è² è™Ÿã€‚<br>";
                
                // æª¢æŸ¥æ˜¯å¦æ¼é¸
                const missing = correctAnswers.filter(x => !userAnswers.includes(x));
                if (missing.length > 0) {
                    msg += `- ä½ å¥½åƒæ¼æ‰äº† ${missing.join(", ")} é¸é …ã€‚<br>`;
                }
            }
            msg += "<br>ğŸ’¡ <strong>æç¤ºï¼š</strong>è«‹å¾€ä¸‹æ»‘çœ‹ã€Œé¸é …é€ä¸€ç ´è§£ã€æˆ–ç”¨ä¸Šæ–¹çš„è½‰æ›å™¨æª¢æŸ¥ä¸€ä¸‹ã€‚";
            feedback.innerHTML = msg;
        }
    }

    /* --- 4. è§£æé¡¯ç¤º --- */
    function toggleAnalysis(id) {
        const el = document.getElementById(id);
        if (el.style.display === "block") {
            el.style.display = "none";
        } else {
            el.style.display = "block";
        }
    }

    /* --- 5. é™·é˜±å¡æ¶ˆé™¤ --- */
    function dismissTrap(element) {
        element.style.transition = "opacity 0.5s, transform 0.5s";
        element.style.opacity = "0";
        element.style.transform = "scale(0.8)";
        setTimeout(() => {
            element.style.display = "none";
        }, 500);
    }

    /* --- 6. æç¤ºé¡¯ç¤º --- */
    function toggleHint(id) {
        const el = document.getElementById(id);
        el.style.display = (el.style.display === "block") ? "none" : "block";
    }

    /* --- 7. å…¨åŸŸé‡ç½® --- */
    function resetAll() {
        // é‡ç½® Checkbox
        document.querySelectorAll('input[name="q43"]').forEach(cb => cb.checked = false);
        document.getElementById('feedback').style.display = 'none';

        // é‡ç½®è½‰æ›å™¨
        document.getElementById('binaryInput').value = '';
        document.getElementById('calcSteps').textContent = 'ç­‰å¾…è¼¸å…¥...';

        // é‡ç½®æ»‘æ¡¿
        slider.value = 8;
        updateSlider();

        // é‡ç½®è§£æé¡¯ç¤º
        document.querySelectorAll('.analysis-content').forEach(el => el.style.display = 'none');
        document.querySelectorAll('.quiz-hint').forEach(el => el.style.display = 'none');
        
        // é‡ç½®é™·é˜±å¡ (å¦‚æœè¢«æ¶ˆé™¤äº†ï¼Œè¦å«å›ä¾†)
        document.querySelectorAll('.trap-card').forEach(el => {
            el.style.display = 'block';
            setTimeout(() => {
                el.style.opacity = '1';
                el.style.transform = 'scale(1)';
            }, 10);
        });

        alert("å·²é‡ç½®æ‰€æœ‰å…§å®¹ï¼");
    }

    // åˆå§‹åŒ–æ»‘æ¡¿æ•¸å€¼
    updateSlider();

</script>

</body>
</html>