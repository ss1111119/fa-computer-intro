<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›»è…¦æ¦‚è«– - å®šå€æ¨¡å¼ (Addressing Modes) è§£æ</title>
    <style>
        /* --- åŸºç¤è¨­å®š (Reset & Base) --- */
        :root {
            --primary-color: #2c3e50;
            --accent-color: #3498db;
            --highlight-bg: #fff9c4; /* è¢å…‰ç­†é»ƒ */
            --correct-color: #27ae60;
            --wrong-color: #c0392b;
            --bg-color: #f4f6f7;
            --card-bg: #ffffff;
            --text-color: #333;
            --border-radius: 8px;
            --sim-highlight: #ffeb3b;
            --sim-active: #ff5722;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: "Noto Sans TC", "Microsoft JhengHei", -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }

        h1, h2, h3 {
            color: var(--primary-color);
            margin-top: 0;
        }

        /* --- ç‰ˆé¢å®¹å™¨ --- */
        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        /* --- å¡ç‰‡æ¨£å¼ --- */
        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid var(--accent-color);
        }

        .card.question-card {
            border-left-color: var(--primary-color);
        }

        .card.sim-card {
            border-left-color: #e67e22;
        }

        /* --- è¢å…‰ç­†ç‰¹æ•ˆ --- */
        .highlight {
            background-color: var(--highlight-bg);
            padding: 0 4px;
            border-radius: 2px;
            font-weight: bold;
        }

        /* --- æ¨™ç±¤èˆ‡å¾½ç«  --- */
        .badge {
            display: inline-block;
            background: var(--primary-color);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            margin-right: 5px;
        }

        /* --- é¡Œç›®æ¨£å¼ --- */
        .question-box {
            font-size: 1.1em;
            font-weight: 500;
            margin-bottom: 15px;
            white-space: pre-wrap; /* ä¿ç•™åŸå§‹æ›è¡Œ */
        }

        .options-list {
            list-style: none;
            padding: 0;
        }

        .options-list li {
            margin-bottom: 8px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .options-list li:hover {
            background: #e9ecef;
        }

        /* --- äº’å‹•æ¨¡æ“¬å™¨å€åŸŸ (Theatrical Mode) --- */
        .sim-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            background: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 8px;
        }

        .sim-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .sim-btn {
            background: #34495e;
            color: white;
            border: 1px solid #7f8c8d;
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .sim-btn:hover {
            background: #bdc3c7;
            color: #2c3e50;
        }

        .sim-btn.active {
            background: #e67e22;
            border-color: #d35400;
            font-weight: bold;
        }

        .sim-display {
            display: flex;
            gap: 20px;
            justify-content: space-around;
            align-items: flex-start;
            min-height: 200px;
        }

        /* CPU å€å¡Š */
        .cpu-box {
            border: 2px solid #bdc3c7;
            padding: 10px;
            border-radius: 4px;
            width: 45%;
        }

        /* è¨˜æ†¶é«”å€å¡Š */
        .mem-box {
            border: 2px solid #bdc3c7;
            padding: 10px;
            border-radius: 4px;
            width: 45%;
        }

        .reg-item, .mem-item {
            display: flex;
            justify-content: space-between;
            padding: 5px;
            border-bottom: 1px solid #7f8c8d;
            font-family: monospace;
        }

        .mem-item.active-read {
            background-color: var(--sim-active);
            color: white;
            animation: blink 0.5s 2;
        }

        .mem-item.target-data {
            background-color: var(--sim-highlight);
            color: black;
            font-weight: bold;
        }

        .sim-info {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 4px;
            font-size: 0.9em;
            min-height: 60px;
            border-left: 4px solid #e67e22;
        }

        /* --- äº’å‹•æ¸¬é©—å€ --- */
        .quiz-option {
            display: block;
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }

        .quiz-option input {
            margin-right: 10px;
        }

        .quiz-feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 4px;
            display: none;
        }

        .quiz-feedback.correct {
            background: #d4edda;
            color: #155724;
            display: block;
        }

        .quiz-feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            display: block;
        }

        /* --- é€šç”¨æŒ‰éˆ• --- */
        .btn-action {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 10px;
        }

        .btn-action:hover {
            background-color: #2980b9;
        }

        .hidden-content {
            display: none;
        }

        /* --- å‹•ç•« --- */
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* --- RWD --- */
        @media (max-width: 600px) {
            .sim-display {
                flex-direction: column;
            }
            .cpu-box, .mem-box {
                width: 100%;
            }
        }
    </style>
</head>
<body>

<div class="container">

    <!-- A. æ¨™é¡Œå€ -->
    <header style="text-align: center; margin-bottom: 30px;">
        <h1>é›»è…¦æ¦‚è«–ï¼šCPU èˆ‡è¨˜æ†¶é«”</h1>
        <p style="color: #666;">ä¸»é¡Œï¼šå®šå€æ¨¡å¼è¾¨è­˜ (Addressing Modes)</p>
    </header>

    <!-- B. é¡Œç›®å€ -->
    <div class="card question-card">
        <div class="badge">é¡Œè™Ÿ 45</div> <div class="badge" style="background:#e67e22">è¤‡é¸é¡Œ</div>
        <div class="question-box">
45. ä¸‹åˆ—ä½•è€…ç‚ºè¨˜æ†¶é«”å®šå€çš„æ¨¡å¼?
(A) éš¨æ©Ÿå®šå€
(B) æš«å­˜å™¨å®šå€
(C) ç›¸å°å®šå€
(D) ç›´æ¥å®šå€
(E) é–“æ¥å®šå€
        </div>
        <button class="btn-action" onclick="toggleAnswer()">é¡¯ç¤º/éš±è— ç­”æ¡ˆ</button>
        <div id="answer-key" class="hidden-content" style="margin-top: 15px; font-weight: bold; color: var(--correct-color);">
            ç­”æ¡ˆï¼šB, C, D, E
        </div>
    </div>

    <!-- C. æ‰¾é—œéµå­— -->
    <div class="card">
        <h3>ç¬¬ä¸€æ­¥ï¼šæ‰¾é—œéµå­— ğŸ”</h3>
        <p>é¡Œç›®å•çš„æ˜¯ï¼š<span class="highlight">è¨˜æ†¶é«”å®šå€</span>çš„<span class="highlight">æ¨¡å¼</span>ã€‚</p>
        <p><strong>ç¿»è­¯ï¼š</strong>é¡Œç›®åœ¨è€ƒ CPU çš„æŒ‡ä»¤ç³»çµ±ä¸­ï¼Œæ˜¯ç”¨ä»€éº¼è¦å‰‡å»ã€Œæè¿°è³‡æ–™åœ¨å“ªè£¡ã€ã€‚</p>
    </div>

    <!-- D. ç™½è©±ç¿»è­¯ -->
    <div class="card">
        <h3>ç¬¬äºŒæ­¥ï¼šç™½è©±ç¿»è­¯ ğŸ—£ï¸</h3>
        <p>æƒ³åƒ CPU æ˜¯å€‹è·‘è…¿å°å¼Ÿï¼Œä½ è¦å«ä»–å»æ‹¿æ±è¥¿ï¼ˆè³‡æ–™ï¼‰ï¼Œä½ å¯ä»¥æ€éº¼å‘Šè¨´ä»–æ±è¥¿åœ¨å“ªï¼Ÿ</p>
        <ul>
            <li><strong>ç›´æ¥çµ¦åœ°å€ï¼š</strong>ã€Œå» 100 è™Ÿæˆ¿æ‹¿ã€‚ã€(ç›´æ¥å®šå€)</li>
            <li><strong>çµ¦æç¤ºè®“ä»–ç®—ï¼š</strong>ã€Œå¾ç¾åœ¨çš„ä½ç½®å¾€å‰èµ° 3 é–“ã€‚ã€(ç›¸å°å®šå€)</li>
            <li><strong>æ±è¥¿å·²ç¶“åœ¨ä»–èº«ä¸Šï¼š</strong>ã€Œå°±åœ¨ä½ å£è¢‹è£¡ã€‚ã€(æš«å­˜å™¨å®šå€)</li>
            <li><strong>çµ¦è—å¯¶åœ–ï¼š</strong>ã€Œå» 100 è™Ÿæˆ¿ï¼Œé‚£é‚Šæœ‰å¯«çœŸæ­£çš„åœ°å€ã€‚ã€(é–“æ¥å®šå€)</li>
        </ul>
    </div>

    <!-- F. äº’å‹•æ ¸å¿ƒï¼šå®šå€æ¨¡å¼å°åŠ‡å ´ -->
    <div class="card sim-card">
        <h3>ğŸ’¡ äº’å‹•åœ–è§£ï¼šå››ç¨®å®šå€æ¨¡å¼å°åŠ‡å ´</h3>
        <p>è«‹é»æ“Šä¸‹æ–¹æŒ‰éˆ•ï¼Œè§€å¯Ÿ CPU å¦‚ä½•æ‰¾åˆ°è³‡æ–™ï¼ˆDataï¼‰ã€‚</p>
        
        <div class="sim-container">
            <div class="sim-controls">
                <button class="sim-btn" onclick="runSim('Register')">æš«å­˜å™¨å®šå€ (Register)</button>
                <button class="sim-btn" onclick="runSim('Direct')">ç›´æ¥å®šå€ (Direct)</button>
                <button class="sim-btn" onclick="runSim('Indirect')">é–“æ¥å®šå€ (Indirect)</button>
                <button class="sim-btn" onclick="runSim('Relative')">ç›¸å°å®šå€ (Relative)</button>
            </div>

            <div class="sim-info" id="sim-status">
                è«‹é¸æ“‡ä¸€ç¨®æ¨¡å¼é–‹å§‹æ¨¡æ“¬...
            </div>

            <div class="sim-display">
                <!-- CPU å…§éƒ¨ -->
                <div class="cpu-box">
                    <div style="text-align:center; border-bottom:1px solid #fff; margin-bottom:5px;">CPU æš«å­˜å™¨</div>
                    <div class="reg-item" id="reg-pc"><span>PC (ç¨‹å¼è¨ˆæ•¸å™¨)</span> <span>100</span></div>
                    <div class="reg-item" id="reg-r1"><span>R1 (é€šç”¨æš«å­˜å™¨)</span> <span>DATA_55</span></div>
                    <div class="reg-item" id="reg-ir"><span>IR (æŒ‡ä»¤)</span> <span id="val-ir">---</span></div>
                </div>

                <!-- è¨˜æ†¶é«” -->
                <div class="mem-box">
                    <div style="text-align:center; border-bottom:1px solid #fff; margin-bottom:5px;">ä¸»è¨˜æ†¶é«” (RAM)</div>
                    <div class="mem-item" id="mem-100"><small>100</small> <span>LOAD ...</span></div>
                    <div class="mem-item" id="mem-101"><small>101</small> <span>...</span></div>
                    <div class="mem-item" id="mem-102"><small>102</small> <span>DATA_99</span></div>
                    <div class="mem-item" id="mem-103"><small>103</small> <span>ADDR_102</span></div>
                    <div class="mem-item" id="mem-104"><small>104</small> <span>...</span></div>
                </div>
            </div>
            
            <div id="sim-result" style="text-align: center; font-weight: bold; color: #ffeb3b;"></div>
        </div>
    </div>

    <!-- G. æœ‰æ•ˆä½å€è¨ˆç®— -->
    <div class="card">
        <h3>ç¬¬ä¸‰æ­¥ï¼šé—œéµå…¬å¼èˆ‡è§€å¿µ ğŸ§®</h3>
        <p><strong>Effective Address (EAï¼Œæœ‰æ•ˆä½å€)</strong>ï¼šCPU çœŸæ­£è¦å»è®€å¯«è³‡æ–™çš„è¨˜æ†¶é«”åœ°å€ã€‚</p>
        <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; border-left: 4px solid var(--primary-color);">
            <p><strong>ç›¸å°å®šå€ (Relative Addressing) è¨ˆç®—ç¯„ä¾‹ï¼š</strong></p>
            <p><code>EA = Base + Offset</code></p>
            <ul>
                <li><strong>Base (åŸºæº–)ï¼š</strong> é€šå¸¸æ˜¯ PC (ç¨‹å¼è¨ˆæ•¸å™¨) æˆ– Base Registerã€‚</li>
                <li><strong>Offset (ä½ç§»)ï¼š</strong> æŒ‡ä»¤ä¸­çµ¦çš„æ•¸å­— (ä¾‹å¦‚ +2)ã€‚</li>
                <li><strong>æƒ…å¢ƒï¼š</strong>è‹¥ PC=100ï¼ŒæŒ‡ä»¤èªª Offset=2ï¼Œå‰‡ EA = 100 + 2 = 102ã€‚CPU æœƒå» 102 æŠ“è³‡æ–™ã€‚</li>
            </ul>
        </div>
    </div>

    <!-- H. é¸é …åˆ†æ -->
    <div class="card">
        <h3>ç¬¬å››æ­¥ï¼šé¸é …é€ä¸€åˆ†æ âœ…âŒ</h3>
        <ul class="options-list">
            <li>
                <strong>(A) éš¨æ©Ÿå®šå€ (Random Addressing)</strong> <span style="color:red">âŒ éŒ¯èª¤</span>
                <br>
                <small>é€šå¸¸æŒ‡ã€Œéš¨æ©Ÿå­˜å–è¨˜æ†¶é«” (Random Access Memory, RAM)ã€ï¼Œæ˜¯æŒ‡ã€Œå­˜å–ä»»ä½•ä½ç½®æ™‚é–“ç›¸åŒã€çš„ç‰¹æ€§ï¼Œä¸¦é CPU è¨ˆç®—åœ°å€çš„æ¨¡å¼ã€‚é€™æ˜¯å…¸å‹çš„å¹²æ“¾é¸é …ã€‚</small>
            </li>
            <li>
                <strong>(B) æš«å­˜å™¨å®šå€ (Register Addressing)</strong> <span style="color:green">âœ… æ­£ç¢º</span>
                <br>
                <small>æŒ‡ä»¤ç›´æ¥æŒ‡å®šæš«å­˜å™¨åç¨± (å¦‚ R1, AX)ã€‚è³‡æ–™å°±åœ¨ CPU å…§éƒ¨ï¼Œé€Ÿåº¦æœ€å¿«ï¼Œä¸éœ€è¦å»è¨˜æ†¶é«”æ‰¾ã€‚</small>
            </li>
            <li>
                <strong>(C) ç›¸å°å®šå€ (Relative Addressing)</strong> <span style="color:green">âœ… æ­£ç¢º</span>
                <br>
                <small>ä»¥ç›®å‰ä½ç½® (PC) ç‚ºåŸºæº–ï¼ŒåŠ ä¸Šä½ç§»é‡ (Offset)ã€‚å¸¸ç”¨æ–¼ç¨‹å¼è·³è½‰ (Jump) æˆ–è¿´åœˆã€‚</small>
            </li>
            <li>
                <strong>(D) ç›´æ¥å®šå€ (Direct Addressing)</strong> <span style="color:green">âœ… æ­£ç¢º</span>
                <br>
                <small>æŒ‡ä»¤ä¸­ç›´æ¥çµ¦å‡ºå®Œæ•´çš„è¨˜æ†¶é«”åœ°å€ (ä¾‹å¦‚ [1000])ã€‚ç›´è§€ä½†ç¼ºä¹å½ˆæ€§ã€‚</small>
            </li>
            <li>
                <strong>(E) é–“æ¥å®šå€ (Indirect Addressing)</strong> <span style="color:green">âœ… æ­£ç¢º</span>
                <br>
                <small>æŒ‡ä»¤çµ¦çš„æ˜¯ã€Œå­˜æ”¾åœ°å€çš„åœ°å€ã€ã€‚åƒæŸ¥é›»è©±ç°¿ï¼šå…ˆæŸ¥åå­—(åœ°å€A)ï¼Œå¾—åˆ°é›»è©±(åœ°å€B)ï¼Œå†æ’¥æ‰“é›»è©±(æ‹¿è³‡æ–™)ã€‚é€Ÿåº¦è¼ƒæ…¢ã€‚</small>
            </li>
        </ul>
    </div>

    <!-- J. è¨˜æ†¶å£è¨£ -->
    <div class="card">
        <h3>ğŸ§  è¨˜æ†¶å£è¨£èˆ‡é¿å‘</h3>
        <p><strong>å£è¨£ï¼š</strong>ã€Œæš«ç›¸ç›´é–“æ˜¯å®šå€ï¼Œéš¨æ©Ÿå­˜å–æ˜¯RAMã€‚ã€</p>
        <ul>
            <li>çœ‹åˆ°ã€Œéš¨æ©Ÿã€ğŸ‘‰ æƒ³åˆ° RAM (è¨˜æ†¶é«”ç‰¹æ€§)ï¼Œä¸æ˜¯å®šå€æ¨¡å¼ã€‚</li>
            <li>çœ‹åˆ°ã€Œç›¸å°ã€ğŸ‘‰ æƒ³åˆ° è¦ªæˆš (Base) + è·é›¢ (Offset)ã€‚</li>
            <li>çœ‹åˆ°ã€Œé–“æ¥ã€ğŸ‘‰ æƒ³åˆ° æŒ‡æ¨™ (Pointer) æˆ– å°‹å¯¶åœ–ã€‚</li>
        </ul>
    </div>

    <!-- L. è‡ªæˆ‘æ¸¬é©—å€ -->
    <div class="card">
        <h3>âœï¸ æ¨¡æ“¬ä½œç­”å€</h3>
        <p>è«‹å‹¾é¸æ­£ç¢ºçš„å®šå€æ¨¡å¼ï¼ˆè¤‡é¸ï¼‰ï¼š</p>
        <form id="quiz-form">
            <label class="quiz-option"><input type="checkbox" name="opt" value="A"> (A) éš¨æ©Ÿå®šå€</label>
            <label class="quiz-option"><input type="checkbox" name="opt" value="B"> (B) æš«å­˜å™¨å®šå€</label>
            <label class="quiz-option"><input type="checkbox" name="opt" value="C"> (C) ç›¸å°å®šå€</label>
            <label class="quiz-option"><input type="checkbox" name="opt" value="D"> (D) ç›´æ¥å®šå€</label>
            <label class="quiz-option"><input type="checkbox" name="opt" value="E"> (E) é–“æ¥å®šå€</label>
            
            <button type="button" class="btn-action" onclick="checkQuiz()">é€å‡ºä½œç­”</button>
        </form>
        
        <div id="quiz-feedback" class="quiz-feedback"></div>
    </div>

    <!-- N. è‡ªæˆ‘æª¢æ¸¬ (å»¶ä¼¸æ€è€ƒ) -->
    <div class="card">
        <h3>ğŸ¤” è‡ªæˆ‘æª¢æ¸¬ (ä¸é™„ç­”æ¡ˆ)</h3>
        <ol>
            <li>è‹¥ä½¿ç”¨ã€Œé–“æ¥å®šå€ã€ï¼ŒCPU è‡³å°‘éœ€è¦å­˜å–è¨˜æ†¶é«”å¹¾æ¬¡æ‰èƒ½æ‹¿åˆ°çœŸæ­£çš„è³‡æ–™ï¼Ÿ(æç¤ºï¼šä¸€æ¬¡æ‹¿åœ°å€ï¼Œä¸€æ¬¡æ‹¿...)</li>
            <li>å¦‚æœ PC=200ï¼ŒæŒ‡ä»¤æ˜¯ `JUMP +20` (ç›¸å°å®šå€)ï¼Œè«‹å•ä¸‹ä¸€å€‹åŸ·è¡Œçš„æŒ‡ä»¤åœ¨è¨˜æ†¶é«”å“ªè£¡ï¼Ÿ</li>
        </ol>
    </div>

    <footer style="text-align: center; margin-top: 40px; color: #7f8c8d; font-size: 0.9em;">
        <p>Created for Computer Science Education | HTML5 Teaching Material</p>
    </footer>

</div>

<script>
    // --- äº’å‹•æ¨¡æ“¬å™¨é‚è¼¯ ---
    function resetSim() {
        // æ¸…é™¤æ‰€æœ‰é«˜äº®èˆ‡ç‹€æ…‹
        document.querySelectorAll('.mem-item, .reg-item').forEach(el => {
            el.classList.remove('active-read', 'target-data');
            el.style.backgroundColor = '';
        });
        document.getElementById('sim-result').innerText = '';
        document.getElementById('val-ir').innerText = '---';
        
        // é‡ç½®æŒ‰éˆ•ç‹€æ…‹
        document.querySelectorAll('.sim-btn').forEach(btn => btn.classList.remove('active'));
    }

    function highlightElement(id, type, delay) {
        setTimeout(() => {
            const el = document.getElementById(id);
            if (el) {
                if (type === 'read') el.classList.add('active-read');
                if (type === 'target') el.classList.add('target-data');
            }
        }, delay);
    }

    function updateStatus(text, delay) {
        setTimeout(() => {
            document.getElementById('sim-status').innerText = text;
        }, delay);
    }

    function runSim(mode) {
        resetSim();
        
        // æ¨™è¨˜ç•¶å‰æŒ‰éˆ•
        const btnMap = {
            'Register': 0, 'Direct': 1, 'Indirect': 2, 'Relative': 3
        };
        document.querySelectorAll('.sim-btn')[btnMap[mode]].classList.add('active');

        const status = document.getElementById('sim-status');
        
        // å…±åŒåˆå§‹ç‹€æ…‹ï¼šPC æŒ‡å‘ 100
        highlightElement('reg-pc', 'read', 0);
        
        if (mode === 'Register') {
            // æƒ…å¢ƒï¼šMOV R2, R1 (è³‡æ–™åœ¨ R1)
            updateStatus('Step 1: æŒ‡ä»¤æŒ‡å®š "R1"ã€‚', 0);
            document.getElementById('val-ir').innerText = 'MOV ... R1';
            
            updateStatus('Step 2: CPU ç›´æ¥è®€å–æš«å­˜å™¨ R1ã€‚ä¸éœ€è¦è¨ªå•è¨˜æ†¶é«”ã€‚', 1000);
            highlightElement('reg-r1', 'target', 1000);
            
            setTimeout(() => {
                document.getElementById('sim-result').innerText = 'çµæœï¼šåœ¨ R1 å–å¾— DATA_55';
            }, 2000);
        } 
        else if (mode === 'Direct') {
            // æƒ…å¢ƒï¼šLOAD R1, [102]
            updateStatus('Step 1: æŒ‡ä»¤åŒ…å«åœ°å€ "102"ã€‚', 0);
            document.getElementById('val-ir').innerText = 'LOAD [102]';
            
            updateStatus('Step 2: CPU æ ¹æ“šåœ°å€ 102ï¼Œç›´æ¥å»è¨˜æ†¶é«”æŠ“è³‡æ–™ã€‚', 1000);
            highlightElement('mem-102', 'target', 1000);
            
            setTimeout(() => {
                document.getElementById('sim-result').innerText = 'çµæœï¼šåœ¨ Mem[102] å–å¾— DATA_99';
            }, 2000);
        }
        else if (mode === 'Indirect') {
            // æƒ…å¢ƒï¼šLOAD R1, @103 (103è£¡é¢æ”¾è‘—çœŸæ­£çš„åœ°å€ 102)
            updateStatus('Step 1: æŒ‡ä»¤çµ¦å‡ºæŒ‡æ¨™åœ°å€ "103"ã€‚', 0);
            document.getElementById('val-ir').innerText = 'LOAD @103';
            
            updateStatus('Step 2: å»è¨˜æ†¶é«” 103 è®€å–å…§å®¹... ç™¼ç¾æ˜¯æŒ‡å‘ "102" çš„æŒ‡æ¨™ã€‚', 1000);
            highlightElement('mem-103', 'read', 1000);
            
            updateStatus('Step 3: æ ¹æ“šå‰›å‰›æ‹¿åˆ°çš„ 102ï¼Œå†å»è¨˜æ†¶é«”æŠ“çœŸæ­£çš„è³‡æ–™ã€‚', 2500);
            highlightElement('mem-102', 'target', 2500);
            
            setTimeout(() => {
                document.getElementById('sim-result').innerText = 'çµæœï¼šæœ€çµ‚åœ¨ Mem[102] å–å¾— DATA_99 (è·‘äº†å…©è¶Ÿ)';
            }, 4000);
        }
        else if (mode === 'Relative') {
            // æƒ…å¢ƒï¼šPC=100, LOAD PC+2
            updateStatus('Step 1: æŒ‡ä»¤æ˜¯ "PC + 2"ã€‚ç›®å‰ PC = 100ã€‚', 0);
            document.getElementById('val-ir').innerText = 'LOAD PC+2';
            
            updateStatus('Step 2: è¨ˆç®—æœ‰æ•ˆä½å€ EA = 100 + 2 = 102ã€‚', 1000);
            
            updateStatus('Step 3: æ ¹æ“šè¨ˆç®—çµæœ (102) å»è¨˜æ†¶é«”æŠ“è³‡æ–™ã€‚', 2500);
            highlightElement('mem-102', 'target', 2500);
            
            setTimeout(() => {
                document.getElementById('sim-result').innerText = 'çµæœï¼šåœ¨ Mem[102] å–å¾— DATA_99';
            }, 4000);
        }
    }

    // --- å…¶ä»–åŠŸèƒ½ ---
    function toggleAnswer() {
        const el = document.getElementById('answer-key');
        if (el.style.display === 'block') {
            el.style.display = 'none';
        } else {
            el.style.display = 'block';
        }
    }

    function checkQuiz() {
        const checkboxes = document.querySelectorAll('input[name="opt"]:checked');
        const userAnswers = Array.from(checkboxes).map(cb => cb.value).sort();
        const correctAnswers = ['B', 'C', 'D', 'E'];
        
        const feedback = document.getElementById('quiz-feedback');
        
        // ç°¡å–®æ¯”å°é™£åˆ—
        const isCorrect = JSON.stringify(userAnswers) === JSON.stringify(correctAnswers);
        
        if (userAnswers.length === 0) {
            alert("è«‹è‡³å°‘é¸ä¸€å€‹é¸é …ï¼");
            return;
        }

        if (isCorrect) {
            feedback.className = 'quiz-feedback correct';
            feedback.innerHTML = '<strong>ğŸ‰ ç­”å°äº†ï¼</strong><br>éš¨æ©Ÿå®šå€(Random)æ˜¯å¹²æ“¾é …ï¼Œå…¶é¤˜çš†ç‚ºæ¨™æº–å®šå€æ¨¡å¼ã€‚';
        } else {
            feedback.className = 'quiz-feedback incorrect';
            let msg = '<strong>âš ï¸ é‚„æœ‰é€²æ­¥ç©ºé–“å–”ï¼</strong><br>';
            if (userAnswers.includes('A')) {
                msg += '- (A) éš¨æ©Ÿå®šå€ä¸æ˜¯å®šå€æ¨¡å¼ï¼Œæ˜¯æŒ‡ RAM çš„å­˜å–ç‰¹æ€§ã€‚<br>';
            }
            if (!userAnswers.includes('B') || !userAnswers.includes('C') || !userAnswers.includes('D') || !userAnswers.includes('E')) {
                msg += '- æ‚¨æ¼é¸äº†ä¸€äº›æ­£ç¢ºçš„å®šå€æ¨¡å¼ã€‚<br>';
            }
            msg += 'æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼šB, C, D, E';
            feedback.innerHTML = msg;
        }
    }
</script>

</body>
</html>