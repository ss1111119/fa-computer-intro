<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›»è…¦æ¦‚è«–ï¼šæ•¸ä½é‚è¼¯ XOR é‹ç®—è§£æ</title>
    <style>
        /* --- åŸºç¤è¨­å®š (Reset & Base) --- */
        :root {
            --primary-color: #333;
            --accent-color: #2c3e50;
            --highlight-bg: #fff3cd; /* è¢å…‰ç­†é»ƒ */
            --highlight-text: #856404;
            --border-color: #ddd;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --correct-color: #28a745;
            --wrong-color: #dc3545;
            --btn-color: #007bff;
            --btn-hover: #0056b3;
        }

        body {
            font-family: "Noto Sans TC", "Microsoft JhengHei", -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: var(--primary-color);
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
        }

        h1, h2, h3 {
            color: var(--accent-color);
            margin-top: 0;
        }

        /* --- å®¹å™¨èˆ‡å¡ç‰‡æ¨£å¼ (Layout) --- */
        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .card {
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid var(--accent-color);
        }

        .card-header {
            font-size: 1.2em;
            font-weight: bold;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tag {
            background-color: #e9ecef;
            color: #495057;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8em;
        }

        /* --- é¡Œç›®å°ˆç”¨æ¨£å¼ --- */
        .question-box {
            font-size: 1.1em;
            font-weight: 500;
            background-color: #fdfdfe;
            border: 1px solid var(--border-color);
            padding: 15px;
            border-radius: 5px;
        }

        .options-list {
            list-style: none;
            padding: 0;
        }

        .options-list li {
            padding: 5px 0;
        }

        /* --- è¢å…‰ç­†èˆ‡å¼·èª¿ --- */
        mark {
            background-color: var(--highlight-bg);
            color: var(--highlight-text);
            padding: 0 2px;
            border-radius: 2px;
        }

        .highlight-text {
            color: #d63384; /* é¡ä¼¼ç´…ç­†åœˆé¸ */
            font-weight: bold;
        }

        /* --- äº’å‹•çœŸå€¼è¡¨ (Interactive Table) --- */
        .truth-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }

        .truth-table th, .truth-table td {
            border: 1px solid var(--border-color);
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: background 0.2s;
        }

        .truth-table th {
            background-color: #f8f9fa;
        }

        .truth-table tr:hover td {
            background-color: #f1f3f5;
        }

        .truth-table tr.active td {
            background-color: #e2e6ea;
            font-weight: bold;
            color: var(--btn-color);
        }

        /* --- ç›´å¼è¨ˆç®—å™¨ (Calculator) --- */
        .calc-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .calc-input-group input {
            padding: 8px;
            font-size: 1.2em;
            font-family: monospace;
            width: 80px;
            text-align: center;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .calc-controls {
            margin-bottom: 15px;
        }

        .btn {
            background-color: var(--btn-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            margin-right: 5px;
            transition: background 0.2s;
        }

        .btn:hover {
            background-color: var(--btn-hover);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--btn-color);
            color: var(--btn-color);
        }

        .btn-outline:hover {
            background-color: #e7f1ff;
        }

        /* è¨ˆç®—éç¨‹è¦–è¦ºåŒ–å€å¡Š */
        .calc-visual {
            font-family: monospace;
            font-size: 2em;
            background-color: #222;
            color: #fff;
            padding: 20px;
            border-radius: 8px;
            display: inline-block;
            min-width: 200px;
            text-align: right;
            position: relative;
        }

        .calc-row {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 5px;
        }

        .calc-bit {
            width: 40px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 2px;
            border-radius: 4px;
            transition: all 0.3s;
        }

        .result-row {
            border-top: 2px solid #fff;
            padding-top: 5px;
            margin-top: 5px;
        }

        .calc-bit.active {
            background-color: #f1c40f; /* é‹ç®—ä¸­é«˜äº® (é»ƒ) */
            color: #000;
            transform: scale(1.1);
        }

        .calc-bit.done {
            /* å®Œæˆç‹€æ…‹ */
        }

        .calc-hint {
            margin-top: 10px;
            font-size: 1rem;
            color: var(--accent-color);
            min-height: 1.5em;
            font-weight: bold;
        }

        /* --- é¸é …åˆ†æèˆ‡äº’å‹•é¡Œ --- */
        .analysis-item {
            margin-bottom: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-left: 3px solid #ccc;
        }

        .analysis-item.correct {
            border-left-color: var(--correct-color);
            background-color: #d4edda;
            color: #155724;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-btn {
            padding: 12px;
            text-align: left;
            background: white;
            border: 2px solid #eee;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.2s;
        }

        .quiz-btn:hover {
            border-color: var(--btn-color);
            background-color: #f0f7ff;
        }

        .quiz-btn.correct {
            border-color: var(--correct-color);
            background-color: #d4edda;
            color: #155724;
        }

        .quiz-btn.wrong {
            border-color: var(--wrong-color);
            background-color: #f8d7da;
            color: #721c24;
        }

        .hidden-content {
            display: none;
            margin-top: 10px;
            padding: 10px;
            background: #f1f3f5;
            border-radius: 4px;
        }

        /* --- é å°¾ --- */
        footer {
            text-align: center;
            margin-top: 40px;
            color: #6c757d;
            font-size: 0.9em;
        }

        /* æ‰‹æ©Ÿç‰ˆèª¿æ•´ */
        @media (max-width: 600px) {
            .calc-visual {
                font-size: 1.5em;
                width: 100%;
                text-align: center;
            }
            .calc-row {
                justify-content: center;
            }
            .calc-bit {
                width: 30px;
                height: 40px;
            }
        }
    </style>
</head>
<body>

<div class="container">
    
    <!-- Header -->
    <header style="text-align: center; margin-bottom: 30px;">
        <h1>é›»è…¦æ¦‚è«–ï¼šæ•¸ä½é‚è¼¯é‹ç®—</h1>
        <p style="color: #666;">é‡å° 110 XOR 010 è€ƒé¡Œçš„äº’å‹•è©³è§£</p>
    </header>

    <!-- A. æ¨™é¡Œèˆ‡é¡Œç›®å€ -->
    <section class="card">
        <div class="card-header">
            <span>é¡Œè™Ÿ 29</span>
            <span class="tag">æ•¸ä½é‚è¼¯</span>
        </div>
        <div class="question-box">
            <p>29. äºŒé€²ä½çš„è¨ˆç®—ä¸­ï¼Œ110 è·Ÿ 010 ä½œ EX-OR çš„é‹ç®—ï¼Œå…¶çµæœç‚ºä½•?</p>
            <ul class="options-list">
                <li>(A) 100</li>
                <li>(B) 101</li>
                <li>(C) 010</li>
                <li>(D) 110</li>
            </ul>
        </div>
        <!-- é è¨­æŠ˜ç–Šç­”æ¡ˆ -->
        <div style="margin-top: 15px;">
            <button class="btn btn-outline" onclick="toggleVisibility('ans-top')">é¡¯ç¤ºç­”æ¡ˆ</button>
            <span id="ans-top" style="display:none; font-weight:bold; margin-left: 10px; color: var(--correct-color);">ç­”æ¡ˆï¼šA</span>
        </div>
    </section>

    <!-- C. ç¬¬ä¸€æ­¥ï¼šæ‰¾é—œéµå­— -->
    <section class="card">
        <div class="card-header">ç¬¬ä¸€æ­¥ï¼šæ‰¾é—œéµå­—</div>
        <p>åœ¨é¡Œç›®ä¸­ï¼Œè«‹ç‰¹åˆ¥æ³¨æ„é€™å¹¾å€‹å­—ï¼š</p>
        <p style="font-size: 1.1em; line-height: 2;">
            <mark>110</mark> è·Ÿ <mark>010</mark> ä½œ <mark>EX-OR</mark> çš„é‹ç®—ï¼Œå…¶ <mark>çµæœ</mark> ç‚ºä½•?
        </p>
        <p>ğŸ’¡ <strong>è€å¸«æç¤º</strong>ï¼šé€™é¡Œæ˜¯åœ¨è€ƒã€Œé€ä½å…ƒé‹ç®—ã€ï¼Œä¹Ÿå°±æ˜¯è¦æŠŠæ•¸å­—å°é½Šï¼Œä¸€å€‹ä¸€å€‹ä½æ•¸åˆ†é–‹ç®—ã€‚</p>
    </section>

    <!-- D. ç¬¬äºŒæ­¥ï¼šç™½è©±ç¿»è­¯ -->
    <section class="card">
        <div class="card-header">ç¬¬äºŒæ­¥ï¼šç™½è©±ç¿»è­¯</div>
        <p>é€™é¡Œå¦‚æœç¿»è­¯æˆç™½è©±æ–‡ï¼Œå°±æ˜¯ï¼š</p>
        <blockquote style="border-left: 4px solid var(--highlight-text); margin: 0; padding-left: 15px; background: #fffbf0; padding: 10px;">
            ã€Œè«‹æŠŠ 110 å’Œ 010 ä¸Šä¸‹å°é½Šï¼Œä¸€ä½ä¸€ä½æ¯”è¼ƒï¼š<br>
            <strong>ä¸ä¸€æ¨£å°±å¯« 1ï¼Œä¸€æ¨£å°±å¯« 0</strong>ï¼Œ<br>
            æœ€å¾Œæ‹¼å‡ºä¾†çš„ç­”æ¡ˆæ˜¯ä»€éº¼ï¼Ÿã€
        </blockquote>
    </section>

    <!-- E. ç¬¬ä¸‰æ­¥ï¼šè§£é¡Œæ€è·¯ -->
    <section class="card">
        <div class="card-header">ç¬¬ä¸‰æ­¥ï¼šè§£é¡Œæ€è·¯ & è§€å¿µ</div>
        <h3>1. èªè­˜ XOR (Exclusive OR)</h3>
        <p>XOR ä¸­æ–‡å«ã€Œäº’æ–¥æˆ–ã€ï¼Œç¬¦è™Ÿå¸¸ç”¨ âŠ• è¡¨ç¤ºã€‚å®ƒçš„è¦å‰‡éå¸¸å–®ç´”ï¼š</p>
        <ul>
            <li>åƒå…©å€‹é–‹é—œæ§åˆ¶ä¸€ç›ç‡ˆï¼ˆé›™åˆ‡é–‹é—œï¼‰ã€‚</li>
            <li>ç‹€æ…‹<strong>ä¸åŒ</strong> â†’ ç‡ˆäº® (Result: 1)</li>
            <li>ç‹€æ…‹<strong>ç›¸åŒ</strong> â†’ ç‡ˆæ»… (Result: 0)</li>
        </ul>
        
        <!-- F. äº’å‹•ç¤ºç¯„ 1ï¼šXOR çœŸå€¼è¡¨ -->
        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 10px;">
            <h4 style="margin-top:0;">ğŸ‘‡ é»æ“Šä¸‹æ–¹çœŸå€¼è¡¨çœ‹çœ‹ (Interactive)</h4>
            <table class="truth-table">
                <thead>
                    <tr>
                        <th>è¼¸å…¥ A</th>
                        <th>è¼¸å…¥ B</th>
                        <th>çµæœ (A XOR B)</th>
                        <th>èªªæ˜</th>
                    </tr>
                </thead>
                <tbody>
                    <tr onclick="highlightRow(this, 'åŒ')">
                        <td>0</td>
                        <td>0</td>
                        <td><strong>0</strong></td>
                        <td>éƒ½ä¸€æ¨£ï¼Œæ‰€ä»¥æ˜¯ 0</td>
                    </tr>
                    <tr onclick="highlightRow(this, 'ç•°')">
                        <td>0</td>
                        <td>1</td>
                        <td><strong>1</strong></td>
                        <td>ä¸åŒï¼Œæ‰€ä»¥æ˜¯ 1</td>
                    </tr>
                    <tr onclick="highlightRow(this, 'ç•°')">
                        <td>1</td>
                        <td>0</td>
                        <td><strong>1</strong></td>
                        <td>ä¸åŒï¼Œæ‰€ä»¥æ˜¯ 1</td>
                    </tr>
                    <tr onclick="highlightRow(this, 'åŒ')">
                        <td>1</td>
                        <td>1</td>
                        <td><strong>0</strong></td>
                        <td>éƒ½ä¸€æ¨£ï¼Œæ‰€ä»¥æ˜¯ 0</td>
                    </tr>
                </tbody>
            </table>
            <p id="table-feedback" style="min-height: 1.5em; color: var(--btn-color); font-weight: bold;"></p>
        </div>
    </section>

    <!-- G. äº’å‹•ç¤ºç¯„ 2ï¼šé€ä½å…ƒå°é½Šè¨ˆç®—å™¨ (é‡é») -->
    <section class="card" style="border-left-color: #e83e8c;">
        <div class="card-header">
            <span>äº’å‹•ç¤ºç¯„ï¼šç›´å¼å°é½Šè¨ˆç®—å™¨</span>
            <span class="tag">é‡é»</span>
        </div>
        
        <p>è©¦è‘—æ“ä½œçœ‹çœ‹ï¼Œé€™å°±æ˜¯é›»è…¦å…§éƒ¨é‹ç®—çš„éç¨‹ï¼š</p>

        <div class="calc-input-group">
            <label>æ•¸å­— A: <input type="text" id="binA" value="110" maxlength="8"></label>
            <label>æ•¸å­— B: <input type="text" id="binB" value="010" maxlength="8"></label>
            <button class="btn btn-outline" onclick="resetCalc()">é‡ç½®</button>
        </div>

        <div class="calc-controls">
            <button class="btn" onclick="nextStep()">ğŸ‘£ é€æ­¥é‹ç®— (Step)</button>
            <button class="btn" onclick="calcAll()">ğŸš€ ä¸€æ¬¡ç®—å®Œ</button>
        </div>

        <div style="display: flex; flex-direction: column; align-items: center;">
            <div id="calc-container" class="calc-visual">
                <!-- é€™è£¡æœƒç”± JS å‹•æ…‹ç”Ÿæˆç›´å¼é‹ç®— -->
                <div style="color: #aaa; font-size: 0.5em; text-align: center;">è«‹æŒ‰æŒ‰éˆ•é–‹å§‹è¨ˆç®—</div>
            </div>
            <div id="calc-hint" class="calc-hint">æº–å‚™é–‹å§‹...</div>
        </div>
    </section>

    <!-- H. ç¬¬å››æ­¥ï¼šé¸é …åˆ†æ -->
    <section class="card">
        <div class="card-header">ç¬¬å››æ­¥ï¼šé¸é …åˆ†æ</div>
        <p>æˆ‘å€‘å‰›å‰›ç®—å‡ºä¾†çš„çµæœæ˜¯ <strong>100</strong>ï¼Œç¾åœ¨ä¾†æª¢æŸ¥é¸é …ï¼š</p>
        
        <div class="analysis-item correct">
            <strong>(A) 100</strong>ï¼šæ­£ç¢ºï¼
            <br><small>éç¨‹ï¼š1âŠ•0=1, 1âŠ•1=0, 0âŠ•0=0ã€‚</small>
        </div>
        <div class="analysis-item">
            <strong>(B) 101</strong>ï¼šéŒ¯èª¤ã€‚
            <br><small>éŒ¯åœ¨æœ€å¾Œä¸€ä½ï¼š0 è·Ÿ 0 ç›¸åŒï¼Œæ‡‰è©²æ˜¯ 0ï¼Œä¸æ˜¯ 1ã€‚</small>
        </div>
        <div class="analysis-item">
            <strong>(C) 010</strong>ï¼šéŒ¯èª¤ã€‚
            <br><small>éŒ¯åœ¨ç¬¬ä¸€ä½ï¼š1 è·Ÿ 0 ä¸åŒï¼Œæ‡‰è©²æ˜¯ 1ï¼Œä¸æ˜¯ 0ã€‚</small>
        </div>
        <div class="analysis-item">
            <strong>(D) 110</strong>ï¼šéŒ¯èª¤ã€‚
            <br><small>éŒ¯åœ¨ä¸­é–“ä½ï¼š1 è·Ÿ 1 ç›¸åŒï¼Œæ‡‰è©²æ˜¯ 0ï¼Œä¸æ˜¯ 1ã€‚</small>
        </div>
    </section>

    <!-- I. è§€å¿µè£œå……èˆ‡ J. è¨˜æ†¶å£è¨£ -->
    <section class="card">
        <div class="card-header">è¨˜æ†¶å£è¨£èˆ‡è§€å¿µå»¶ä¼¸</div>
        
        <h3>ğŸ§  è¨˜æ†¶å£è¨£</h3>
        <ul>
            <li><strong>XOR çœ‹ã€Œä¸åŒã€</strong>ï¼šä¸åŒå°±äº®ç‡ˆ (1)ï¼Œç›¸åŒå°±ç†„ç‡ˆ (0)ã€‚</li>
            <li>ç”Ÿæ´»æ¯”å–»ï¼šç”·å¥³åˆå”± (ä¸åŒæ€§åˆ¥) â†’ æˆåŠŸ (1)ï¼›ç”·ç”·æˆ–å¥³å¥³ (ç›¸åŒ) â†’ å¤±æ•— (0)ã€‚</li>
        </ul>

        <h3>ğŸ“š è§¸é¡æ—é€š</h3>
        <table style="width:100%; border-collapse: collapse; margin-top: 10px;">
            <tr style="background: #eee; border-bottom: 2px solid #ddd;">
                <th style="padding:8px; text-align:left;">é‹ç®—</th>
                <th style="padding:8px; text-align:left;">è¦å‰‡</th>
                <th style="padding:8px; text-align:left;">1 vs 0</th>
            </tr>
            <tr>
                <td style="padding:8px; border-bottom:1px solid #eee;"><strong>AND (ä¸”)</strong></td>
                <td style="padding:8px; border-bottom:1px solid #eee;">å…©å€‹éƒ½ 1 æ‰æ˜¯ 1</td>
                <td style="padding:8px; border-bottom:1px solid #eee;">1 & 0 = 0</td>
            </tr>
            <tr>
                <td style="padding:8px; border-bottom:1px solid #eee;"><strong>OR (æˆ–)</strong></td>
                <td style="padding:8px; border-bottom:1px solid #eee;">æœ‰ä¸€å€‹ 1 å°±æ˜¯ 1</td>
                <td style="padding:8px; border-bottom:1px solid #eee;">1 | 0 = 1</td>
            </tr>
            <tr style="background: #fff3cd;">
                <td style="padding:8px;"><strong>XOR (äº’æ–¥)</strong></td>
                <td style="padding:8px;"><strong>ä¸ä¸€æ¨£æ‰æ˜¯ 1</strong></td>
                <td style="padding:8px;">1 âŠ• 0 = 1</td>
            </tr>
        </table>

        <h3>âš ï¸ å¸¸è¦‹é™·é˜±</h3>
        <ul>
            <li>æŠŠ XOR çœ‹æˆ ORï¼šçœ‹åˆ°æœ‰ 1 å°±å¯« 1 (éŒ¯ï¼è‹¥æ˜¯å…©å€‹ 1ï¼ŒXOR æœƒè®Š 0)ã€‚</li>
            <li>ä½æ•¸æ²’å°é½Šï¼šè‹¥é¡Œç›®æ˜¯ 11 XOR 101ï¼Œè¨˜å¾—å‰é¢è£œ 0 è®Šæˆ 011 XOR 101ã€‚</li>
        </ul>
    </section>

    <!-- L. ä½œç­”å€ï¼šäº’å‹•æ¸¬é©— -->
    <section class="card">
        <div class="card-header">
            <span>è‡ªæˆ‘æŒ‘æˆ°</span>
            <span class="tag">éš¨å ‚è€ƒ</span>
        </div>
        <p><strong>é¡Œç›®ï¼š</strong>è‹¥è¨ˆç®— <strong>101 XOR 111</strong>ï¼Œçµæœç‚ºä½•ï¼Ÿ</p>
        
        <div class="quiz-options">
            <button class="quiz-btn" onclick="checkQuiz(this, 'A')">(A) 101</button>
            <button class="quiz-btn" onclick="checkQuiz(this, 'B')">(B) 010</button>
            <button class="quiz-btn" onclick="checkQuiz(this, 'C')">(C) 001</button>
            <button class="quiz-btn" onclick="checkQuiz(this, 'D')">(D) 111</button>
        </div>
        <div id="quiz-feedback" class="hidden-content"></div>
    </section>

    <!-- N. è‡ªæˆ‘æª¢æ¸¬ -->
    <section class="card">
        <div class="card-header">è‡ªæˆ‘æª¢æ¸¬ (æƒ³ä¸€æƒ³)</div>
        <ol>
            <li>ç‚ºä»€éº¼ <code>a XOR a</code> çš„çµæœæ°¸é æ˜¯ 0ï¼Ÿ (æç¤ºï¼šè‡ªå·±è·Ÿè‡ªå·±æ¯”ï¼Œä¸€å®šç›¸åŒé‚„æ˜¯ä¸åŒï¼Ÿ)</li>
            <li><code>a XOR 0</code> æœƒç­‰æ–¼ä»€éº¼ï¼Ÿ (æç¤ºï¼š0 è¡¨ç¤ºã€Œä¸æ”¹è®Šã€)</li>
        </ol>
    </section>

    <footer>
        <p>Design for Computer Science Education</p>
    </footer>

</div>

<!-- JavaScript é‚è¼¯å€ -->
<script>
    /* --- 1. äº’å‹•çœŸå€¼è¡¨é‚è¼¯ --- */
    function highlightRow(row, type) {
        // æ¸…é™¤æ‰€æœ‰é¸å–
        document.querySelectorAll('.truth-table tr').forEach(tr => tr.classList.remove('active'));
        // é¸å–ç•¶å‰
        row.classList.add('active');
        
        const feedback = document.getElementById('table-feedback');
        if (type === 'åŒ') {
            feedback.textContent = "ğŸ‘‰ å…©å€‹è¼¸å…¥ã€Œç›¸åŒã€ï¼Œæ‰€ä»¥çµæœæ˜¯ 0 (ä¸äº®ç‡ˆ)";
            feedback.style.color = "#666";
        } else {
            feedback.textContent = "ğŸ‘‰ å…©å€‹è¼¸å…¥ã€Œä¸åŒã€ï¼Œæ‰€ä»¥çµæœæ˜¯ 1 (äº®ç‡ˆï¼)";
            feedback.style.color = "#d63384";
        }
    }

    /* --- 2. é¡¯ç¤º/éš±è—ç­”æ¡ˆ --- */
    function toggleVisibility(id) {
        const el = document.getElementById(id);
        if (el.style.display === 'none') {
            el.style.display = 'inline';
        } else {
            el.style.display = 'none';
        }
    }

    /* --- 3. é€ä½å…ƒè¨ˆç®—å™¨æ ¸å¿ƒé‚è¼¯ --- */
    let currentStepIndex = 0;
    let bitLength = 0;
    let valA = "";
    let valB = "";

    // åˆå§‹åŒ–è¨ˆç®—å™¨ UI
    function initCalc() {
        const inputA = document.getElementById('binA').value.trim();
        const inputB = document.getElementById('binB').value.trim();
        
        // ç°¡å–®é©—è­‰ï¼šåªå…è¨± 0 å’Œ 1
        if (/[^01]/.test(inputA) || /[^01]/.test(inputB)) {
            alert("è«‹åªè¼¸å…¥äºŒé€²ä½æ•¸å­— (0 æˆ– 1)");
            return false;
        }

        // è£œé›¶å°é½Š (å–æœ€é•·é•·åº¦)
        const maxLen = Math.max(inputA.length, inputB.length);
        valA = inputA.padStart(maxLen, '0');
        valB = inputB.padStart(maxLen, '0');
        bitLength = maxLen;

        const container = document.getElementById('calc-container');
        container.innerHTML = ''; // æ¸…ç©º

        // å»ºç«‹ä¸‰åˆ— HTMLï¼šA, B, Result
        let rowAHtml = '<div class="calc-row" id="row-a">';
        let rowBHtml = '<div class="calc-row" id="row-b">';
        let rowRHtml = '<div class="calc-row result-row" id="row-r">';

        for (let i = 0; i < maxLen; i++) {
            rowAHtml += `<div class="calc-bit" id="bit-a-${i}">${valA[i]}</div>`;
            rowBHtml += `<div class="calc-bit" id="bit-b-${i}">${valB[i]}</div>`;
            rowRHtml += `<div class="calc-bit" id="bit-r-${i}">?</div>`;
        }

        rowAHtml += '</div>';
        rowBHtml += '<div style="position:absolute; left:10px; top:45px; font-size:1em; color:#888;">XOR</div></div>'; // XOR æ¨™ç±¤
        rowRHtml += '</div>';

        container.innerHTML = rowAHtml + rowBHtml + rowRHtml;
        return true;
    }

    function resetCalc() {
        currentStepIndex = 0;
        document.getElementById('binA').value = "110";
        document.getElementById('binB').value = "010";
        document.getElementById('calc-hint').textContent = "æº–å‚™é–‹å§‹... è«‹æŒ‰ã€Œé€æ­¥é‹ç®—ã€";
        initCalc();
    }

    function nextStep() {
        // å¦‚æœé‚„æ²’åˆå§‹åŒ–éæˆ–å…§å®¹è®Šäº†ï¼Œé‡æ–°åˆå§‹åŒ–
        if (document.getElementById('calc-container').children.length === 0) {
            if(!initCalc()) return;
        }

        if (currentStepIndex >= bitLength) {
            document.getElementById('calc-hint').textContent = "è¨ˆç®—å®Œæˆï¼çµæœæ˜¯ " + calculateResult(valA, valB);
            return;
        }

        // æ¸…é™¤ä¸Šä¸€æ­¥çš„é«˜äº®
        if (currentStepIndex > 0) {
            toggleHighlight(currentStepIndex - 1, false);
        }

        // é«˜äº®ç•¶å‰ä½æ•¸
        toggleHighlight(currentStepIndex, true);

        // è¨ˆç®—é‚è¼¯
        const bitA = parseInt(valA[currentStepIndex]);
        const bitB = parseInt(valB[currentStepIndex]);
        const result = bitA ^ bitB; // XOR é‹ç®—

        // æ›´æ–° UI
        const resEl = document.getElementById(`bit-r-${currentStepIndex}`);
        resEl.textContent = result;
        resEl.style.color = "#f1c40f"; // å¼·èª¿å‰›ç®—å‡ºä¾†çš„å­—

        // æç¤ºæ–‡å­—
        const hint = document.getElementById('calc-hint');
        if (bitA === bitB) {
            hint.innerHTML = `ç¬¬ ${currentStepIndex+1} ä½ï¼š${bitA} èˆ‡ ${bitB} <span style="color:#dc3545">ç›¸åŒ</span> â†’ çµæœ 0`;
        } else {
            hint.innerHTML = `ç¬¬ ${currentStepIndex+1} ä½ï¼š${bitA} èˆ‡ ${bitB} <span style="color:#28a745">ä¸åŒ</span> â†’ çµæœ 1`;
        }

        currentStepIndex++;
    }

    function calcAll() {
        if (document.getElementById('calc-container').children.length === 0) {
            if(!initCalc()) return;
        }
        
        // å¿«é€Ÿè·‘å®Œè¿´åœˆ
        while(currentStepIndex < bitLength) {
            const bitA = parseInt(valA[currentStepIndex]);
            const bitB = parseInt(valB[currentStepIndex]);
            document.getElementById(`bit-r-${currentStepIndex}`).textContent = bitA ^ bitB;
            currentStepIndex++;
        }
        
        // æ¸…é™¤æ‰€æœ‰é«˜äº®
        for(let i=0; i<bitLength; i++) toggleHighlight(i, false);
        
        document.getElementById('calc-hint').textContent = "è¨ˆç®—å®Œæˆï¼çµæœæ˜¯ " + calculateResult(valA, valB);
    }

    function toggleHighlight(index, isActive) {
        const els = [
            document.getElementById(`bit-a-${index}`),
            document.getElementById(`bit-b-${index}`),
            document.getElementById(`bit-r-${index}`)
        ];
        els.forEach(el => {
            if(isActive) el.classList.add('active');
            else el.classList.remove('active');
        });
    }

    function calculateResult(a, b) {
        let res = "";
        for(let i=0; i<a.length; i++) {
            res += (parseInt(a[i]) ^ parseInt(b[i]));
        }
        return res;
    }

    // é é¢è¼‰å…¥æ™‚å…ˆåˆå§‹åŒ–ä¸€æ¬¡é¡¯ç¤º
    window.onload = function() {
        initCalc();
    };

    /* --- 4. éš¨å ‚æ¸¬é©—é‚è¼¯ --- */
    function checkQuiz(btn, answer) {
        const feedback = document.getElementById('quiz-feedback');
        const buttons = document.querySelectorAll('.quiz-btn');
        
        // é‡ç½®æŒ‰éˆ•æ¨£å¼
        buttons.forEach(b => {
            b.classList.remove('correct', 'wrong');
            b.disabled = true; // é–å®š
        });

        feedback.style.display = 'block';

        if (answer === 'B') {
            btn.classList.add('correct');
            feedback.innerHTML = `<strong style="color:var(--correct-color)">ç­”å°äº†ï¼ğŸ‰</strong><br>
            é¡Œç›®ï¼š101 XOR 111<br>
            ç¬¬ä¸€ä½ï¼š1âŠ•1=0 (åŒ)<br>
            ç¬¬äºŒä½ï¼š0âŠ•1=1 (ç•°)<br>
            ç¬¬ä¸‰ä½ï¼š1âŠ•1=0 (åŒ)<br>
            æ‰€ä»¥çµæœæ˜¯ 010ã€‚`;
        } else {
            btn.classList.add('wrong');
            feedback.innerHTML = `<strong style="color:var(--wrong-color)">ç­”éŒ¯å›‰ ğŸ˜…</strong><br>
            è«‹è¨˜å¾—ã€Œç›¸åŒç‚º 0ï¼Œä¸åŒç‚º 1ã€ã€‚<br>
            æ­£ç¢ºç­”æ¡ˆæ˜¯ (B) 010ã€‚<br>
            è©¦è‘—ç”¨ä¸Šé¢çš„è¨ˆç®—æ©Ÿè¼¸å…¥ 101 å’Œ 111 é©—è­‰çœ‹çœ‹ï¼`;
        }
    }
</script>

</body>
</html>