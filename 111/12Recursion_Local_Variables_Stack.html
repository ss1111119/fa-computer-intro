Recursion_Local_Variables_Stack.html<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Q12 éè¿´å‡½å¼èˆ‡ Stack æ•™å­¸</title>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --success: #2ec4b6;
            --danger: #e63946;
            --warning: #ffb703;
            --light: #f8f9fa;
            --dark: #212529;
            --card-bg: #ffffff;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        * {
            box-sizing: border-box;
            font-family: "Microsoft JhengHei", "Noto Sans TC", sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
            color: var(--dark);
            padding-bottom: 60px;
        }

        /* é é¦–èˆ‡å°è¦½ */
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        h1 {
            font-size: 1.2rem;
            margin: 0;
            text-align: center;
        }

        .subtitle {
            font-size: 0.9rem;
            text-align: center;
            opacity: 0.9;
            margin-top: 5px;
        }

        .nav-pills {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            overflow-x: auto;
            padding-bottom: 5px;
            gap: 5px;
        }

        .nav-item {
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-item.active {
            background: white;
            color: var(--primary);
            font-weight: bold;
        }

        /* å¡ç‰‡å®¹å™¨ */
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 0 15px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            display: none; /* é è¨­éš±è—ï¼Œç”± JS æ§åˆ¶é¡¯ç¤º */
            animation: slideIn 0.5s ease;
        }

        .card.active {
            display: block;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            color: var(--primary);
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-top: 0;
        }

        /* é¡Œç›®æ¨£å¼ */
        .question-box {
            font-size: 1.1rem;
            font-weight: bold;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .btn-option {
            background: white;
            border: 2px solid #ddd;
            padding: 15px;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
        }

        .btn-option:hover {
            border-color: var(--primary);
            background: #f8f9ff;
        }

        .btn-option.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* å½ˆçª—æ¨£å¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }

        .reason-btn {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background: #eee;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .reason-btn:hover {
            background: #ddd;
        }

        /* å‹•ç•«å±•ç¤ºå€ */
        .demo-area {
            background: #f8f9fa;
            border: 2px dashed #ccc;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            min-height: 250px;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
        }

        .stack-container {
            width: 200px;
            border-bottom: 4px solid var(--dark);
            border-left: 4px solid var(--dark);
            border-right: 4px solid var(--dark);
            min-height: 200px;
            display: flex;
            flex-direction: column-reverse; /* è®“å…ƒç´ å¾åº•éƒ¨é–‹å§‹å †ç–Š */
            padding: 5px;
            position: relative;
        }
        
        .stack-label {
            position: absolute;
            right: -120px;
            bottom: 50%;
            font-weight: bold;
            color: var(--primary);
            width: 100px;
        }

        .stack-frame {
            background: var(--primary);
            color: white;
            padding: 10px;
            margin: 2px 0;
            text-align: center;
            border-radius: 5px;
            animation: dropIn 0.5s ease;
            font-size: 0.9rem;
        }

        @keyframes dropIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .code-snippet {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        .highlight {
            background: #e63946;
            color: white;
            padding: 2px 4px;
            border-radius: 3px;
        }

        /* é…å°éŠæˆ² */
        .match-game {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }

        .match-col {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .match-item {
            padding: 10px;
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .match-item.selected {
            background: var(--warning);
            border-color: var(--warning);
            color: black;
        }

        .match-item.matched {
            background: var(--success);
            border-color: var(--success);
            color: white;
            pointer-events: none;
        }

        /* éŒ¯èª¤ç¤ºç¯„å€ */
        .queue-demo {
            display: flex;
            align-items: center;
            gap: 10px;
            overflow-x: auto;
            padding: 10px;
            border: 2px solid #e63946;
            border-radius: 10px;
            background: #fff0f0;
        }

        .queue-item {
            min-width: 60px;
            height: 60px;
            background: #e63946;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        /* è¿·æ€ç ´è§£ */
        .myth-item {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .myth-btns button {
            margin-right: 5px;
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
        }

        .correct-bg { background-color: #d1e7dd !important; }
        .wrong-bg { background-color: #f8d7da !important; }

        /* æ§åˆ¶æŒ‰éˆ• */
        .nav-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 25px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
        }

        .btn-prev { background: #ddd; color: #555; }
        .btn-next { background: var(--primary); color: white; }

        /* è€å¸«å‚™è¨» */
        .teacher-note {
            background: #fff3cd;
            padding: 15px;
            border-radius: 10px;
            margin-top: 30px;
            border: 1px solid #ffecb5;
        }
        
        .teacher-toggle {
            cursor: pointer;
            color: #856404;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
        }

        .note-content {
            display: none;
            margin-top: 10px;
            font-size: 0.9rem;
            color: #664d03;
        }

        /* é‡é»æç¤º */
        .highlight-box {
            background: #e7f5ff;
            border-left: 5px solid var(--primary);
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 5px 5px 0;
        }

        .term {
            color: #d63384;
            font-weight: bold;
        }

        /* è¨˜æ†¶å£è¨£ */
        .mnemonic-card {
            background: var(--dark);
            color: var(--warning);
            padding: 20px;
            text-align: center;
            border-radius: 10px;
            font-size: 1.2rem;
            cursor: pointer;
            margin: 20px 0;
            transition: transform 0.2s;
        }
        .mnemonic-card:active {
            transform: scale(0.98);
        }

        .hidden { display: none; }
    </style>
</head>
<body>

<header>
    <h1>Q12 éè¿´å‡½å¼èˆ‡å †ç–Š (Stack)</h1>
    <div class="subtitle">é«˜ä¸­é›»è…¦æ¦‚è«– / è³‡æ–™çµæ§‹</div>
    <div class="nav-pills">
        <div class="nav-item active" onclick="gotoStep(0)">1.é¡Œç›®</div>
        <div class="nav-item" onclick="gotoStep(1)">2.ç†è§£</div>
        <div class="nav-item" onclick="gotoStep(2)">3.æ¨¡æ“¬</div>
        <div class="nav-item" onclick="gotoStep(3)">4.åˆ†æ</div>
        <div class="nav-item" onclick="gotoStep(4)">5.ç¸½çµ</div>
    </div>
</header>

<div class="container">

    <!-- STEP 1: é¡Œç›®èˆ‡ä½œç­” -->
    <div class="card active" id="step0">
        <h2>é¡Œç›®æŒ‘æˆ°</h2>
        <div class="question-box">
            12. ä¸‹åˆ—å“ªä¸€ç¨®è³‡æ–™çµæ§‹æœ€é©åˆç”¨ä¾†ç½®æ”¾éè¿´å‡½å¼ï¼ˆrecursive functionï¼‰ä¹‹å€åŸŸè®Šæ•¸ï¼ˆlocal variablesï¼‰ï¼Ÿ
        </div>
        
        <div class="options-grid">
            <button class="btn-option" onclick="checkAnswer('A')">(A) hash table</button>
            <button class="btn-option" onclick="checkAnswer('B')">(B) queue</button>
            <button class="btn-option" onclick="checkAnswer('C')">(C) stack</button>
            <button class="btn-option" onclick="checkAnswer('D')">(D) tree</button>
        </div>

        <div id="feedback-area" style="margin-top: 20px; display: none;">
            <!-- çµæœæœƒé¡¯ç¤ºåœ¨é€™è£¡ -->
        </div>

        <div class="nav-controls">
            <button class="btn btn-next" onclick="nextStep()" style="margin-left: auto;">çœ‹æ•™å­¸è§£æ &rarr;</button>
        </div>
    </div>

    <!-- STEP 2: ç†è§£è§€å¿µ -->
    <div class="card" id="step1">
        <h2>é—œéµå­—è§£ç¢¼</h2>
        
        <div class="highlight-box">
            <p><span class="term">éè¿´å‡½å¼ (Recursion)</span>ï¼š<br>ç°¡å–®èªªå°±æ˜¯ã€Œè‡ªå·±å‘¼å«è‡ªå·±ã€çš„å‡½å¼ã€‚å°±åƒä¿„ç¾…æ–¯å¨ƒå¨ƒï¼Œä¸€å±¤æ‰“é–‹é‚„æœ‰ä¸€å±¤ã€‚</p>
        </div>

        <div class="highlight-box">
            <p><span class="term">å€åŸŸè®Šæ•¸ (Local Variables)</span>ï¼š<br>å‡½å¼è£¡é¢å®£å‘Šçš„è®Šæ•¸ï¼Œåªåœ¨è©²æ¬¡åŸ·è¡Œæ™‚å­˜åœ¨ã€‚æ¯æ¬¡å‘¼å«éƒ½æœƒç”¢ç”Ÿä¸€ä»½ã€Œæ–°çš„ã€å€åŸŸè®Šæ•¸ï¼Œäº’ä¸å¹²æ“¾ã€‚</p>
        </div>

        <div style="text-align: center; margin: 20px 0;">
            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMTAwIj48cGF0aCBkPSJNNDAgODBIMTYwVjkwSDQwVjgwWiIgZmlsbD0iIzQzNjFlZSIvPjxwYXRoIGQ9Ik01MCA2MEgxNTBWNzBINTBWNjBaIiBmaWxsPSIjNDM2MWVlIiBvcGFjaXR5PSIwLjgiLz48cGF0aCBkPSJNNjAgNDBIMTQwVjUwSDYwVjQwWiIgZmlsbD0iIzQzNjFlZSIgb3BhY2l0eT0iMC42Ii8+PHRleHQgeD0iMTAwIiB5PSI5NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMiI+U3RhY2sg5aC655aKXzwvdGV4dD48L3N2Zz4" alt="Stack Icon" style="width: 150px;">
            <p><strong>ç”Ÿæ´»æ¯”å–»ï¼šç–Šç›¤å­ (Stack)</strong></p>
            <p>æœ€å¾Œæ”¾ä¸Šå»çš„ç›¤å­ï¼Œä¸€å®šè¦æœ€å…ˆæ‹¿ä¸‹ä¾†æ´—ã€‚<br>é€™å°±æ˜¯ <span style="color:red; font-weight:bold;">å¾Œé€²å…ˆå‡º (LIFO, Last-In First-Out)</span></p>
        </div>

        <div class="nav-controls">
            <button class="btn btn-prev" onclick="prevStep()">&larr; ä¸Šä¸€æ­¥</button>
            <button class="btn btn-next" onclick="nextStep()">ä¸‹ä¸€æ­¥ï¼šçœ‹å‹•ç•« &rarr;</button>
        </div>
    </div>

    <!-- STEP 3: æ¨¡æ“¬åŸ·è¡Œ -->
    <div class="card" id="step2">
        <h2>éè¿´åŸ·è¡Œæµç¨‹æ¨¡æ“¬</h2>
        <p>å‡è¨­åŸ·è¡Œä¸€å€‹è¨ˆç®—éšä¹˜çš„å‡½å¼ <code>fact(3)</code>ï¼š</p>
        <div class="code-snippet">
            function fact(n) {<br>
            &nbsp;&nbsp;if (n==1) return 1;<br>
            &nbsp;&nbsp;let result = n * fact(n-1); <span style="color:#aaa">// å€åŸŸè®Šæ•¸ result</span><br>
            &nbsp;&nbsp;return result;<br>
            }
        </div>

        <div class="demo-area">
            <div class="stack-container" id="stack-visual">
                <div class="stack-label">Stack è¨˜æ†¶é«”å€</div>
            </div>
            <div id="status-text" style="margin-top: 10px; color: var(--secondary); font-weight: bold;">æº–å‚™é–‹å§‹...</div>
        </div>

        <div style="display: flex; gap: 10px; justify-content: center;">
            <button class="btn" style="background: var(--success); color: white;" onclick="runAnimation()">æ’­æ”¾å‹•ç•«</button>
            <button class="btn" style="background: var(--warning); color: black;" onclick="resetAnimation()">é‡ç½®</button>
        </div>
        
        <p style="margin-top: 15px; font-size: 0.9rem; color: #666;">
            è§€å¯Ÿé‡é»ï¼š<br>
            1. æ¯æ¬¡å‘¼å« <code>fact</code>ï¼Œå°±åƒå¾€ä¸Šç–Šä¸€å€‹ç›¤å­ã€‚<br>
            2. ç•¶ <code>n=1</code> å›å‚³æ™‚ï¼Œæœ€ä¸Šé¢çš„ç›¤å­å…ˆè¢«æ‹¿èµ° (Pop)ã€‚<br>
            3. é€™å°±æ˜¯ç‚ºä»€éº¼éœ€è¦ Stackï¼šç‚ºäº†èƒ½æ­£ç¢ºã€Œå›åˆ°ä¸Šä¸€å±¤ã€ã€‚
        </p>

        <div class="nav-controls">
            <button class="btn btn-prev" onclick="prevStep()">&larr; ä¸Šä¸€æ­¥</button>
            <button class="btn btn-next" onclick="nextStep()">ä¸‹ä¸€æ­¥ï¼šé¸é …åˆ†æ &rarr;</button>
        </div>
    </div>

    <!-- STEP 4: é¸é …åˆ†æèˆ‡äº’å‹• -->
    <div class="card" id="step3">
        <h2>é¸é …é€ä¸€æ“Šç ´</h2>

        <h3>é…å°éŠæˆ²ï¼šé€£é€£çœ‹</h3>
        <p>è«‹é»é¸å·¦é‚Šçš„è³‡æ–™çµæ§‹ï¼Œå†é»é¸å³é‚Šå°æ‡‰çš„ç‰¹æ€§ã€‚</p>
        <div class="match-game">
            <div class="match-col" id="col-left">
                <div class="match-item" data-id="stack">Stack (å †ç–Š)</div>
                <div class="match-item" data-id="queue">Queue (ä½‡åˆ—)</div>
                <div class="match-item" data-id="hash">Hash Table</div>
                <div class="match-item" data-id="tree">Tree (æ¨¹)</div>
            </div>
            <div class="match-col" id="col-right">
                <div class="match-item" data-match="queue">å…ˆé€²å…ˆå‡º (æ’éšŠ)</div>
                <div class="match-item" data-match="tree">éšå±¤çµæ§‹</div>
                <div class="match-item" data-match="stack">å¾Œé€²å…ˆå‡º (ç–Šç›¤å­)</div>
                <div class="match-item" data-match="hash">Key-Value å¿«é€ŸæŸ¥æ‰¾</div>
            </div>
        </div>
        <div id="match-msg" style="text-align: center; margin-top: 10px; font-weight: bold;"></div>

        <hr style="margin: 20px 0;">

        <h3>å¦‚æœç”¨ Queue æœƒæ€æ¨£ï¼Ÿ(éŒ¯èª¤ç¤ºç¯„)</h3>
        <p>Queue æ˜¯ã€Œå…ˆé€²å…ˆå‡ºã€(FIFO)ï¼Œåƒæ’éšŠè²·é£²æ–™ã€‚</p>
        <div class="queue-demo">
            <div class="queue-item">call(3)</div>
            <div class="queue-item">call(2)</div>
            <div class="queue-item">call(1)</div>
            <div style="font-size: 20px;">â”</div>
            <div style="color: var(--danger); font-weight: bold;">???</div>
        </div>
        <button class="btn" style="background: #eee; color: #333; margin-top: 10px; width: 100%;" onclick="showQueueError()">é»æˆ‘çœ‹çµæœ</button>
        <div id="queue-error-msg" style="display:none; color: var(--danger); margin-top: 5px; background: #fff0f0; padding: 10px; border-radius: 5px;">
            âš ï¸ <strong>å¤§éŒ¯ç‰¹éŒ¯ï¼</strong><br>
            å¦‚æœæ˜¯ Queueï¼Œcall(1) çµæŸå¾Œï¼Œæœ€æ—©é€²ä¾†çš„ call(3) æœƒå…ˆè·‘å‡ºä¾†ã€‚<br>
            ä½†æˆ‘å€‘éœ€è¦å›åˆ°çš„æ˜¯ call(2) å•Šï¼é †åºå®Œå…¨äº‚æ‰äº†ã€‚
        </div>

        <div class="nav-controls">
            <button class="btn btn-prev" onclick="prevStep()">&larr; ä¸Šä¸€æ­¥</button>
            <button class="btn btn-next" onclick="nextStep()">ä¸‹ä¸€æ­¥ï¼šç¸½çµ &rarr;</button>
        </div>
    </div>

    <!-- STEP 5: ç¸½çµ -->
    <div class="card" id="step4">
        <h2>è§€å¿µç¸½çµèˆ‡è¨˜æ†¶</h2>

        <div class="mnemonic-card" onclick="toggleMnemonic()">
            ğŸ‘‰ é»æˆ‘åˆ‡æ›è¨˜æ†¶å£è¨£ ğŸ‘ˆ<br>
            <span id="mnemonic-text" style="color: white; display: block; margin-top: 10px;">ã€Œéè¿´å›ä¾†æ‰¾ä¸Šä¸€å±¤ï¼Œä¸€å®šæ˜¯ Stackã€</span>
        </div>

        <h3>è¿·æ€ç ´è§£ O / X</h3>
        <div class="myth-item">
            <p>1. éè¿´å‡½å¼æ¯æ¬¡å‘¼å«éƒ½æœƒç”¢ç”Ÿæ–°çš„å€åŸŸè®Šæ•¸ï¼Ÿ</p>
            <div class="myth-btns">
                <button onclick="checkMyth(this, true, 'æ²’éŒ¯ï¼æ¯ä¸€å±¤éƒ½æœ‰ç¨ç«‹çš„ç©ºé–“ã€‚')">O</button>
                <button onclick="checkMyth(this, false, 'ä¸å°å–”ï¼Œéè¿´æ¯ä¸€å±¤è®Šæ•¸éƒ½æ˜¯ç¨ç«‹çš„ã€‚')">X</button>
                <span class="myth-feedback"></span>
            </div>
        </div>
        <div class="myth-item">
            <p>2. Stack çš„ç‰¹æ€§æ˜¯å…ˆé€²å…ˆå‡º (FIFO)ï¼Ÿ</p>
            <div class="myth-btns">
                <button onclick="checkMyth(this, false, 'é‚£æ˜¯ Queueï¼Stack æ˜¯å¾Œé€²å…ˆå‡ºã€‚')">O</button>
                <button onclick="checkMyth(this, true, 'æ­£ç¢ºï¼Stack æ˜¯å¾Œé€²å…ˆå‡º (LIFO)ã€‚')">X</button>
                <span class="myth-feedback"></span>
            </div>
        </div>

        <h3>è‡ªæˆ‘æª¢æ¸¬</h3>
        <ul>
            <li>ç‚ºä»€éº¼ Stack Overflow (å †ç–Šæº¢ä½) è·Ÿç„¡çª®éè¿´æœ‰é—œï¼Ÿ<br><small style="color:#666;">(ç­”ï¼šå› ç‚ºç„¡çª®éè¿´æœƒä¸€ç›´ Push è³‡æ–™åˆ° Stack ç›´åˆ°æ»¿å‡ºä¾†)</small></li>
        </ul>

        <div class="highlight-box" style="background: #d4edda; border-color: #28a745; text-align: center;">
            <h3>æ­£ç¢ºç­”æ¡ˆï¼š(C) stack</h3>
        </div>

        <div class="nav-controls">
            <button class="btn btn-prev" onclick="prevStep()">&larr; å›å»è¤‡ç¿’</button>
        </div>
    </div>

</div>

<!-- è€å¸«å‚™è¨»å€ -->
<footer class="container">
    <div class="teacher-note">
        <div class="teacher-toggle" onclick="toggleNote()">
            <span>ğŸ‘¨â€ğŸ« æ•™å¸«å‚™è¨» (é»æ“Šå±•é–‹)</span>
            <span>â–¼</span>
        </div>
        <div class="note-content" id="teacher-note-content">
            <p><strong>æ•™å­¸é‡é»ï¼š</strong></p>
            <ul>
                <li>æœ¬é¡Œæ˜¯è³‡æ–™çµæ§‹èˆ‡ç¨‹å¼åŸ·è¡Œæµç¨‹çš„çµåˆï¼Œæ˜¯ APCS æˆ–å¤§å­¸è³‡å·¥å°è«–çš„é«˜é »è€ƒé¡Œã€‚</li>
                <li>å­¸ç”Ÿå¸¸æœ‰çš„è¿·æ€æ˜¯åˆ†ä¸æ¸… Stack èˆ‡ Queue çš„å·®ç•°ï¼Œå»ºè­°ç”¨ã€Œæ´—ç›¤å­ã€èˆ‡ã€Œè²·é£²æ–™ã€çš„ç”Ÿæ´»åŒ–æ¯”å–»åŠ æ·±å°è±¡ã€‚</li>
                <li>å‹™å¿…å¼·èª¿ã€Œå€åŸŸè®Šæ•¸ã€çš„ç”Ÿå‘½é€±æœŸï¼šå‡½å¼é–‹å§‹æ™‚ Push é€²å»ï¼Œå‡½å¼çµæŸæ™‚ Pop å‡ºä¾†ï¼Œé€™å‰›å¥½ç¬¦åˆ Stack çš„é‹ä½œæ¨¡å¼ã€‚</li>
            </ul>
        </div>
    </div>
</footer>

<!-- ç‚ºä»€éº¼é¸é€™å€‹çš„å½ˆçª— -->
<div class="modal-overlay" id="reason-modal">
    <div class="modal-content">
        <h3>ä½ ç‚ºä»€éº¼é¸é€™å€‹ï¼Ÿ</h3>
        <button class="reason-btn" onclick="submitReason('lifo')">å› ç‚ºå®ƒæ˜¯å¾Œé€²å…ˆå‡º (LIFO)</button>
        <button class="reason-btn" onclick="submitReason('fifo')">å› ç‚ºå®ƒæ˜¯å…ˆé€²å…ˆå‡º (FIFO)</button>
        <button class="reason-btn" onclick="submitReason('fast')">å› ç‚ºæŸ¥æ‰¾é€Ÿåº¦å¾ˆå¿«</button>
        <button class="reason-btn" onclick="submitReason('guess')">æˆ‘çŒœçš„ / çœ‹èµ·ä¾†å¾ˆå°ˆæ¥­</button>
        <button class="reason-btn" style="color: #666;" onclick="closeModal()">å–æ¶ˆ</button>
    </div>
</div>

<script>
    // --- ç‹€æ…‹ç®¡ç† ---
    let currentStep = 0;
    let selectedAnswer = '';
    const totalSteps = 5;

    // --- å°è¦½åŠŸèƒ½ ---
    function gotoStep(step) {
        document.querySelectorAll('.card').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        
        document.getElementById(`step${step}`).classList.add('active');
        document.querySelectorAll('.nav-item')[step].classList.add('active');
        currentStep = step;
        window.scrollTo(0, 0);
    }

    function nextStep() {
        if (currentStep < totalSteps - 1) gotoStep(currentStep + 1);
    }

    function prevStep() {
        if (currentStep > 0) gotoStep(currentStep - 1);
    }

    // --- STEP 1: é¸ç­”æ¡ˆäº’å‹• ---
    function checkAnswer(option) {
        selectedAnswer = option;
        document.getElementById('reason-modal').style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('reason-modal').style.display = 'none';
    }

    function submitReason(reason) {
        closeModal();
        const feedbackArea = document.getElementById('feedback-area');
        feedbackArea.style.display = 'block';
        
        let msg = '';
        let color = '';

        if (selectedAnswer === 'C') {
            if (reason === 'lifo') {
                msg = '<h3 style="color:var(--success)">ğŸ‰ å®Œå…¨æ­£ç¢ºï¼</h3><p>è§€å¿µéå¸¸æ¸…æ™°ï¼Stack çš„å¾Œé€²å…ˆå‡ºç‰¹æ€§æ­£æ˜¯ç®¡ç†éè¿´è®Šæ•¸çš„é—œéµã€‚</p>';
            } else {
                msg = '<h3 style="color:var(--success)">âœ… ç­”æ¡ˆå°äº†ï¼Œä½†ç†ç”±...</h3><p>ç­”æ¡ˆæ˜¯ Stack æ²’éŒ¯ï¼Œä½†æ­£ç¢ºç†ç”±æ˜¯å› ç‚ºã€Œå¾Œé€²å…ˆå‡º (LIFO)ã€ã€‚æˆ‘å€‘å¾€ä¸‹çœ‹æ•™å­¸ç¢ºèªä¸€ä¸‹è§€å¿µï¼</p>';
            }
        } else {
            msg = '<h3 style="color:var(--danger)">âŒ ç­”éŒ¯å›‰ï¼</h3><p>åˆ¥æ“”å¿ƒï¼Œé€™é¡Œè§€å¿µæ¯”è¼ƒæŠ½è±¡ã€‚æˆ‘å€‘é€éæ¥ä¸‹ä¾†çš„å‹•ç•«ä¾†æ‰¾ç­”æ¡ˆï¼</p>';
        }

        feedbackArea.innerHTML = msg;
        
        // æ¨™è¨˜é¸ä¸­çš„æŒ‰éˆ•
        document.querySelectorAll('.btn-option').forEach(btn => {
            btn.classList.remove('selected');
            if(btn.textContent.includes(`(${selectedAnswer})`)) {
                btn.classList.add('selected');
            }
        });
    }

    // --- STEP 3: å‹•ç•«é‚è¼¯ ---
    let animTimer = null;
    const steps = [
        { text: "å‘¼å« fact(3)... Push é€² Stack", action: "push", val: "n=3" },
        { text: "å‘¼å« fact(2)... Push é€² Stack", action: "push", val: "n=2" },
        { text: "å‘¼å« fact(1)... Push é€² Stack", action: "push", val: "n=1" },
        { text: "n=1 å›å‚³ 1ï¼ŒPop ç§»é™¤", action: "pop" },
        { text: "å›åˆ° n=2ï¼Œè¨ˆç®— 2*1=2ï¼ŒPop ç§»é™¤", action: "pop" },
        { text: "å›åˆ° n=3ï¼Œè¨ˆç®— 3*2=6ï¼ŒPop ç§»é™¤", action: "pop" },
        { text: "åŸ·è¡ŒçµæŸï¼Stack æ¸…ç©º", action: "done" }
    ];

    function runAnimation() {
        resetAnimation();
        const container = document.getElementById('stack-visual');
        const status = document.getElementById('status-text');
        let i = 0;

        function playStep() {
            if (i >= steps.length) return;
            
            const s = steps[i];
            status.innerText = s.text;

            if (s.action === "push") {
                const div = document.createElement('div');
                div.className = 'stack-frame';
                div.innerText = `Frame: ${s.val}`;
                div.id = `frame-${i}`;
                container.appendChild(div);
            } else if (s.action === "pop") {
                if(container.lastElementChild.classList.contains('stack-frame')) {
                    container.removeChild(container.lastElementChild);
                }
            }

            i++;
            animTimer = setTimeout(playStep, 1500);
        }

        playStep();
    }

    function resetAnimation() {
        clearTimeout(animTimer);
        const container = document.getElementById('stack-visual');
        // ä¿ç•™ labelï¼Œç§»é™¤ frame
        const frames = container.querySelectorAll('.stack-frame');
        frames.forEach(f => f.remove());
        document.getElementById('status-text').innerText = "æº–å‚™é–‹å§‹...";
    }

    // --- STEP 4: é…å°éŠæˆ² ---
    let selectedLeft = null;

    document.querySelectorAll('#col-left .match-item').forEach(item => {
        item.addEventListener('click', function() {
            if(this.classList.contains('matched')) return;
            // æ¸…é™¤ä¹‹å‰çš„é¸å–
            document.querySelectorAll('#col-left .match-item').forEach(i => i.classList.remove('selected'));
            this.classList.add('selected');
            selectedLeft = this;
        });
    });

    document.querySelectorAll('#col-right .match-item').forEach(item => {
        item.addEventListener('click', function() {
            if(!selectedLeft || this.classList.contains('matched')) return;
            
            const matchId = selectedLeft.getAttribute('data-id');
            const targetId = this.getAttribute('data-match');
            const msg = document.getElementById('match-msg');

            if (matchId === targetId) {
                // é…å°æˆåŠŸ
                selectedLeft.classList.add('matched');
                selectedLeft.classList.remove('selected');
                this.classList.add('matched');
                
                selectedLeft.innerHTML += ' âœ…';
                this.innerHTML += ' âœ…';
                
                selectedLeft = null;
                msg.innerText = "é…å°æˆåŠŸï¼ğŸ‰";
                msg.style.color = "var(--success)";
            } else {
                msg.innerText = "é…å°éŒ¯èª¤ï¼Œå†è©¦è©¦çœ‹ï¼ğŸ˜«";
                msg.style.color = "var(--danger)";
                setTimeout(() => msg.innerText = "", 1500);
            }
        });
    });

    function showQueueError() {
        const err = document.getElementById('queue-error-msg');
        err.style.display = 'block';
        err.animate([
            { transform: 'translateX(-5px)' },
            { transform: 'translateX(5px)' },
            { transform: 'translateX(0)' }
        ], { duration: 300, iterations: 2 });
    }

    // --- STEP 5: ç¸½çµäº’å‹• ---
    function toggleMnemonic() {
        const text = document.getElementById('mnemonic-text');
        if (text.innerText.includes("å›ä¾†æ‰¾ä¸Šä¸€å±¤")) {
            text.innerText = "ã€Œå¾Œé€²å…ˆå‡ºï¼Œæ‰èƒ½å›å¾—å»ã€";
        } else {
            text.innerText = "ã€Œéè¿´å›ä¾†æ‰¾ä¸Šä¸€å±¤ï¼Œä¸€å®šæ˜¯ Stackã€";
        }
    }

    function checkMyth(btn, isCorrect, feedbackText) {
        const feedbackSpan = btn.parentElement.querySelector('.myth-feedback');
        if (isCorrect) {
            btn.classList.add('correct-bg');
            feedbackSpan.innerHTML = `<span style="color:green">âœ… ${feedbackText}</span>`;
        } else {
            btn.classList.add('wrong-bg');
            feedbackSpan.innerHTML = `<span style="color:red">âŒ ${feedbackText}</span>`;
        }
    }

    // --- è€å¸«å‚™è¨» ---
    function toggleNote() {
        const content = document.getElementById('teacher-note-content');
        if (content.style.display === 'block') {
            content.style.display = 'none';
        } else {
            content.style.display = 'block';
        }
    }

</script>

</body>
</html>